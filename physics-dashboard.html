<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Physics Course | IG Nation</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="images/favicon.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/iconify-icon@1.0.7/dist/iconify-icon.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@400;600;700&family=Roboto+Slab&display=swap" rel="stylesheet">
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    
    <style>
        * {
            box-sizing: border-box;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        html, body {
            margin: 0 !important;
            padding: 0 !important;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }
        
        body {
            font-family: 'Jost', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh;
            position: relative;
        }

        /* Global Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Intersection Observer Animation Classes */
        .animate-on-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .animate-on-scroll.animated {
            opacity: 1;
            transform: translateY(0);
        }

        .animate-on-scroll-left {
            opacity: 0;
            transform: translateX(-30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .animate-on-scroll-left.animated {
            opacity: 1;
            transform: translateX(0);
        }

        .animate-on-scroll-right {
            opacity: 0;
            transform: translateX(30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .animate-on-scroll-right.animated {
            opacity: 1;
            transform: translateX(0);
        }

        .animate-on-scroll-scale {
            opacity: 0;
            transform: scale(0.9);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .animate-on-scroll-scale.animated {
            opacity: 1;
            transform: scale(1);
        }

        /* Delay Classes */
        .animate-delay-1 { transition-delay: 0.1s; }
        .animate-delay-2 { transition-delay: 0.2s; }
        .animate-delay-3 { transition-delay: 0.3s; }
        .animate-delay-4 { transition-delay: 0.4s; }
        .animate-delay-5 { transition-delay: 0.5s; }

        /* Header - Same as course-mathematics page */
        .dashboard-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            color: #333;
            padding: 1rem 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin: 0;
            position: relative;
            top: 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 999;
        }

        .dashboard-header .container-fluid {
            margin: 0 !important;
            padding: 0 !important;
        }

        .dashboard-header .row {
            margin: 0 !important;
        }

        /* Navigation - Same styling as course-mathematics */
        .dashboard-nav {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 50px;
            padding: 8px;
            margin: 10px 0;
        }

        .dashboard-nav .nav-link {
            color: #333;
            font-weight: 600;
            padding: 12px 24px;
            border-radius: 25px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .dashboard-nav .nav-link:hover,
        .dashboard-nav .nav-link.active {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
        }

        .dashboard-nav .nav-link {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .dashboard-nav .nav-link:active {
            transform: scale(0.95) translateY(-1px);
        }

        .welcome-section {
            padding-left: 0;
            margin-left: 0;
        }

        .welcome-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
            margin: 0;
        }

        .welcome-subtext {
            color: #64748b;
            font-size: 0.9rem;
        }

        /* Main Content */
        .main-content {
            padding: 2rem 0;
            margin-top: 80px;
        }

        /* Cards */
        .dashboard-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            height: 100%;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .dashboard-card::before {
            content: '';
            position: absolute;
            top: -20px;
            right: -20px;
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-radius: 50%;
        }

        .dashboard-card::after {
            content: '';
            position: absolute;
            bottom: -30px;
            left: -30px;
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.08), rgba(118, 75, 162, 0.08));
            border-radius: 50%;
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        /* Modern Cards from Math Course */
        .modern-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            height: 100%;
        }

        .modern-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .modern-card::before {
            content: '';
            position: absolute;
            top: -20px;
            right: -20px;
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-radius: 50%;
        }

        .modern-card::after {
            content: '';
            position: absolute;
            bottom: -30px;
            left: -30px;
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.08), rgba(118, 75, 162, 0.08));
            border-radius: 50%;
        }

        /* Progress Circles */
        .progress-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin: 0 auto 1rem;
            animation: pulse 2s ease-in-out infinite;
        }


        .progress-circle::before {
            content: '';
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            position: absolute;
        }

        .progress-value {
            font-size: 1.2rem;
            font-weight: 800;
            color: #1e293b;
            z-index: 1;
        }

        /* Floating Todo Button Styles */
        .floating-todo-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .floating-todo-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.6);
        }

        .todo-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
        }

        /* Collapsible Todo Panel Styles */
        .todo-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 25px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease;
            z-index: 999;
            overflow-y: auto;
        }

        .todo-panel.open {
            right: 0;
        }

        .todo-panel-header {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            padding: 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .close-todo-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-todo-btn:hover {
            background: rgba(100, 116, 139, 0.1);
        }

        .todo-panel-content {
            padding: 1.5rem;
        }

        /* Todo List Styles */
        .todo-item {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 0.5rem;
            border-left: 4px solid #667eea;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .todo-item:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: translateX(5px);
        }

        .todo-item.completed {
            opacity: 0.6;
            text-decoration: line-through;
            border-left-color: #10b981;
        }

        .todo-item.high-priority {
            border-left-color: #ef4444;
        }

        .todo-item.medium-priority {
            border-left-color: #f59e0b;
        }

        .todo-item.low-priority {
            border-left-color: #10b981;
        }

        .todo-checkbox {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            border: 2px solid #667eea;
            margin-right: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .todo-checkbox.checked {
            background: #667eea;
            border-color: #667eea;
        }

        /* Deadline Styles */
        .deadline-item {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 0.5rem;
            border-left: 4px solid #ef4444;
            transition: all 0.3s ease;
        }

        .deadline-item:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: translateX(5px);
        }

        .deadline-item.urgent {
            border-left-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        .deadline-item.warning {
            border-left-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }

        .deadline-item.normal {
            border-left-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }

        .deadline-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.25rem;
        }

        .deadline-time {
            font-size: 0.8rem;
            color: #64748b;
        }

        .deadline-subject {
            font-size: 0.75rem;
            color: #667eea;
            font-weight: 600;
            text-transform: uppercase;
        }

        /* Leaderboard Styles */
        .leaderboard-item {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
        }

        .leaderboard-item:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: translateX(5px);
        }

        .leaderboard-item.rank-1 {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.1));
            border: 2px solid #ffd700;
        }

        .leaderboard-item.rank-2 {
            background: linear-gradient(135deg, rgba(192, 192, 192, 0.2), rgba(192, 192, 192, 0.1));
            border: 2px solid #c0c0c0;
        }

        .leaderboard-item.rank-3 {
            background: linear-gradient(135deg, rgba(205, 127, 50, 0.2), rgba(205, 127, 50, 0.1));
            border: 2px solid #cd7f32;
        }

        .rank-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            font-size: 0.9rem;
        }

        .rank-1 .rank-number {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #1e293b;
        }

        .rank-2 .rank-number {
            background: linear-gradient(135deg, #c0c0c0, #e5e5e5);
            color: #1e293b;
        }

        .rank-3 .rank-number {
            background: linear-gradient(135deg, #cd7f32, #daa520);
        }

        .rank-number:not(.rank-1):not(.rank-2):not(.rank-3) {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .student-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1rem;
        }

        .student-info {
            flex: 1;
        }

        .student-name {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.25rem;
        }

        .student-score {
            font-size: 0.8rem;
            color: #64748b;
        }

        .student-points {
            font-weight: 700;
            color: #667eea;
            font-size: 1.1rem;
        }

        /* Add Todo Form */
        .add-todo-form {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .add-todo-form .form-control {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 0.75rem;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .add-todo-form .form-control:focus {
            border-color: #10b981;
            box-shadow: 0 0 0 0.2rem rgba(16, 185, 129, 0.25);
        }

        .add-todo-form .btn {
            border-radius: 8px;
            font-size: 0.9rem;
        }

        /* Responsive adjustments for todo form */
        @media (max-width: 768px) {
            .add-todo-form .row {
                margin: 0;
            }
            .add-todo-form .col-6,
            .add-todo-form .col-12 {
                padding: 0.25rem;
            }
        }

        .form-control {
            border: 2px solid rgba(102, 126, 234, 0.2);
            border-radius: 10px;
            padding: 0.75rem;
            transition: all 0.3s ease;
            color: #1e293b !important;
            background-color: #ffffff !important;
        }

        .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }
        
        .form-control::placeholder {
            color: #64748b !important;
            opacity: 1;
        }
        
        .form-control option {
            color: #1e293b !important;
            background-color: #ffffff !important;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 10px;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        /* Save Todo Button */
        .save-todo-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            border-radius: 10px;
            padding: 0.75rem 2rem;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
            margin-top: 1rem;
        }

        .save-todo-btn:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
            color: white;
        }

        .save-todo-btn:active {
            transform: translateY(0);
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        /* Clickable Cards */
        .clickable-card {
            transition: all 0.3s ease;
        }

        .clickable-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
        }

        .clickable-card:active {
            transform: translateY(-2px) scale(0.98);
        }

        /* Schedule Widget Styles */
        .schedule-widget {
            background: white;
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .schedule-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .schedule-view-toggles {
            display: flex;
            background: #f8fafc;
            border-radius: 12px;
            padding: 4px;
            gap: 4px;
        }

        .schedule-view-toggle {
            padding: 0.5rem 1rem;
            border: none;
            background: transparent;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .schedule-view-toggle.active {
            background: #667eea;
            color: white;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .schedule-today-btn {
            background: #e0f2fe;
            color: #0369a1;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .schedule-today-btn:hover {
            background: #bae6fd;
            transform: translateY(-1px);
        }

        .schedule-calendar {
            margin-bottom: 1rem;
        }

        .schedule-days-header {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            margin-bottom: 0.5rem;
        }

        .schedule-day-header {
            text-align: center;
            font-weight: 600;
            font-size: 0.8rem;
            color: #64748b;
            padding: 0.5rem 0;
        }

        .schedule-days-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
        }

        .schedule-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            justify-content: flex-start;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            min-height: 40px;
            padding: 4px;
            text-align: left;
        }

        .schedule-day:hover {
            background: #f1f5f9;
        }

        .schedule-day.other-month {
            color: #cbd5e1;
        }

        .schedule-day.today {
            background: #fef3c7;
            color: #92400e;
            font-weight: 600;
        }

        .schedule-day.has-session {
            background: #ddd6fe;
            color: #5b21b6;
            font-weight: 600;
        }

        .schedule-day.has-session::after {
            content: '';
            position: absolute;
            bottom: 4px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            background: #5b21b6;
            border-radius: 50%;
        }

        /* Session information styles */
        .day-number {
            font-size: 0.85rem;
            font-weight: 500;
            margin-bottom: 3px;
        }

        .day-sessions {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 0;
        }

        .session-info {
            background: transparent;
            border-radius: 0;
            padding: 1px 0;
            font-size: 0.65rem;
            line-height: 1.2;
            border: none;
        }

        .session-time {
            font-weight: 600;
            color: #5b21b6;
            font-size: 0.6rem;
            margin-bottom: 1px;
        }

        .session-title {
            color: #374151;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
            font-size: 0.6rem;
        }

        /* Adjust day cell height for sessions */
        .schedule-day.has-session {
            min-height: 60px;
        }

        .schedule-day.today {
            min-height: 60px;
        }

        .schedule-navigation {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }

        .schedule-nav-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .schedule-nav-btn:hover {
            background: #5a67d8;
            transform: translateY(-1px);
        }

        .schedule-monitor-icon {
            width: 32px;
            height: 32px;
            background: #f1f5f9;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #64748b;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .main-content {
                padding: 1rem 0;
            }
            
            .dashboard-card {
                padding: 1.5rem;
                margin-bottom: 1rem;
            }
            
            .progress-circle {
                width: 80px;
                height: 80px;
            }
            
            .progress-value {
                font-size: 1rem;
            }
            
            /* Hamburger menu responsive */
            .hamburger-menu-btn {
                width: 40px !important;
                height: 40px !important;
            }
            
            .hamburger-menu-btn iconify-icon {
                font-size: 1.3rem !important;
            }
        }
        
        @media (max-width: 576px) {
            .hamburger-menu-btn {
                width: 38px !important;
                height: 38px !important;
            }
            
            .hamburger-menu-btn iconify-icon {
                font-size: 1.2rem !important;
            }
        }

        /* Navigation Icon Buttons */
        .nav-icon-btn {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Focus Mode Styles */
        .focus-mode .dashboard-nav {
            opacity: 0.3;
            pointer-events: none;
        }

        .focus-mode .welcome-section {
            opacity: 0.5;
        }

        .focus-mode .leaderboard-item {
            opacity: 0.4;
        }

        .focus-mode .todo-item {
            opacity: 0.4;
        }

        /* Course Switcher Styles */
        .course-item:hover {
            background: #f8f9fa !important;
            transform: translateX(5px);
        }
        
        .course-item.active:hover {
            background: #f0f4ff !important;
        }

        /* Responsive Design for Icon Buttons */
        @media (max-width: 1200px) {
            .nav-icon-btn {
                width: 40px !important;
                height: 40px !important;
            }
            
            .nav-icon-btn iconify-icon {
                font-size: 1.1rem !important;
            }
            
            .nav-icon-btn img {
                width: 18px !important;
                height: 18px !important;
            }
        }

        @media (max-width: 992px) {
            .nav-icon-btn {
                width: 38px !important;
                height: 38px !important;
            }
            
            .nav-icon-btn iconify-icon {
                font-size: 1rem !important;
            }
            
            .nav-icon-btn img {
                width: 16px !important;
                height: 16px !important;
            }
            
            .personalized-greeting {
                padding: 0.4rem 0.8rem !important;
            }
            
            .personalized-greeting .greeting-text {
                font-size: 0.8rem !important;
            }
            
            .personalized-greeting .ranking-info {
                font-size: 0.7rem !important;
            }
        }

        @media (max-width: 768px) {
            .nav-icon-btn {
                width: 36px !important;
                height: 36px !important;
            }
            
            .nav-icon-btn iconify-icon {
                font-size: 0.9rem !important;
            }
            
            .nav-icon-btn img {
                width: 14px !important;
                height: 14px !important;
            }
            
            .personalized-greeting {
                padding: 0.3rem 0.6rem !important;
            }
            
            .personalized-greeting .greeting-text {
                font-size: 0.75rem !important;
            }
            
            .personalized-greeting .ranking-info {
                font-size: 0.65rem !important;
            }
            
            .personalized-greeting .sample-badges {
                display: none !important;
            }
        }

        @media (max-width: 576px) {
            .nav-icon-btn {
                width: 34px !important;
                height: 34px !important;
            }
            
            .nav-icon-btn iconify-icon {
                font-size: 0.8rem !important;
            }
            
            .nav-icon-btn img {
                width: 12px !important;
                height: 12px !important;
            }
            
            .personalized-greeting {
                padding: 0.25rem 0.5rem !important;
            }
            
            .personalized-greeting .greeting-text {
                font-size: 0.7rem !important;
            }
            
            .personalized-greeting .ranking-info {
                font-size: 0.6rem !important;
            }
        }


        /* Section Headers */
        .section-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 2.5rem;
            font-weight: 800;
            color: #1e293b;
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .gradient-text {
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Enhanced Daily Practice Styles */
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .question-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #667eea;
        }

        .question-card {
            animation: slideInUp 0.6s ease-out;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .no-questions-message {
            animation: fadeIn 0.8s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        /* Enhanced button hover effects */
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-outline-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }
    </style>
    
    <!-- Focus Mode Website Blocker -->
    <script src="focus-mode-blocker.js"></script>
</head>
<body>

    <!-- Dashboard Header -->
    <header class="dashboard-header">
        <div class="container-fluid">
            <!-- Top Header with Hamburger Menu and Navigation Buttons -->
            <div class="row align-items-center" style="padding: 0.5rem 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                <div class="col-6">
                    <div class="d-flex align-items-center">
                        <!-- Hamburger Menu Button -->
                        <button class="hamburger-menu-btn" onclick="toggleSidebar()" style="width: 45px; height: 45px; background: white; border: 1px solid #e9ecef; border-radius: 8px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-right: 1rem;" onmouseover="this.style.boxShadow='0 4px 8px rgba(0,0,0,0.15)'" onmouseout="this.style.boxShadow='0 2px 4px rgba(0,0,0,0.1)'">
                            <iconify-icon icon="material-symbols:menu" style="font-size: 1.5rem; color: #333;"></iconify-icon>
                        </button>
                        
                        <!-- Personalized Greeting -->
                        <div class="personalized-greeting" onclick="toggleBadgesBar()" style="cursor: pointer; display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background: rgba(255, 255, 255, 0.9); border-radius: 25px; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)'">
                            <div class="greeting-content">
                                <div class="greeting-text" id="greetingText" style="font-weight: 600; color: #333; font-size: 0.9rem;">Good afternoon, Alex!</div>
                                <div class="ranking-info" style="font-size: 0.75rem; color: #666; display: flex; align-items: center; gap: 0.3rem;">
                                    <span id="studentRanking">#2 in class</span>
                                    <span>•</span>
                                    <span id="totalPoints" style="color: #667eea; font-weight: 600;">0 points</span>
                                    <span>•</span>
                                    <span id="earnedBadges">3 badges</span>
                                </div>
                            </div>
                            <div class="sample-badges" style="display: flex; gap: 0.2rem;">
                                <div class="badge-sample" style="width: 24px; height: 24px; background: linear-gradient(135deg, #ffd700, #ffed4e); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; color: #333; font-weight: bold;">1</div>
                                <div class="badge-sample" style="width: 24px; height: 24px; background: linear-gradient(135deg, #c0c0c0, #e5e5e5); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; color: #333; font-weight: bold;">2</div>
                                <div class="badge-sample" style="width: 24px; height: 24px; background: linear-gradient(135deg, #cd7f32, #daa520); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; color: white; font-weight: bold;">3</div>
                            </div>
                        </div>
                        
                        <!-- Course Switcher Dropdown (only shown if user has more than one course) -->
                        <div class="course-switcher" id="courseSwitcherContainer" style="margin-left: 1rem; position: relative; display: flex;">
                            <button class="course-switcher-btn" onclick="toggleCourseDropdown()" style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background: rgba(255, 255, 255, 0.9); border: 1px solid #e9ecef; border-radius: 25px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)'">
                                <iconify-icon icon="material-symbols:school" style="font-size: 1.2rem; color: #667eea;"></iconify-icon>
                                <span style="font-weight: 600; color: #333; font-size: 0.9rem;">Physics</span>
                                <iconify-icon icon="material-symbols:keyboard-arrow-down" style="font-size: 1rem; color: #666; transition: transform 0.3s ease;" id="courseDropdownArrow"></iconify-icon>
                            </button>
                            
                            <!-- Course Dropdown Menu -->
                            <div class="course-dropdown" id="courseDropdown" style="position: absolute; top: 100%; left: 0; background: white; border: 1px solid #e9ecef; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.15); min-width: 200px; z-index: 1000; opacity: 0; visibility: hidden; transform: translateY(-10px); transition: all 0.3s ease;">
                                <div class="dropdown-header" style="padding: 1rem; border-bottom: 1px solid #f1f3f4;">
                                    <h6 style="margin: 0; color: #333; font-weight: 600;">My Courses</h6>
                                    <small style="color: #666;">Switch between your purchased courses</small>
                                </div>
                                <div class="dropdown-content" style="padding: 0.5rem;">
                                    <div class="course-item active" onclick="switchCourse('physics')" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; background: #f8f9ff;">
                                        <div class="course-icon" style="width: 32px; height: 32px; background: linear-gradient(135deg, #f093fb, #f5576c); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                            <iconify-icon icon="material-symbols:science" style="color: white; font-size: 1.1rem;"></iconify-icon>
                                        </div>
                                        <div class="course-info">
                                            <div style="font-weight: 600; color: #333; font-size: 0.9rem;">Physics IGCSE</div>
                                            <div style="font-size: 0.8rem; color: #666;">Current Course</div>
                                        </div>
                                        <iconify-icon icon="material-symbols:check-circle" style="color: #10b981; font-size: 1.2rem;"></iconify-icon>
                                    </div>
                                    <div class="course-item" onclick="switchCourse('mathematics')" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">
                                        <div class="course-icon" style="width: 32px; height: 32px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                            <iconify-icon icon="material-symbols:calculate" style="color: white; font-size: 1.1rem;"></iconify-icon>
                                        </div>
                                        <div class="course-info">
                                            <div style="font-weight: 600; color: #333; font-size: 0.9rem;">Mathematics IGCSE</div>
                                            <div style="font-size: 0.8rem; color: #666;">Available</div>
                                        </div>
                                    </div>
                                    <div class="course-item" onclick="switchCourse('chemistry')" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">
                                        <div class="course-icon" style="width: 32px; height: 32px; background: linear-gradient(135deg, #4facfe, #00f2fe); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                            <iconify-icon icon="material-symbols:biotech" style="color: white; font-size: 1.1rem;"></iconify-icon>
                                        </div>
                                        <div class="course-info">
                                            <div style="font-weight: 600; color: #333; font-size: 0.9rem;">Chemistry IGCSE</div>
                                            <div style="font-size: 0.8rem; color: #666;">Available</div>
                                        </div>
                                    </div>
                                    <div class="course-item" onclick="switchCourse('english')" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">
                                        <div class="course-icon" style="width: 32px; height: 32px; background: linear-gradient(135deg, #43e97b, #38f9d7); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                            <iconify-icon icon="material-symbols:menu-book" style="color: white; font-size: 1.1rem;"></iconify-icon>
                                        </div>
                                        <div class="course-info">
                                            <div style="font-weight: 600; color: #333; font-size: 0.9rem;">English IGCSE</div>
                                            <div style="font-size: 0.8rem; color: #666;">Available</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
                <div class="col-6">
                    <div class="d-flex justify-content-end align-items-center gap-2">
                        <!-- IG Nation Logo -->
                        <a href="student-dashboard.html" style="margin-right: 2rem; display: flex; align-items: center; text-decoration: none;">
                            <img src="images/ig-nation-logo-graduation.png" alt="IG Nation" style="height: 45px; width: auto;">
                        </a>
                        
                        <!-- Purchase Course Button -->
                        <button class="nav-icon-btn" onclick="showPurchaseModal()" style="width: 45px; height: 45px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1); position: relative;" onmouseover="this.style.boxShadow='0 4px 8px rgba(0,0,0,0.15)'; this.style.borderColor='#10b981'" onmouseout="this.style.boxShadow='0 2px 4px rgba(0,0,0,0.1)'; this.style.borderColor='#e9ecef'" data-tooltip="Purchase Course">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M7 18C5.9 18 5.01 18.9 5.01 20S5.9 22 7 22 8.9 21.1 8.9 20 8 18 7 18ZM1 2V4H3L6.6 11.59L5.25 14.04C5.09 14.32 5 14.65 5 15C5 16.1 5.9 17 7 17H19V15H7.42C7.28 15 7.17 14.89 7.17 14.75L7.2 14.63L8.1 13H16.55C17.3 13 17.96 12.59 18.3 11.97L21.88 5H5.21L4.27 3H1V2ZM17 18C15.9 18 15.01 18.9 15.01 20S15.9 22 17 22 18.9 21.1 18.9 20 18 18 17 18Z" fill="#10b981"/>
                                <circle cx="7" cy="20" r="1" fill="#10b981"/>
                                <circle cx="17" cy="20" r="1" fill="#10b981"/>
                            </svg>
                        </button>
                        
                        <!-- Focus Mode Button -->
                        <button class="nav-icon-btn" onclick="navigateToFocusMode()" style="width: 45px; height: 45px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);" onmouseover="this.style.boxShadow='0 4px 8px rgba(0,0,0,0.15)'" onmouseout="this.style.boxShadow='0 2px 4px rgba(0,0,0,0.1)'">
                            <img src="images/7898418_focus_business_finance_office_marketing_icon.png" alt="Focus" style="width: 20px; height: 20px; filter: brightness(0) invert(0);">
                        </button>
                        
                        <!-- Notifications Button -->
                        <button class="nav-icon-btn" onclick="navigateToNotifications()" style="width: 45px; height: 45px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1); position: relative;" onmouseover="this.style.boxShadow='0 4px 8px rgba(0,0,0,0.15)'" onmouseout="this.style.boxShadow='0 2px 4px rgba(0,0,0,0.1)'">
                            <iconify-icon icon="material-symbols:notifications" style="font-size: 1.2rem; color: #333;"></iconify-icon>
                            <span id="notificationBadge" style="position: absolute; top: -5px; right: -5px; background: #ef4444; color: white; border-radius: 50%; width: 18px; height: 18px; font-size: 0.7rem; display: flex; align-items: center; justify-content: center; font-weight: 700;">0</span>
                        </button>
                        
                        <!-- Community Button -->
                        <button class="nav-icon-btn" onclick="navigateToCommunity()" style="width: 45px; height: 45px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);" onmouseover="this.style.boxShadow='0 4px 8px rgba(0,0,0,0.15)'" onmouseout="this.style.boxShadow='0 2px 4px rgba(0,0,0,0.1)'">
                            <img src="images/4213440_community_group_leader_people_team_icon.png" alt="Community" style="width: 20px; height: 20px; filter: brightness(0) invert(0);">
                        </button>
                        
                        <!-- Profile Button -->
                        <button class="nav-icon-btn" onclick="navigateToProfile()" style="width: 45px; height: 45px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);" onmouseover="this.style.boxShadow='0 4px 8px rgba(0,0,0,0.15)'" onmouseout="this.style.boxShadow='0 2px 4px rgba(0,0,0,0.1)'">
                            <img src="images/4092564_profile_about_mobile ui_user_icon.png" alt="Profile" style="width: 20px; height: 20px; filter: brightness(0) invert(0);">
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Main Navigation -->
            <div class="row align-items-center">
                <div class="col-12">
                    <div class="dashboard-nav">
                        <ul class="nav justify-content-center">
                            <li class="nav-item">
                                <a class="nav-link active" href="#progress">Progress</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#schedule">Schedule</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#leaderboard">Leaderboard</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#flashcards">Flashcards</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Sidebar Menu -->
    <div id="sidebar" class="sidebar" style="position: fixed; top: 0; left: -350px; width: 350px; height: 100vh; background: white; box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1); transition: left 0.3s ease; z-index: 1000; overflow-y: auto;">
        <!-- Sidebar Header -->
        <div class="sidebar-header" style="padding: 1.5rem; border-bottom: 1px solid #e9ecef; display: flex; justify-content: space-between; align-items: center;">
            <h4 style="margin: 0; color: #333; font-weight: 700;">My Courses</h4>
            <button onclick="toggleSidebar()" style="background: none; border: none; color: #666; cursor: pointer; font-size: 1.5rem; padding: 0.25rem;" onmouseover="this.style.color='#333'" onmouseout="this.style.color='#666'">
                <iconify-icon icon="material-symbols:close"></iconify-icon>
            </button>
        </div>
        
        <!-- Sidebar Content -->
        <div class="sidebar-content" style="padding: 1rem;">
            <!-- Books Section -->
            <div class="menu-section">
                <div class="menu-item" onclick="window.location.href='physics-library.html'" style="display: flex; align-items: center; padding: 1rem; background: #f8f9fa; border-radius: 12px; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#e9ecef'" onmouseout="this.style.background='#f8f9fa'">
                    <div class="menu-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                        <iconify-icon icon="material-symbols:menu-book" style="font-size: 1.5rem; color: white;"></iconify-icon>
                    </div>
                    <div class="menu-text" style="flex: 1;">
                        <div class="menu-title" style="font-weight: 600; color: #333; font-size: 1rem;">Books</div>
                        <div class="menu-subtitle" style="font-size: 0.8rem; color: #666;">Textbooks & Study Materials</div>
                    </div>
                    <iconify-icon icon="material-symbols:keyboard-arrow-right" style="font-size: 1.2rem; color: #666;"></iconify-icon>
                </div>
            </div>

            <!-- Lectures Section -->
            <div class="menu-section">
                <div class="menu-item" onclick="window.location.href='physics-lectures.html'" style="display: flex; align-items: center; padding: 1rem; background: #f8f9fa; border-radius: 12px; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#e9ecef'" onmouseout="this.style.background='#f8f9fa'">
                    <div class="menu-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                        <iconify-icon icon="material-symbols:play-circle" style="font-size: 1.5rem; color: white;"></iconify-icon>
                    </div>
                    <div class="menu-text" style="flex: 1;">
                        <div class="menu-title" style="font-weight: 600; color: #333; font-size: 1rem;">Lectures</div>
                        <div class="menu-subtitle" style="font-size: 0.8rem; color: #666;">Video Lessons & Tutorials</div>
                    </div>
                    <iconify-icon icon="material-symbols:keyboard-arrow-right" style="font-size: 1.2rem; color: #666;"></iconify-icon>
                </div>
            </div>

            <!-- Track Progress Section -->
            <div class="menu-section">
                <div class="menu-item" onclick="toggleSubmenu('progress')" style="display: flex; align-items: center; padding: 1rem; background: #f8f9fa; border-radius: 12px; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#e9ecef'" onmouseout="this.style.background='#f8f9fa'">
                    <div class="menu-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                        <iconify-icon icon="material-symbols:trending-up" style="font-size: 1.5rem; color: white;"></iconify-icon>
                    </div>
                    <div class="menu-text" style="flex: 1;">
                        <div class="menu-title" style="font-weight: 600; color: #333; font-size: 1rem;">Track Progress</div>
                        <div class="menu-subtitle" style="font-size: 0.8rem; color: #666;">Monitor Learning Journey</div>
                    </div>
                    <iconify-icon id="progress-arrow" icon="material-symbols:keyboard-arrow-down" style="font-size: 1.2rem; color: #666; transition: transform 0.3s ease;"></iconify-icon>
                </div>
                <div id="progress-submenu" class="submenu" style="display: none; margin-left: 1rem; margin-bottom: 0.5rem;">
                    <div class="submenu-item" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem;">Quiz Scores</div>
                    <div class="submenu-item" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem;">Assignment Grades</div>
                    <div class="submenu-item" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem;">Study Time</div>
                </div>
            </div>

            <!-- Practice Section -->
            <div class="menu-section">
                <div class="menu-item" onclick="window.location.href='coming-soon.html'" style="display: flex; align-items: center; padding: 1rem; background: #f8f9fa; border-radius: 12px; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#e9ecef'" onmouseout="this.style.background='#f8f9fa'">
                    <div class="menu-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                        <iconify-icon icon="material-symbols:fitness-center" style="font-size: 1.5rem; color: white;"></iconify-icon>
                    </div>
                    <div class="menu-text" style="flex: 1;">
                        <div class="menu-title" style="font-weight: 600; color: #333; font-size: 1rem;">Practice on Topic</div>
                        <div class="menu-subtitle" style="font-size: 0.8rem; color: #666;">Topic-based Practice</div>
                    </div>
                    <iconify-icon icon="material-symbols:keyboard-arrow-right" style="font-size: 1.2rem; color: #666;"></iconify-icon>
                </div>
            </div>

            <!-- Badges Section -->
            <div class="menu-section">
                <div class="menu-item" onclick="window.location.href='coming-soon.html'" style="display: flex; align-items: center; padding: 1rem; background: #f8f9fa; border-radius: 12px; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#e9ecef'; this.style.transform='translateX(5px)'" onmouseout="this.style.background='#f8f9fa'; this.style.transform='translateX(0)'">
                    <div class="menu-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                        <iconify-icon icon="material-symbols:workspace-premium" style="font-size: 1.5rem; color: white;"></iconify-icon>
                    </div>
                    <div class="menu-text" style="flex: 1;">
                        <div class="menu-title" style="font-weight: 600; color: #333; font-size: 1rem;">Badges</div>
                    </div>
                    <iconify-icon icon="material-symbols:keyboard-arrow-right" style="font-size: 1.2rem; color: #666;"></iconify-icon>
                </div>
            </div>

            
            <!-- Live Sessions Section -->
            <div class="menu-section">
                <div class="menu-item" onclick="window.location.href='physics-live-sessions.html'" style="display: flex; align-items: center; padding: 1rem; background: #f8f9fa; border-radius: 12px; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#e9ecef'" onmouseout="this.style.background='#f8f9fa'">
                    <div class="menu-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                        <iconify-icon icon="material-symbols:video-call" style="font-size: 1.5rem; color: white;"></iconify-icon>
                    </div>
                    <div class="menu-text" style="flex: 1;">
                        <div class="menu-title" style="font-weight: 600; color: #333; font-size: 1rem;">Live Sessions</div>
                        <div class="menu-subtitle" style="font-size: 0.8rem; color: #666;">Interactive Learning Sessions</div>
                    </div>
                    <iconify-icon icon="material-symbols:keyboard-arrow-right" style="font-size: 1.2rem; color: #666;"></iconify-icon>
                </div>
            </div>
            
            <!-- Past Papers Section -->
            <div class="menu-section">
                <div class="menu-item" onclick="window.location.href='physics-past-papers.html'" style="display: flex; align-items: center; padding: 1rem; background: #f8f9fa; border-radius: 12px; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#e9ecef'" onmouseout="this.style.background='#f8f9fa'">
                    <div class="menu-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                        <iconify-icon icon="material-symbols:description" style="font-size: 1.5rem; color: white;"></iconify-icon>
                    </div>
                    <div class="menu-text" style="flex: 1;">
                        <div class="menu-title" style="font-weight: 600; color: #333; font-size: 1rem;">Past Papers</div>
                        <div class="menu-subtitle" style="font-size: 0.8rem; color: #666;">Previous Exam Papers & Solutions</div>
                    </div>
                    <iconify-icon icon="material-symbols:keyboard-arrow-right" style="font-size: 1.2rem; color: #666;"></iconify-icon>
                </div>
                <div id="papers-submenu" class="submenu" style="display: none; margin-left: 1rem; margin-bottom: 0.5rem;">
                    <div class="submenu-item" onclick="window.location.href='physics-past-papers.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">All Past Papers</div>
                    <div class="submenu-item" onclick="window.location.href='physics-past-papers-2025.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2025 Papers</div>
                    <div class="submenu-item" onclick="window.location.href='physics-past-papers-2024.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2024 Papers</div>
                    <div class="submenu-item" onclick="window.location.href='physics-past-papers-2023.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2023 Papers</div>
                    <div class="submenu-item" onclick="window.location.href='physics-past-papers-2022.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2022 Papers</div>
                    <div class="submenu-item" onclick="window.location.href='physics-past-papers-2021.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2021 Papers</div>
                    <div class="submenu-item" onclick="window.location.href='physics-past-papers-2020.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2020 Papers</div>
                    <div class="submenu-item" onclick="window.location.href='physics-past-papers-2019.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2019 Papers</div>
                    <div class="submenu-item" onclick="window.location.href='physics-past-papers-2018.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2018 Papers</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sidebar Overlay -->
    <div id="sidebarOverlay" class="sidebar-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 999; display: none;" onclick="toggleSidebar()"></div>

    <!-- Badges Bar (Hidden by default) -->
    <div id="badgesBar" class="badges-bar" style="display: none; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(20px); padding: 1rem; border-bottom: 1px solid rgba(255, 255, 255, 0.2); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col-12">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 style="margin: 0; color: #333; font-weight: 600;">Alex's Earned Badges</h6>
                        <button onclick="toggleBadgesBar()" style="background: none; border: none; color: #666; cursor: pointer; font-size: 1.2rem;" onmouseover="this.style.color='#333'" onmouseout="this.style.color='#666'">
                            <iconify-icon icon="material-symbols:close"></iconify-icon>
                        </button>
                    </div>
                    <div class="badges-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem; margin-top: 1rem;">
                        <!-- Gold Badge -->
                        <div class="badge-item" style="text-align: center; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: 15px; border: 2px solid #ffd700; cursor: pointer; transition: all 0.3s ease;" onclick="window.location.href='coming-soon.html'" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(255, 215, 0, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(255, 215, 0, 0.3)'">
                            <div class="badge-icon" style="width: 50px; height: 50px; background: linear-gradient(135deg, #ffd700, #ffed4e); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; margin: 0 auto 0.5rem; box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);">🏆</div>
                            <div class="badge-name" style="font-weight: 600; color: #333; font-size: 0.85rem;">Quiz Master</div>
                        </div>
                        
                        <!-- Silver Badge -->
                        <div class="badge-item" style="text-align: center; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: 15px; border: 2px solid #c0c0c0; cursor: pointer; transition: all 0.3s ease;" onclick="window.location.href='coming-soon.html'" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(192, 192, 192, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(192, 192, 192, 0.3)'">
                            <div class="badge-icon" style="width: 50px; height: 50px; background: linear-gradient(135deg, #c0c0c0, #e5e5e5); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; margin: 0 auto 0.5rem; box-shadow: 0 4px 12px rgba(192, 192, 192, 0.3);">🎯</div>
                            <div class="badge-name" style="font-weight: 600; color: #333; font-size: 0.85rem;">Assignment Ace</div>
                        </div>
                        
                        <!-- Bronze Badge -->
                        <div class="badge-item" style="text-align: center; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: 15px; border: 2px solid #cd7f32; cursor: pointer; transition: all 0.3s ease;" onclick="window.location.href='coming-soon.html'" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(205, 127, 50, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(205, 127, 50, 0.3)'">
                            <div class="badge-icon" style="width: 50px; height: 50px; background: linear-gradient(135deg, #cd7f32, #daa520); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; margin: 0 auto 0.5rem; box-shadow: 0 4px 12px rgba(205, 127, 50, 0.3);">📚</div>
                            <div class="badge-name" style="font-weight: 600; color: #333; font-size: 0.85rem;">Study Streak</div>
                        </div>
                        
                        <!-- Achievement Badge -->
                        <div class="badge-item" style="text-align: center; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: 15px; border: 2px solid #10b981; cursor: pointer; transition: all 0.3s ease;" onclick="window.location.href='coming-soon.html'" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(16, 185, 129, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(16, 185, 129, 0.3)'">
                            <div class="badge-icon" style="width: 50px; height: 50px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; margin: 0 auto 0.5rem; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);">⭐</div>
                            <div class="badge-name" style="font-weight: 600; color: #333; font-size: 0.85rem;">Top Performer</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="container">
            <!-- Section Header -->
            <div class="section-header animate-on-scroll">
                <h1 class="section-title">
                    Your Learning <span class="gradient-text">Dashboard</span>
                </h1>
            </div>

            <!-- Progress Cards from Math Course Page -->
            <div id="progress" class="row mb-5">
                <div class="col-12">
                    <h3 class="mb-4 animate-on-scroll animate-delay-1" style="color: #1e293b; font-weight: 700;">
                        <iconify-icon icon="material-symbols:trending-up" class="me-2" style="color: #667eea;"></iconify-icon>
                        Your Progress Overview
                    </h3>
                </div>
                <div class="col-md-3 mb-4">
                    <div class="modern-card text-center animate-on-scroll animate-delay-1 clickable-card" onclick="navigateToSection('quiz')" style="cursor: pointer;">
                        <img src="images/New folder/quiz.webp" alt="Quizzes" style="width: 80px; height: 80px; margin-bottom: 1rem; border-radius: 10px;">
                        <h4 style="color: #1e293b; font-weight: 700; margin: 0;">Quizzes</h4>
                    </div>
                </div>
                
                <div class="col-md-3 mb-4">
                    <div class="modern-card text-center animate-on-scroll animate-delay-2 clickable-card" onclick="navigateToSection('exam')" style="cursor: pointer;">
                        <img src="images/New folder/exam.webp" alt="Exams" style="width: 80px; height: 80px; margin-bottom: 1rem; border-radius: 10px;">
                        <h4 style="color: #1e293b; font-weight: 700; margin: 0;">Exams</h4>
                    </div>
                </div>
                
                <div class="col-md-3 mb-4">
                    <div class="modern-card text-center animate-on-scroll animate-delay-3 clickable-card" onclick="navigateToSection('assignment')" style="cursor: pointer;">
                        <img src="images/New folder/homework.webp" alt="Assignments" style="width: 80px; height: 80px; margin-bottom: 1rem; border-radius: 10px;">
                        <h4 style="color: #1e293b; font-weight: 700; margin: 0;">Assignments</h4>
                    </div>
                </div>
                
                <div class="col-md-3 mb-4">
                    <div class="modern-card text-center animate-on-scroll animate-delay-4 clickable-card" onclick="window.location.href='physics-progress.html'" style="cursor: pointer;">
                        <img src="images/New folder/tracj.webp" alt="Track Your Progress" style="width: 80px; height: 80px; margin-bottom: 1rem; border-radius: 10px;">
                        <h4 style="color: #1e293b; font-weight: 700; margin: 0;">Track Your Progress</h4>
                    </div>
                </div>
            </div>


            <!-- New Two-Column Layout: Schedule (Left) and Deadlines (Right) -->
            <div id="schedule" class="row mb-5">
                <!-- Left Column - Schedule (50% width) -->
                <div class="col-md-6 mb-4">
                    <div class="dashboard-card animate-on-scroll-left animate-delay-1" style="height: 100%;">
                        <h3 class="card-title">
                            <div class="card-icon">
                                <iconify-icon icon="material-symbols:calendar-month"></iconify-icon>
                            </div>
                            Monthly Schedule
                    </h3>
                        <div id="scheduleWidget">
                            <!-- Enhanced Schedule Widget -->
                            <div class="schedule-widget">
                                <div class="schedule-header">
                                    <h4 style="margin: 0; color: #1e293b; font-weight: 700;">January 2025</h4>
                                    <div class="schedule-view-toggles">
                                        <button class="schedule-view-toggle active">Month</button>
                                        <button class="schedule-view-toggle">Week</button>
                </div>
                                    </div>
                                
                                <div class="schedule-calendar">
                                    <div class="schedule-days-header">
                                        <div class="schedule-day-header">Sun</div>
                                        <div class="schedule-day-header">Mon</div>
                                        <div class="schedule-day-header">Tue</div>
                                        <div class="schedule-day-header">Wed</div>
                                        <div class="schedule-day-header">Thu</div>
                                        <div class="schedule-day-header">Fri</div>
                                        <div class="schedule-day-header">Sat</div>
                                    </div>
                                    
                                    <div class="schedule-days-grid" id="calendarGrid">
                                        <!-- Calendar days will be populated dynamically -->
                                </div>
                                </div>
                                
                                <div class="schedule-navigation">
                                    <button class="schedule-nav-btn" onclick="previousMonth()">
                                        <iconify-icon icon="material-symbols:chevron-left"></iconify-icon>
                                        Previous
                                    </button>
                                    <button class="schedule-today-btn" onclick="goToToday()">
                                        <iconify-icon icon="material-symbols:today"></iconify-icon>
                                        Today
                                    </button>
                                    <button class="schedule-nav-btn" onclick="nextMonth()">
                                        Next
                                        <iconify-icon icon="material-symbols:chevron-right"></iconify-icon>
                                    </button>
                            </div>
                                
                                <!-- Upcoming Sessions -->
                                <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid #e2e8f0;">
                                    <h5 style="color: #1e293b; font-weight: 600; margin-bottom: 1rem;">
                                        <iconify-icon icon="material-symbols:schedule" style="vertical-align: middle; margin-right: 0.5rem;"></iconify-icon>
                                        Upcoming Sessions
                                    </h5>
                                    <div id="upcomingSessions">
                                        <div style="background: rgba(102, 126, 234, 0.1); padding: 1rem; border-radius: 10px; margin-bottom: 0.5rem; border-left: 4px solid #667eea;">
                                            <div style="font-weight: 600; color: #1e293b; margin-bottom: 0.25rem;">Physics Lab Session</div>
                                            <div style="font-size: 0.85rem; color: #64748b;">Tomorrow, 2:00 PM - 4:00 PM</div>
                        </div>
                                        <div style="background: rgba(16, 185, 129, 0.1); padding: 1rem; border-radius: 10px; margin-bottom: 0.5rem; border-left: 4px solid #10b981;">
                                            <div style="font-weight: 600; color: #1e293b; margin-bottom: 0.25rem;">Mathematics Review</div>
                                            <div style="font-size: 0.85rem; color: #64748b;">Friday, 10:00 AM - 11:30 AM</div>
                    </div>
                                        <div style="background: rgba(245, 158, 11, 0.1); padding: 1rem; border-radius: 10px; border-left: 4px solid #f59e0b;">
                                            <div style="font-weight: 600; color: #1e293b; margin-bottom: 0.25rem;">Study Group Meeting</div>
                                            <div style="font-size: 0.85rem; color: #64748b;">Monday, 6:00 PM - 8:00 PM</div>
                </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column - Upcoming Deadlines (50% width) -->
                <div class="col-md-6 mb-4">
                    <div class="dashboard-card animate-on-scroll-right animate-delay-1" style="height: 100%;">
                                <h3 class="card-title">
                                    <div class="card-icon">
                                        <iconify-icon icon="material-symbols:schedule"></iconify-icon>
                                    </div>
                                    Upcoming Deadlines
                                </h3>
                                <div id="deadlinesList">
                            <!-- Enhanced Deadlines List -->
                            <div class="deadline-item urgent">
                                <div class="deadline-subject">PHYSICS</div>
                                <div class="deadline-title">Mechanics Assignment #3</div>
                                <div class="deadline-time">Due Tomorrow at 11:59 PM</div>
                                    </div>
                            <div class="deadline-item warning">
                                <div class="deadline-subject">MATHEMATICS</div>
                                <div class="deadline-title">Calculus Quiz - Integration</div>
                                <div class="deadline-time">Due in 2 days at 3:00 PM</div>
                                </div>
                            <div class="deadline-item normal">
                                <div class="deadline-subject">PHYSICS</div>
                                <div class="deadline-title">Lab Report - Thermodynamics</div>
                                <div class="deadline-time">Due in 5 days at 5:00 PM</div>
                                </div>
                            <div class="deadline-item normal">
                                <div class="deadline-subject">MATHEMATICS</div>
                                <div class="deadline-title">Statistics Project</div>
                                <div class="deadline-time">Due in 1 week at 11:59 PM</div>
                            </div>
                            <div class="deadline-item warning">
                                <div class="deadline-subject">PHYSICS</div>
                                <div class="deadline-title">Midterm Exam Preparation</div>
                                <div class="deadline-time">Exam in 10 days</div>
                    </div>

                            <!-- View All Button -->
                            <div style="text-align: center; margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid #e2e8f0;">
                                <button style="background: linear-gradient(135deg, #667eea, #764ba2); border: none; color: white; padding: 0.75rem 2rem; border-radius: 25px; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.3)'">
                                    <iconify-icon icon="material-symbols:view-list" style="vertical-align: middle; margin-right: 0.5rem;"></iconify-icon>
                                    View All Deadlines
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bottom Row: Leaderboard (Left) and Wrong/Tricky Questions (Right) -->
            <div id="leaderboard" class="row mb-5">
                <!-- Left Column - Leaderboard (50% width) -->
                <div class="col-md-6 mb-4">
                            <div class="dashboard-card animate-on-scroll-left animate-delay-2">
                        <h3 class="card-title">
                            <div class="card-icon">
                                <iconify-icon icon="material-symbols:leaderboard"></iconify-icon>
                            </div>
                            Class Leaderboard
                        </h3>
                        <div id="leaderboardList">
                            <!-- Leaderboard will be populated dynamically -->
                        </div>
                </div>
            </div>

                <!-- Right Column - Wrong Questions and Tricky Questions (50% width) -->
                <div class="col-md-6 mb-4" style="display: flex; flex-direction: column; gap: 1rem;">
                    <!-- Wrong Questions Card (Top - 50% height) -->
                    <div class="modern-card animate-on-scroll clickable-card" onclick="window.location.href='physics-wrong-questions.html'" style="cursor: pointer; border-left: 5px solid #ef4444; flex: 1; display: flex; align-items: center;">
                        <div class="d-flex align-items-center justify-content-between w-100">
                            <div>
                                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #ef4444, #dc2626); border-radius: 15px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);">
                                        <iconify-icon icon="material-symbols:close-rounded" style="font-size: 1.5rem; color: white;"></iconify-icon>
                                    </div>
                                    <div>
                                        <h4 style="color: #1e293b; font-weight: 700; margin: 0; font-size: 1.1rem;">Wrong Questions</h4>
                                        <p style="color: #64748b; margin: 0; font-size: 0.8rem;">Review your mistakes</p>
                                </div>
                            </div>
                                <div style="background: rgba(239, 68, 68, 0.1); padding: 0.5rem; border-radius: 10px;">
                                    <div style="color: #ef4444; font-weight: 600; font-size: 1.2rem;" id="wrongQuestionsCount">0</div>
                                    <div style="color: #64748b; font-size: 0.75rem;">Questions to review</div>
                                </div>
                            </div>
                            <iconify-icon icon="material-symbols:arrow-forward-rounded" style="font-size: 1.5rem; color: #cbd5e1;"></iconify-icon>
                        </div>
                    </div>

                    <!-- Tricky Questions Card (Bottom - 50% height) -->
                    <div class="modern-card animate-on-scroll clickable-card" onclick="window.location.href='physics-tricky-questions.html'" style="cursor: pointer; border-left: 5px solid #f59e0b; background: linear-gradient(135deg, rgba(245, 158, 11, 0.05), rgba(251, 191, 36, 0.05)); flex: 1; display: flex; align-items: center;">
                        <div class="d-flex align-items-center justify-content-between w-100">
                            <div>
                                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #f59e0b, #d97706); border-radius: 15px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);">
                                        <iconify-icon icon="material-symbols:lightbulb" style="font-size: 1.5rem; color: white;"></iconify-icon>
                                    </div>
                                    <div>
                                        <h4 style="color: #1e293b; font-weight: 700; margin: 0; font-size: 1.1rem;">Tricky Questions</h4>
                                        <p style="color: #64748b; margin: 0; font-size: 0.8rem;">Practice challenging problems</p>
                                    </div>
                                </div>
                                <div style="background: rgba(245, 158, 11, 0.15); padding: 0.5rem; border-radius: 10px;">
                                    <div style="color: #f59e0b; font-weight: 600; font-size: 1.2rem;" id="trickyQuestionsCount">0</div>
                                    <div style="color: #64748b; font-size: 0.75rem;">Questions saved</div>
                                </div>
                            </div>
                            <iconify-icon icon="material-symbols:arrow-forward-rounded" style="font-size: 1.5rem; color: #cbd5e1;"></iconify-icon>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Daily Practice and Flashcards Section -->
            <div id="flashcards" class="row mb-5">
                <!-- Daily Practice Section (50% width) -->
                <div class="col-md-6 mb-4">
                    <div class="dashboard-card animate-on-scroll" style="height: 100%; display: flex; flex-direction: column;">
                        <div class="card-header" style="border-bottom: 1px solid rgba(0,0,0,0.1); padding: 1.5rem 1.5rem 1rem 1.5rem;">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h3 class="card-title" style="margin: 0; margin-bottom: 0.5rem; color: #1e293b; font-weight: 700;">
                                        <div class="card-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                                            <iconify-icon icon="material-symbols:quiz"></iconify-icon>
                                        </div>
                                        Daily Practice Questions
                                    </h3>
                                    <p style="margin: 0; color: #6c757d;">Solve a new challenge every day!</p>
                                </div>
                                <button class="btn btn-primary" onclick="window.location.href='physics-daily-practice.html'" style="font-weight: 600; border-radius: 10px; padding: 0.75rem 1.5rem;">
                                    <iconify-icon icon="material-symbols:arrow-forward" class="me-1"></iconify-icon>
                                    Start Practice
                                </button>
                            </div>
                        </div>
                        
                        <!-- Statistics Row -->
                        <div class="row mx-3 mb-3 mt-3" style="font-size: 0.9rem;">
                            <div class="col-3 text-center">
                                <div class="stat-card" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); padding: 1rem; border-radius: 12px; text-align: center; transition: all 0.3s ease;">
                                    <div style="font-size: 1.5rem; font-weight: 700; color: #667eea;" id="dailyPracticeStreak">0</div>
                                    <div style="color: #6c757d; font-weight: 600;">Day Streak</div>
                                </div>
                            </div>
                            <div class="col-3 text-center">
                                <div class="stat-card" style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1)); padding: 1rem; border-radius: 12px; text-align: center; transition: all 0.3s ease;">
                                    <div style="font-size: 1.5rem; font-weight: 700; color: #10b981;" id="dailyPracticeSolved">0</div>
                                    <div style="color: #6c757d; font-weight: 600;">Solved</div>
                                </div>
                            </div>
                            <div class="col-3 text-center">
                                <div class="stat-card" style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.1)); padding: 1rem; border-radius: 12px; text-align: center; transition: all 0.3s ease;">
                                    <div style="font-size: 1.5rem; font-weight: 700; color: #f59e0b;" id="dailyPracticeAccuracy">0%</div>
                                    <div style="color: #6c757d; font-weight: 600;">Accuracy</div>
                                </div>
                            </div>
                            <div class="col-3 text-center">
                                <div class="stat-card" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(124, 58, 237, 0.1)); padding: 1rem; border-radius: 12px; text-align: center; transition: all 0.3s ease;">
                                    <div style="font-size: 1.5rem; font-weight: 700; color: #8b5cf6;" id="dailyPracticeAvailable">0</div>
                                    <div style="color: #6c757d; font-weight: 600;">Available</div>
                                </div>
                            </div>
                        </div>
                        
                        
                        <!-- Question Display Area - Takes remaining height -->
                        <div class="flex-grow-1 mx-3 mb-3" style="display: flex; flex-direction: column; min-height: 0;">
                            <div id="inlineQuestionContainer" style="display: none; flex: 1; display: flex; flex-direction: column;">
                                <div class="question-card" style="background: linear-gradient(135deg, #f8fafc, #e2e8f0); border: 2px solid #e2e8f0; border-radius: 16px; padding: 1.5rem; flex: 1; display: flex; flex-direction: column; transition: all 0.3s ease; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
                                    <div class="d-flex align-items-center justify-content-between mb-3">
                                        <div class="d-flex align-items-center">
                                            <div style="background: linear-gradient(135deg, #667eea, #764ba2); width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                                                <iconify-icon icon="material-symbols:quiz" style="color: white; font-size: 1.2rem;"></iconify-icon>
                                            </div>
                                            <div>
                                                <h6 style="margin: 0; color: #1e293b; font-weight: 600;">Today's Practice Question</h6>
                                                <div id="questionCounter" style="font-size: 0.85rem; color: #64748b; margin-top: 0.25rem;">
                                                    Question 1 of 1
                                                </div>
                                            </div>
                                        </div>
                                        <div class="d-flex gap-2">
                                            <button id="prevQuestionBtn" onclick="previousQuestion()" class="btn btn-outline-secondary btn-sm" style="display: none; border-radius: 8px; padding: 0.5rem 0.75rem; font-size: 0.8rem;">
                                                <iconify-icon icon="material-symbols:arrow-back" style="font-size: 1rem;"></iconify-icon>
                                            </button>
                                            <button id="nextQuestionBtn" onclick="nextQuestion()" class="btn btn-primary btn-sm" style="display: none; border-radius: 8px; padding: 0.5rem 0.75rem; font-size: 0.8rem;">
                                                Next
                                                <iconify-icon icon="material-symbols:arrow-forward" style="font-size: 1rem; margin-left: 0.25rem;"></iconify-icon>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div id="inlineQuestionText" style="color: #1e293b; margin-bottom: 1.5rem; font-size: 1rem; line-height: 1.6; flex: 1; overflow-y: auto;">
                                        <!-- Question will be loaded here -->
                                    </div>
                                    
                                    <div class="mt-auto">
                                        <div class="row">
                                            <div class="col-md-8">
                                                <textarea id="inlineAnswerInput" class="form-control" rows="3" placeholder="Type your answer here..." style="border: 2px solid #e2e8f0; border-radius: 10px; resize: vertical; font-size: 0.95rem; transition: all 0.3s ease;" onfocus="this.style.borderColor='#667eea'" onblur="this.style.borderColor='#e2e8f0'"></textarea>
                                            </div>
                                            <div class="col-md-4">
                                                <button onclick="submitInlineAnswer()" class="btn btn-primary w-100 mb-2" style="font-weight: 600; border-radius: 10px; padding: 0.75rem; transition: all 0.3s ease;">
                                                    <iconify-icon icon="material-symbols:check" class="me-1"></iconify-icon>
                                                    Submit
                                                </button>
                                                <button onclick="showInlineAnswer()" class="btn btn-outline-primary w-100" style="font-weight: 600; border-radius: 10px; padding: 0.75rem; transition: all 0.3s ease;">
                                                    <iconify-icon icon="material-symbols:visibility" class="me-1"></iconify-icon>
                                                    Show Answer
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <div id="inlineAnswerDisplay" style="display: none; margin-top: 1.5rem; padding: 1.5rem; background: linear-gradient(135deg, #f1f5f9, #e2e8f0); border-radius: 12px; border-left: 4px solid #10b981;">
                                            <div class="d-flex align-items-center mb-2">
                                                <iconify-icon icon="material-symbols:check-circle" style="color: #10b981; font-size: 1.2rem; margin-right: 0.5rem;"></iconify-icon>
                                                <strong style="color: #1e293b;">Correct Answer:</strong>
                                            </div>
                                            <div id="inlineCorrectAnswer" style="color: #1e293b; margin-bottom: 1rem; font-weight: 500;"></div>
                                            <div id="inlineExplanation" style="color: #64748b; font-size: 0.9rem; line-height: 1.5;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- No Questions Message -->
                            <div id="noQuestionsMessage" class="text-center" style="display: flex; align-items: center; justify-content: center; flex: 1; color: #6c757d;">
                                <div class="no-questions-message">
                                    <div style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem auto;">
                                        <iconify-icon icon="material-symbols:quiz" style="font-size: 2.5rem; color: #667eea;"></iconify-icon>
                                    </div>
                                    <h5 style="color: #1e293b; margin-bottom: 0.5rem; font-weight: 600;">No Questions Here Yet</h5>
                                    <p style="margin: 0; font-size: 1rem; color: #64748b;">Your teacher hasn't added any practice questions yet.</p>
                                    <p style="margin: 0; font-size: 0.9rem; color: #94a3b8; margin-top: 0.5rem;">Check back later for new challenges!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Flashcards Section (50% width) -->
                <div class="col-md-6 mb-4">
                    <div class="dashboard-card animate-on-scroll-left animate-delay-3" style="height: 100%;">
                                <h3 class="card-title">
                                    <div class="card-icon">
                                        <iconify-icon icon="material-symbols:style"></iconify-icon>
                                    </div>
                            Physics Flashcards
                                </h3>
                                <p style="color: #6c757d; margin-bottom: 1.5rem;">
                            Study with interactive flashcards and track your progress across all physics chapters
                                </p>
                                
                                <!-- Flashcard Stats -->
                                <div class="row mb-4">
                                    <div class="col-6 col-md-3 mb-3">
                                        <div style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); padding: 1.5rem; border-radius: 15px; text-align: center;">
                                            <div style="font-size: 2rem; font-weight: 700; color: #667eea;" id="flashcardTotal">0</div>
                                            <div style="font-size: 0.85rem; color: #6c757d; font-weight: 600;">Total Cards</div>
                                        </div>
                                    </div>
                                    <div class="col-6 col-md-3 mb-3">
                                        <div style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1)); padding: 1.5rem; border-radius: 15px; text-align: center;">
                                            <div style="font-size: 2rem; font-weight: 700; color: #10b981;" id="flashcardMastered">0</div>
                                            <div style="font-size: 0.85rem; color: #6c757d; font-weight: 600;">Mastered</div>
                                        </div>
                                    </div>
                                    <div class="col-6 col-md-3 mb-3">
                                        <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.1)); padding: 1.5rem; border-radius: 15px; text-align: center;">
                                            <div style="font-size: 2rem; font-weight: 700; color: #f59e0b;" id="flashcardStudying">0</div>
                                            <div style="font-size: 0.85rem; color: #6c757d; font-weight: 600;">Studying</div>
                                        </div>
                                    </div>
                                    <div class="col-6 col-md-3 mb-3">
                                        <div style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.1)); padding: 1.5rem; border-radius: 15px; text-align: center;">
                                            <div style="font-size: 2rem; font-weight: 700; color: #ef4444;" id="flashcardForgotten">0</div>
                                            <div style="font-size: 0.85rem; color: #6c757d; font-weight: 600;">Need Review</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Quick Access Buttons -->
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <button onclick="window.location.href='physics-flashcards.html'" style="width: 100%; background: linear-gradient(135deg, #667eea, #764ba2); border: none; color: white; padding: 1rem; border-radius: 12px; font-weight: 600; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 0.5rem; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);">
                                            <iconify-icon icon="material-symbols:style" style="font-size: 1.5rem;"></iconify-icon>
                                            Browse All Flashcards
                                        </button>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <button onclick="window.location.href='flashcards-forgotten.html'" style="width: 100%; background: linear-gradient(135deg, #ef4444, #dc2626); border: none; color: white; padding: 1rem; border-radius: 12px; font-weight: 600; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 0.5rem; box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);" id="reviewForgottenBtn">
                                            <iconify-icon icon="material-symbols:priority-high" style="font-size: 1.5rem;"></iconify-icon>
                                            Review Forgotten Cards (<span id="forgottenCountBtn">0</span>)
                                        </button>
                                    </div>
                                </div>

                                <!-- Recent Chapters -->
                                <div class="mt-4">
                                    <h4 style="font-size: 1.1rem; font-weight: 700; color: #1e293b; margin-bottom: 1rem;">
                                        <iconify-icon icon="material-symbols:history" style="vertical-align: middle; margin-right: 0.5rem;"></iconify-icon>
                                        Quick Access Chapters
                                    </h4>
                                    <div class="row" id="quickAccessChapters">
                                        <!-- Will be populated dynamically -->
                                    </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Todo Button -->
    <div class="floating-todo-btn" onclick="toggleTodoPanel()">
        <iconify-icon icon="material-symbols:checklist" style="font-size: 1.5rem; color: white;"></iconify-icon>
        <span class="todo-count" id="todoCount">3</span>
    </div>

    <!-- Collapsible Todo Panel -->
    <div class="todo-panel" id="todoPanel">
        <div class="todo-panel-header">
            <h3 style="margin: 0; color: #1e293b; font-weight: 700;">
                <iconify-icon icon="material-symbols:checklist" style="margin-right: 0.5rem; color: #667eea;"></iconify-icon>
                My Todo List
            </h3>
            <button class="close-todo-btn" onclick="toggleTodoPanel()">
                <iconify-icon icon="material-symbols:close" style="font-size: 1.5rem; color: #64748b;"></iconify-icon>
            </button>
        </div>
        
        <div class="todo-panel-content">
            <!-- Add Todo Form -->
            <div class="add-todo-form">
                <div class="row g-2">
                    <div class="col-12 mb-2">
                        <input type="text" class="form-control" id="newTodoInput" placeholder="Enter your new task here..." style="width: 100%;">
                    </div>
                    <div class="col-8 mb-2">
                        <select class="form-control" id="prioritySelect" style="width: 100%;">
                            <option value="low">Low Priority</option>
                            <option value="medium">Medium Priority</option>
                            <option value="high">High Priority</option>
                        </select>
                    </div>
                    <div class="col-4 mb-2">
                        <button class="btn btn-primary w-100" onclick="addTodo()" style="padding: 0.75rem 0.5rem; font-weight: 600; white-space: nowrap; font-size: 0.85rem;">
                            <iconify-icon icon="material-symbols:add" class="me-1"></iconify-icon>
                            Add
                        </button>
                    </div>
                </div>
            </div>

            <div id="todoList">
                <div class="todo-item high-priority" onclick="toggleTodo(this)">
                    <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                        <div style="display: flex; align-items: center; flex: 1;">
                            <div class="todo-checkbox checked"></div>
                            <div>
                                <div style="font-weight: 600; color: #1e293b;">Complete Physics Assignment</div>
                                <small style="color: #64748b;">High Priority • Due Tomorrow</small>
                            </div>
                        </div>
                        <button class="btn btn-sm btn-outline-danger" onclick="event.stopPropagation(); removeTodoItem(this)" style="padding: 0.25rem 0.5rem; margin-left: 0.5rem;">
                            <iconify-icon icon="material-symbols:delete-outline" style="font-size: 1rem;"></iconify-icon>
                        </button>
                    </div>
                </div>
                <div class="todo-item medium-priority" onclick="toggleTodo(this)">
                    <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                        <div style="display: flex; align-items: center; flex: 1;">
                            <div class="todo-checkbox"></div>
                            <div>
                                <div style="font-weight: 600; color: #1e293b;">Review Physics Formulas</div>
                                <small style="color: #64748b;">Medium Priority • Due in 2 days</small>
                            </div>
                        </div>
                        <button class="btn btn-sm btn-outline-danger" onclick="event.stopPropagation(); removeTodoItem(this)" style="padding: 0.25rem 0.5rem; margin-left: 0.5rem;">
                            <iconify-icon icon="material-symbols:delete-outline" style="font-size: 1rem;"></iconify-icon>
                        </button>
                    </div>
                </div>
                <div class="todo-item low-priority" onclick="toggleTodo(this)">
                    <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                        <div style="display: flex; align-items: center; flex: 1;">
                            <div class="todo-checkbox checked"></div>
                            <div>
                                <div style="font-weight: 600; color: #1e293b; text-decoration: line-through;">Update Study Schedule</div>
                                <small style="color: #64748b;">Low Priority • Completed</small>
                            </div>
                        </div>
                        <button class="btn btn-sm btn-outline-danger" onclick="event.stopPropagation(); removeTodoItem(this)" style="padding: 0.25rem 0.5rem; margin-left: 0.5rem;">
                            <iconify-icon icon="material-symbols:delete-outline" style="font-size: 1rem;"></iconify-icon>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="row mt-4">
                <div class="col-md-6 mb-2">
                    <button class="btn btn-success w-100" onclick="saveTodoList()" style="padding: 0.75rem 1rem; font-weight: 600;">
                        <iconify-icon icon="material-symbols:save" class="me-1"></iconify-icon>
                        Save List
                    </button>
                </div>
                <div class="col-md-6 mb-2">
                    <button class="btn btn-danger w-100" onclick="clearTodoList()" style="padding: 0.75rem 1rem; font-weight: 600;">
                        <iconify-icon icon="material-symbols:clear-all" class="me-1"></iconify-icon>
                        Clear List
                    </button>
                </div>
                <div class="col-12 mb-2">
                    <button class="btn btn-outline-primary w-100" onclick="viewAllTodoLists()" style="padding: 0.75rem 1rem; font-weight: 600;">
                        <iconify-icon icon="material-symbols:list" class="me-1"></iconify-icon>
                        View All Todo Lists
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/notifications.js"></script>
    <script>
        // Intersection Observer for animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animated');
                }
            });
        }, observerOptions);

        // Observe all animated elements
        document.querySelectorAll('.animate-on-scroll, .animate-on-scroll-right, .animate-on-scroll-left, .animate-on-scroll-scale').forEach(el => {
            observer.observe(el);
        });

        // Todo Panel Toggle Function
        function toggleTodoPanel() {
            const panel = document.getElementById('todoPanel');
            panel.classList.toggle('open');
        }

        // Todo Panel Toggle Function
        function toggleTodoPanel() {
            const panel = document.getElementById('todoPanel');
            panel.classList.toggle('open');
        }

        // Update todo count
        function updateTodoCount() {
            const todoItems = document.querySelectorAll('#todoList .todo-item');
            const count = todoItems.length;
            document.getElementById('todoCount').textContent = count;
        }

        // Todo List Functions
        function toggleTodo(element) {
            const checkbox = element.querySelector('.todo-checkbox');
            const title = element.querySelector('div[style*="font-weight: 600"]');
            
            if (checkbox.classList.contains('checked')) {
                checkbox.classList.remove('checked');
                element.classList.remove('completed');
                title.style.textDecoration = 'none';
            } else {
                checkbox.classList.add('checked');
                element.classList.add('completed');
                title.style.textDecoration = 'line-through';
            }
            
            // Save changes to localStorage immediately
            saveTodosToLocalStorage();
        }

        function addTodo() {
            const input = document.getElementById('newTodoInput');
            const priority = document.getElementById('prioritySelect').value;
            const todoText = input.value.trim();
            
            if (todoText === '') {
                alert('Please enter a task!');
                return;
            }
            
            const todoList = document.getElementById('todoList');
            
            // Clear any "no tasks" message if it exists
            const noTasksMessage = todoList.querySelector('div[style*="text-align: center"]');
            if (noTasksMessage) {
                noTasksMessage.remove();
            }
            
            const newTodo = document.createElement('div');
            newTodo.className = `todo-item ${priority}-priority`;
            newTodo.onclick = () => toggleTodo(newTodo);
            
            const priorityText = priority.charAt(0).toUpperCase() + priority.slice(1);
            
            newTodo.innerHTML = `
                <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                    <div style="display: flex; align-items: center; flex: 1;">
                        <div class="todo-checkbox"></div>
                        <div>
                            <div style="font-weight: 600; color: #1e293b;">${todoText}</div>
                            <small style="color: #64748b;">${priorityText} Priority • Just added</small>
                        </div>
                    </div>
                    <button class="btn btn-sm btn-outline-danger" onclick="event.stopPropagation(); removeTodoItem(this)" style="padding: 0.25rem 0.5rem; margin-left: 0.5rem;">
                        <iconify-icon icon="material-symbols:delete-outline" style="font-size: 1rem;"></iconify-icon>
                    </button>
                </div>
            `;
            
            todoList.insertBefore(newTodo, todoList.firstChild);
            input.value = '';
            
            // Add animation
            newTodo.style.opacity = '0';
            newTodo.style.transform = 'translateY(-20px)';
            setTimeout(() => {
                newTodo.style.transition = 'all 0.3s ease';
                newTodo.style.opacity = '1';
                newTodo.style.transform = 'translateY(0)';
            }, 100);
            
            // Save to localStorage immediately
            saveTodosToLocalStorage();
        }

        // Allow Enter key to add todo
        document.getElementById('newTodoInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addTodo();
            }
        });

        // Save todos to localStorage
        function saveTodosToLocalStorage() {
            const todoItems = document.querySelectorAll('#todoList .todo-item');
            const todoData = [];
            
            todoItems.forEach(item => {
                const checkbox = item.querySelector('.todo-checkbox');
                const title = item.querySelector('div[style*="font-weight: 600"]');
                const priority = item.classList.contains('high-priority') ? 'high' : 
                               item.classList.contains('medium-priority') ? 'medium' : 'low';
                
                todoData.push({
                    text: title.textContent.trim(),
                    completed: checkbox.classList.contains('checked'),
                    priority: priority
                });
            });
            
            localStorage.setItem('physicsTodoList', JSON.stringify(todoData));
        }

        // Load todos from localStorage
        function loadTodosFromLocalStorage() {
            const todoList = document.getElementById('todoList');
            const savedTodos = localStorage.getItem('physicsTodoList');
            
            // Always clear the sample tasks first
            todoList.innerHTML = '';
            
            if (savedTodos) {
                const todos = JSON.parse(savedTodos);
                
                if (todos.length === 0) {
                    // Show "no tasks" message
                    todoList.innerHTML = '<div style="text-align: center; padding: 2rem; color: #64748b;"><iconify-icon icon="material-symbols:check-circle-outline" style="font-size: 3rem; opacity: 0.3;"></iconify-icon><p style="margin-top: 1rem; font-weight: 500;">No tasks yet. Add your first task!</p></div>';
                    return;
                }
                
                // Load saved todos
                todos.forEach(todo => {
                    const todoItem = document.createElement('div');
                    todoItem.className = `todo-item ${todo.priority}-priority ${todo.completed ? 'completed' : ''}`;
                    todoItem.onclick = () => toggleTodo(todoItem);
                    
                    const priorityText = todo.priority.charAt(0).toUpperCase() + todo.priority.slice(1);
                    const statusText = todo.completed ? 'Completed' : 'Pending';
                    
                    todoItem.innerHTML = `
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; flex: 1;">
                                <div class="todo-checkbox ${todo.completed ? 'checked' : ''}"></div>
                                <div>
                                    <div style="font-weight: 600; color: #1e293b;">${todo.text}</div>
                                    <small style="color: #64748b;">${priorityText} Priority • ${statusText}</small>
                                </div>
                            </div>
                            <button class="btn btn-sm btn-outline-danger" onclick="event.stopPropagation(); removeTodoItem(this)" style="padding: 0.25rem 0.5rem; margin-left: 0.5rem;">
                                <iconify-icon icon="material-symbols:delete-outline" style="font-size: 1rem;"></iconify-icon>
                            </button>
                        </div>
                    `;
                    
                    todoList.appendChild(todoItem);
                });
            } else {
                // No saved todos - show "no tasks" message
                todoList.innerHTML = '<div style="text-align: center; padding: 2rem; color: #64748b;"><iconify-icon icon="material-symbols:check-circle-outline" style="font-size: 3rem; opacity: 0.3;"></iconify-icon><p style="margin-top: 1rem; font-weight: 500;">No tasks yet. Add your first task!</p></div>';
            }
        }

        function saveTodoList() {
            console.log('💾 Starting save process...');
            
            // Check if there are any todos
            const todos = document.querySelectorAll('#todoList .todo-item');
            console.log('   Found', todos.length, 'todo items');
            
            if (todos.length === 0) {
                alert('⚠️ Please add at least one task before saving!');
                return;
            }
            
            // Ask for a name for this todo list
            const listName = prompt('Enter a name for this todo list:', `My Tasks - ${new Date().toLocaleDateString()}`);
            console.log('   List name entered:', listName);
            
            if (!listName || listName.trim() === '') {
                console.log('   ❌ Save cancelled - no name provided');
                alert('⚠️ Please provide a name for your todo list!');
                return;
            }
            
            // Get current todos data
            const todoItems = document.querySelectorAll('#todoList .todo-item');
            const todoData = [];
            
            todoItems.forEach((item, index) => {
                const checkbox = item.querySelector('.todo-checkbox');
                const title = item.querySelector('div[style*="font-weight: 600"]');
                const priority = item.classList.contains('high-priority') ? 'high' : 
                               item.classList.contains('medium-priority') ? 'medium' : 'low';
                
                const taskData = {
                    text: title ? title.textContent.trim() : 'Untitled Task',
                    completed: checkbox ? checkbox.classList.contains('checked') : false,
                    priority: priority
                };
                
                console.log(`   Task ${index + 1}:`, taskData.text, `[${priority} priority]`);
                todoData.push(taskData);
            });
            
            console.log('   Total tasks to save:', todoData.length);
            
            // Get existing saved todo lists (array of lists)
            const savedLists = JSON.parse(localStorage.getItem('physicsSavedTodoLists') || '[]');
            console.log('   Existing saved lists:', savedLists.length);
            
            // Add new list to the array
            const newList = {
                id: Date.now(),
                name: listName.trim(),
                tasks: todoData,
                createdAt: new Date().toISOString()
            };
            savedLists.push(newList);
            
            console.log('   New list object:', newList);
            
            // Save back to localStorage
            localStorage.setItem('physicsSavedTodoLists', JSON.stringify(savedLists));
            console.log('✅ Saved todo list for Physics:', listName, '- Total lists:', savedLists.length);
            
            // Verify save
            const verifyLists = JSON.parse(localStorage.getItem('physicsSavedTodoLists') || '[]');
            console.log('   Verification - Lists in storage:', verifyLists.length);
            
            // Clear the dashboard todo list
            document.getElementById('todoList').innerHTML = '';
            localStorage.removeItem('physicsTodoList');
            console.log('   Dashboard todo list cleared');
            
            // Show success message
            const saveBtn = document.querySelector('.save-todo-btn');
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '<iconify-icon icon="material-symbols:check" class="me-1"></iconify-icon>Saved!';
            saveBtn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
            
            setTimeout(() => {
                saveBtn.innerHTML = originalText;
                saveBtn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
            }, 2000);
        }
        
        function viewAllTodoLists() {
            // Navigate to course-specific todo lists page
            window.location.href = 'physics-todolists.html';
        }
        
        function clearTodoList() {
            clearAllTodos();
        }
        
        function clearAllTodos() {
            if (confirm('⚠️ Are you sure you want to clear ALL tasks?\n\nThis will remove all tasks from your current to-do list. This action cannot be undone!')) {
                // Save empty array to localStorage
                localStorage.setItem('physicsTodoList', JSON.stringify([]));
                
                // Reload the display
                loadTodosFromLocalStorage();
                
                // Show success message
                const successMsg = document.createElement('div');
                successMsg.style.cssText = 'position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 1rem 1.5rem; border-radius: 10px; box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3); z-index: 10000; animation: slideInRight 0.3s ease;';
                successMsg.innerHTML = '<iconify-icon icon="material-symbols:check-circle" style="margin-right: 0.5rem;"></iconify-icon>All tasks cleared successfully!';
                document.body.appendChild(successMsg);
                
                setTimeout(() => successMsg.remove(), 2000);
            }
        }

        function removeTodoItem(button) {
            const todoItem = button.closest('.todo-item');
            
            // Add fade out animation
            todoItem.style.transition = 'all 0.3s ease';
            todoItem.style.opacity = '0';
            todoItem.style.transform = 'translateX(20px)';
            
            // Remove after animation
            setTimeout(() => {
                todoItem.remove();
                // Save to localStorage after removal
                saveTodosToLocalStorage();
                // Update todo count
                updateTodoCount();
            }, 300);
        }

        // Update todo count badge
        function updateTodoCount() {
            const todoItems = document.querySelectorAll('#todoList .todo-item');
            const count = todoItems.length;
            document.getElementById('todoCount').textContent = count;
        }

        // Update welcome message based on time
        function updateWelcomeMessage() {
            // Function disabled - welcome section was removed from header
            // This prevents the JavaScript error
            return;
        }

        // Schedule Widget Functions
        let currentDate = new Date();
        let currentMonth = currentDate.getMonth();
        let currentYear = currentDate.getFullYear();

        function generateCalendar() {
            const calendarGrid = document.getElementById('calendarGrid');
            if (!calendarGrid) return;

            const firstDay = new Date(currentYear, currentMonth, 1);
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());

            calendarGrid.innerHTML = '';

            // Generate 42 days (6 weeks)
            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'schedule-day';
                dayElement.textContent = date.getDate();
                
                // Mark today
                if (date.toDateString() === new Date().toDateString()) {
                    dayElement.classList.add('today');
                }
                
                // Mark other month days
                if (date.getMonth() !== currentMonth) {
                    dayElement.classList.add('other-month');
                }
                
                // Mark days with sessions (example)
                if (Math.random() > 0.8 && date.getMonth() === currentMonth) {
                    dayElement.classList.add('has-session');
                }
                
                calendarGrid.appendChild(dayElement);
            }
        }

        function previousMonth() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            updateCalendarHeader();
            generateCalendar();
        }

        function nextMonth() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            updateCalendarHeader();
            generateCalendar();
        }

        function goToToday() {
            currentDate = new Date();
            currentMonth = currentDate.getMonth();
            currentYear = currentDate.getFullYear();
            updateCalendarHeader();
            generateCalendar();
        }

        function updateCalendarHeader() {
            const monthNames = [
                'January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'
            ];
            const header = document.querySelector('.schedule-header h4');
            if (header) {
                header.textContent = `${monthNames[currentMonth]} ${currentYear}`;
            }
        }

        // Initialize calendar on page load
        document.addEventListener('DOMContentLoaded', function() {
            generateCalendar();
        });

        // Add floating animation to progress circles
        document.querySelectorAll('.progress-circle').forEach(circle => {
            circle.style.animation = 'pulse 2s ease-in-out infinite';
        });

        // Function to load deadlines from localStorage
        // Submission tracking system
        function markAsSubmitted(type, id) {
            const submissionKey = `physicsSubmissions_${type}`;
            let submissions = JSON.parse(localStorage.getItem(submissionKey) || '[]');
            
            // Check if already submitted
            if (!submissions.includes(id)) {
                submissions.push(id);
                localStorage.setItem(submissionKey, JSON.stringify(submissions));
                console.log(`Marked ${type} ${id} as submitted`);
                
                // Refresh deadlines after submission
                loadDeadlines();
            }
        }

        function isSubmitted(type, id) {
            const submissionKey = `physicsSubmissions_${type}`;
            const submissions = JSON.parse(localStorage.getItem(submissionKey) || '[]');
            return submissions.includes(id);
        }

        function loadDeadlinesFromPages() {
            const deadlines = [];
            
            console.log('Loading deadlines from pages...');
            console.log('Physics assignments from localStorage:', JSON.parse(localStorage.getItem('physicsAssignments') || '[]'));
            console.log('Physics quizzes from localStorage:', JSON.parse(localStorage.getItem('physicsQuizzes') || '[]'));
            console.log('Physics exams from localStorage:', JSON.parse(localStorage.getItem('physicsExams') || '[]'));
            
            // Load assignments from localStorage (check physics-specific keys)
            const studentAssignments = JSON.parse(localStorage.getItem('physicsAssignments') || '[]');
            const teacherAssignments = JSON.parse(localStorage.getItem('physicsTeacherAssignments') || '[]');
            const assignmentsList = JSON.parse(localStorage.getItem('physicsAssignmentsList') || '[]');
            
            // No sample data - only show real assignments from teacher panel
            
            // Combine all assignment sources, prioritizing studentAssignments
            let allAssignments = [...studentAssignments];
            teacherAssignments.forEach(teacherAssignment => {
                // Only add if not already in studentAssignments
                if (!allAssignments.find(a => a.id === teacherAssignment.id)) {
                    allAssignments.push(teacherAssignment);
                }
            });
            if (allAssignments.length === 0) {
                allAssignments = assignmentsList;
            }
            
            console.log('Assignments found:', allAssignments.length, allAssignments);
            
            allAssignments.forEach(assignment => {
                // Check if assignment is submitted using our tracking system
                const assignmentSubmitted = isSubmitted('assignment', assignment.id);
                
                // Handle multiple completion status formats for assignments
                const isNotCompleted = (
                    !assignmentSubmitted && (
                        assignment.status !== 'completed' && 
                        assignment.status !== 'graded' &&
                        assignment.completed !== true &&
                        assignment.status !== 'submitted'
                    )
                );
                
                if (assignment.dueDate && isNotCompleted) {
                    const daysUntil = calculateDaysUntil(assignment.dueDate);
                    if (daysUntil >= 0) { // Only show future or today's deadlines
                        console.log('Adding assignment to deadlines:', assignment.title);
                        deadlines.push({
                            type: 'Assignment',
                            subject: assignment.subject || 'Physics',
                            title: assignment.title,
                            dueDate: assignment.dueDate,
                            daysUntil: daysUntil,
                            id: assignment.id
                        });
                    }
                }
            });
            
            // Load quizzes from localStorage (check physics-specific keys)
            const studentQuizzes = JSON.parse(localStorage.getItem('physicsQuizzes') || '[]');
            const teacherQuizzes = JSON.parse(localStorage.getItem('physicsTeacherQuizzes') || '[]');
            const quizzesList = JSON.parse(localStorage.getItem('physicsQuizzesList') || '[]');
            
            // No sample data - only show real quizzes from teacher panel
            
            // Combine all quiz sources, prioritizing studentQuizzes
            let allQuizzes = [...studentQuizzes];
            teacherQuizzes.forEach(teacherQuiz => {
                // Only add if not already in studentQuizzes
                if (!allQuizzes.find(q => q.id === teacherQuiz.id)) {
                    allQuizzes.push(teacherQuiz);
                }
            });
            if (allQuizzes.length === 0) {
                allQuizzes = quizzesList;
            }
            
            console.log('Quizzes found:', allQuizzes.length, allQuizzes);
            console.log('Quiz details:', allQuizzes.map(q => ({ id: q.id, title: q.title, status: q.status, dueDate: q.dueDate, published: q.published })));
            
            allQuizzes.forEach(quiz => {
                // Check if quiz is submitted using our tracking system
                const quizSubmitted = isSubmitted('quiz', quiz.id);
                
                // Check if quiz is published and not completed
                // Handle multiple completion status formats
                const isNotCompleted = (
                    !quizSubmitted && (
                        quiz.completed === false || 
                        quiz.completed === undefined || 
                        quiz.status === 'pending' ||
                        quiz.status === 'available' ||
                        quiz.status === 'published' ||
                        (quiz.status && quiz.status !== 'completed' && quiz.status !== 'graded') ||
                        !quiz.status  // If no status field, assume not completed
                    )
                );
                
                const isPublished = quiz.published === true || quiz.status === 'available' || quiz.status === 'published' || quiz.status === 'pending';
                
                // If no dueDate is set, create one based on published date or current date
                let dueDate = quiz.dueDate;
                if (!dueDate && isPublished) {
                    // If published but no due date, set due date to 7 days from published date or now
                    const publishedDate = quiz.publishedDate ? new Date(quiz.publishedDate) : new Date();
                    dueDate = new Date(publishedDate.getTime() + 7 * 24 * 60 * 60 * 1000).toISOString();
                }
                
                console.log('Quiz:', quiz.title, 'has dueDate:', dueDate, 'published:', isPublished, 'not completed:', isNotCompleted, 'submitted:', quizSubmitted, 'completed field:', quiz.completed, 'status field:', quiz.status);
                
                if (dueDate && isPublished && isNotCompleted) {
                    const daysUntil = calculateDaysUntil(dueDate);
                    if (daysUntil >= 0) {
                        console.log('Adding quiz to deadlines:', quiz.title, 'dueDate:', dueDate, 'daysUntil:', daysUntil);
                        deadlines.push({
                            type: 'Quiz',
                            subject: quiz.subject || 'Physics',
                            title: quiz.title,
                            dueDate: dueDate,
                            daysUntil: daysUntil,
                            id: quiz.id
                        });
                    } else {
                        console.log('Quiz not added to deadlines - daysUntil < 0:', quiz.title, 'daysUntil:', daysUntil);
                    }
                } else {
                    console.log('Quiz not added to deadlines:', quiz.title, 'dueDate:', dueDate, 'isPublished:', isPublished, 'isNotCompleted:', isNotCompleted);
                }
            });
            
            // Load exams from localStorage (check physics-specific keys)
            const studentExams = JSON.parse(localStorage.getItem('physicsExams') || '[]');
            const teacherExams = JSON.parse(localStorage.getItem('physicsTeacherExams') || '[]');
            const examsList = JSON.parse(localStorage.getItem('physicsExamsList') || '[]');
            
            // No sample data - only show real exams from teacher panel
            
            // Combine all exam sources, prioritizing studentExams
            let allExams = [...studentExams];
            teacherExams.forEach(teacherExam => {
                // Only add if not already in studentExams
                if (!allExams.find(e => e.id === teacherExam.id)) {
                    allExams.push(teacherExam);
                }
            });
            if (allExams.length === 0) {
                allExams = examsList;
            }
            
            console.log('Exams found:', allExams.length, allExams);
            
            allExams.forEach(exam => {
                // Check if exam is submitted using our tracking system
                const examSubmitted = isSubmitted('exam', exam.id);
                
                // Check if exam is published and not completed
                // Handle multiple completion status formats
                const isNotCompleted = (
                    !examSubmitted && (
                        exam.completed === false || 
                        exam.completed === undefined || 
                        exam.status === 'pending' ||
                        exam.status === 'available' ||
                        (exam.status && exam.status !== 'completed' && exam.status !== 'graded') ||
                        !exam.status  // If no status field, assume not completed
                    )
                );
                
                const isPublished = exam.published === true || exam.status === 'available';
                
                // If no dueDate is set, create one based on published date or current date
                let dueDate = exam.dueDate;
                if (!dueDate && isPublished) {
                    // If published but no due date, set due date to 7 days from published date or now
                    const publishedDate = exam.publishedDate ? new Date(exam.publishedDate) : new Date();
                    dueDate = new Date(publishedDate.getTime() + 7 * 24 * 60 * 60 * 1000).toISOString();
                }
                
                console.log('Exam:', exam.title, 'has dueDate:', dueDate, 'published:', isPublished, 'not completed:', isNotCompleted, 'submitted:', examSubmitted, 'completed field:', exam.completed, 'status field:', exam.status);
                
                if (dueDate && isPublished && isNotCompleted) {
                    const daysUntil = calculateDaysUntil(dueDate);
                    if (daysUntil >= 0) {
                        console.log('Adding exam to deadlines:', exam.title);
                        deadlines.push({
                            type: 'Exam',
                            subject: exam.subject || 'Physics',
                            title: exam.title,
                            dueDate: dueDate,
                            daysUntil: daysUntil,
                            id: exam.id
                        });
                    }
                }
            });
            
            console.log('Total deadlines found:', deadlines.length);
            console.log('Final deadlines array:', deadlines);
            return deadlines;
        }
        
        // Function to refresh deadlines display
        function loadDeadlines() {
            const deadlinesList = document.getElementById('deadlinesList');
            if (!deadlinesList) return;
            
            const deadlineData = loadDeadlinesFromPages();
            
            // Check if there are no deadlines
            if (deadlineData.length === 0) {
                deadlinesList.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #6c757d;">
                        <iconify-icon icon="material-symbols:check-circle" style="font-size: 3rem; color: #10b981; margin-bottom: 1rem;"></iconify-icon>
                        <p style="font-size: 1.1rem; font-weight: 600; margin-bottom: 0.5rem;">All caught up!</p>
                        <p style="font-size: 0.9rem;">No upcoming deadlines at the moment.</p>
                    </div>
                `;
                return;
            }
            
            // Sort deadlines by days until due (urgent first)
            deadlineData.sort((a, b) => a.daysUntil - b.daysUntil);
            
            let deadlinesHTML = '';
            deadlineData.forEach(deadline => {
                let urgencyClass = 'normal';
                if (deadline.daysUntil === 0) urgencyClass = 'urgent';
                else if (deadline.daysUntil <= 2) urgencyClass = 'warning';
                
                deadlinesHTML += `
                    <div class="deadline-item ${urgencyClass}" data-type="${deadline.type}" data-id="${deadline.id}">
                        <div class="deadline-subject">${deadline.subject}</div>
                        <div class="deadline-title">${deadline.title}</div>
                        <div class="deadline-time">${formatDeadlineTime(deadline.daysUntil, deadline.dueDate)}</div>
                    </div>
                `;
            });
            
            deadlinesList.innerHTML = deadlinesHTML;
        }

        // Expose submission functions globally
        window.markAsSubmitted = markAsSubmitted;
        window.isSubmitted = isSubmitted;
        window.loadDeadlines = loadDeadlines;
        
        // Function to calculate days until deadline
        function calculateDaysUntil(dueDate) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const deadline = new Date(dueDate);
            deadline.setHours(0, 0, 0, 0);
            const diffTime = deadline - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            return diffDays;
        }

        // Function to determine deadline urgency class
        function getDeadlineClass(daysUntil) {
            if (daysUntil === 0) return 'urgent';      // Red - Today
            if (daysUntil <= 3) return 'warning';      // Yellow - 1-3 days
            return 'normal';                            // Green - More than 3 days
        }

        // Function to format deadline time
        function formatDeadlineTime(daysUntil) {
            const today = new Date();
            const deadlineDate = new Date(today);
            deadlineDate.setDate(today.getDate() + daysUntil);
            
            const options = { month: 'short', day: 'numeric', year: 'numeric' };
            const dateStr = deadlineDate.toLocaleDateString('en-US', options);
            
            if (daysUntil === 0) return 'Due: Today at 11:59 PM';
            if (daysUntil === 1) return 'Due: Tomorrow at 11:59 PM';
            if (daysUntil <= 3) return `Due: in ${daysUntil} days (${dateStr})`;
            if (daysUntil <= 7) return `Due: in ${daysUntil} days (${dateStr})`;
            if (daysUntil <= 14) return `Due: in ${Math.ceil(daysUntil / 7)} week${daysUntil > 7 ? 's' : ''} (${dateStr})`;
            return `Due: ${dateStr}`;
        }

        // Function to get type icon
        function getTypeIcon(type) {
            const icons = {
                'Assignment': 'material-symbols:assignment',
                'Quiz': 'material-symbols:quiz',
                'Exam': 'material-symbols:school'
            };
            return icons[type] || 'material-symbols:event';
        }

        // Function to get action button for each deadline type
        function getActionButton(type, title) {
            const buttonStyle = `
                background: linear-gradient(135deg, #667eea, #764ba2);
                border: none;
                color: white;
                padding: 0.5rem 1rem;
                border-radius: 8px;
                font-size: 0.85rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 0.3rem;
                box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
            `;
            
            const hoverStyle = `
                transform: translateY(-2px);
                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            `;
            
            const buttonId = `actionBtn_${type}_${title.replace(/\s+/g, '_')}`;
            
            switch(type) {
                case 'Assignment':
                    return `
                        <button id="${buttonId}" style="${buttonStyle}" 
                                onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.4)'"
                                onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(102, 126, 234, 0.3)'"
                                onclick="startAssignment('${title}')">
                            <iconify-icon icon="material-symbols:play-arrow" style="font-size: 1rem;"></iconify-icon>
                            Start
                        </button>
                    `;
                case 'Quiz':
                    return `
                        <button id="${buttonId}" style="${buttonStyle}" 
                                onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.4)'"
                                onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(102, 126, 234, 0.3)'"
                                onclick="startQuiz('${title}')">
                            <iconify-icon icon="material-symbols:quiz" style="font-size: 1rem;"></iconify-icon>
                            Take Quiz
                        </button>
                    `;
                case 'Exam':
                    return `
                        <button id="${buttonId}" style="${buttonStyle}" 
                                onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.4)'"
                                onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(102, 126, 234, 0.3)'"
                                onclick="startExam('${title}')">
                            <iconify-icon icon="material-symbols:school" style="font-size: 1rem;"></iconify-icon>
                            Take Exam
                        </button>
                    `;
                default:
                    return '';
            }
        }

        // Function to render deadlines
        function renderDeadlines() {
            const deadlinesList = document.getElementById('deadlinesList');
            deadlinesList.innerHTML = '';
            
            // Load deadlines from localStorage
            const deadlineData = loadDeadlinesFromPages();
            
            // Check if there are no deadlines
            if (deadlineData.length === 0) {
                deadlinesList.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #6c757d;">
                        <iconify-icon icon="material-symbols:check-circle" style="font-size: 3rem; color: #10b981; margin-bottom: 1rem;"></iconify-icon>
                        <p style="font-size: 1.1rem; font-weight: 600; margin-bottom: 0.5rem;">All caught up!</p>
                        <p style="font-size: 0.9rem;">No upcoming deadlines at the moment.</p>
                    </div>
                `;
                return;
            }
            
            // Sort deadlines by days until due
            const sortedDeadlines = [...deadlineData].sort((a, b) => a.daysUntil - b.daysUntil);
            
            sortedDeadlines.forEach((deadline, index) => {
                const deadlineClass = getDeadlineClass(deadline.daysUntil);
                const timeText = formatDeadlineTime(deadline.daysUntil);
                const icon = getTypeIcon(deadline.type);
                
                const deadlineItem = document.createElement('div');
                deadlineItem.className = `deadline-item ${deadlineClass}`;
                deadlineItem.style.opacity = '0';
                deadlineItem.style.transform = 'translateY(20px)';
                
                deadlineItem.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <iconify-icon icon="${icon}" style="font-size: 1.5rem; color: ${
                            deadlineClass === 'urgent' ? '#ef4444' : 
                            deadlineClass === 'warning' ? '#f59e0b' : '#10b981'
                        };"></iconify-icon>
                        <div style="flex: 1;">
                            <div class="deadline-subject">${deadline.subject} • ${deadline.type}</div>
                            <div class="deadline-title">${deadline.title}</div>
                            <div class="deadline-time">${timeText}</div>
                        </div>
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            ${getActionButton(deadline.type, deadline.title)}
                        </div>
                    </div>
                `;
                
                deadlinesList.appendChild(deadlineItem);
                
                // Add animation
                setTimeout(() => {
                    deadlineItem.style.transition = 'all 0.3s ease';
                    deadlineItem.style.opacity = '1';
                    deadlineItem.style.transform = 'translateY(0)';
                }, index * 100);
            });
        }

        // Simulate real-time updates
        function updateDeadlines() {
            const deadlineItems = document.querySelectorAll('.deadline-item');
            deadlineItems.forEach(item => {
                // Add subtle animation every few seconds
                setTimeout(() => {
                    item.style.transform = 'translateX(0)';
                    item.style.transition = 'transform 0.3s ease';
                }, Math.random() * 2000);
            });
        }

        // Update deadlines once on load (removed interval to prevent performance issues)
        updateDeadlines();

        // Function to start assignment
        function startAssignment(title) {
            console.log('Starting assignment:', title);
            
            // Find the assignment by title
            const studentAssignments = JSON.parse(localStorage.getItem('physicsAssignments') || '[]');
            const teacherAssignments = JSON.parse(localStorage.getItem('physicsTeacherAssignments') || '[]');
            const assignmentsList = JSON.parse(localStorage.getItem('physicsAssignmentsList') || '[]');
            
            // Combine all assignment sources
            let allAssignments = [...studentAssignments];
            teacherAssignments.forEach(teacherAssignment => {
                if (!allAssignments.find(a => a.id === teacherAssignment.id)) {
                    allAssignments.push(teacherAssignment);
                }
            });
            if (allAssignments.length === 0) {
                allAssignments = assignmentsList;
            }
            
            const assignment = allAssignments.find(a => a.title === title);
            
            if (assignment) {
                // Redirect to homework page with the assignment ID
                window.location.href = `physics-homework.html?start=${assignment.id}`;
            } else {
                // If not found, just go to homework page
                window.location.href = 'physics-homework.html';
            }
        }

        // Function to start quiz
        function startQuiz(title) {
            console.log('Starting quiz:', title);
            
            // Find the quiz by title
            const studentQuizzes = JSON.parse(localStorage.getItem('physicsQuizzes') || '[]');
            const teacherQuizzes = JSON.parse(localStorage.getItem('physicsTeacherQuizzes') || '[]');
            const quizzesList = JSON.parse(localStorage.getItem('physicsQuizzesList') || '[]');
            
            // Combine all quiz sources
            let allQuizzes = [...studentQuizzes];
            teacherQuizzes.forEach(teacherQuiz => {
                if (!allQuizzes.find(q => q.id === teacherQuiz.id)) {
                    allQuizzes.push(teacherQuiz);
                }
            });
            if (allQuizzes.length === 0) {
                allQuizzes = quizzesList;
            }
            
            const quiz = allQuizzes.find(q => q.title === title);
            
            if (quiz) {
                // Redirect to quiz page with the quiz ID
                window.location.href = `physics-quizzes.html?start=${quiz.id}`;
            } else {
                // If not found, just go to quiz page
                window.location.href = 'physics-quizzes.html';
            }
        }

        // Function to start exam
        function startExam(title) {
            console.log('Starting exam:', title);
            
            // Find the exam by title
            const studentExams = JSON.parse(localStorage.getItem('physicsExams') || '[]');
            const teacherExams = JSON.parse(localStorage.getItem('physicsTeacherExams') || '[]');
            const examsList = JSON.parse(localStorage.getItem('physicsExamsList') || '[]');
            
            // Combine all exam sources
            let allExams = [...studentExams];
            teacherExams.forEach(teacherExam => {
                if (!allExams.find(e => e.id === teacherExam.id)) {
                    allExams.push(teacherExam);
                }
            });
            if (allExams.length === 0) {
                allExams = examsList;
            }
            
            const exam = allExams.find(e => e.title === title);
            
            if (exam) {
                // Redirect to exam page with the exam ID
                window.location.href = `physics-exams.html?start=${exam.id}`;
            } else {
                // If not found, just go to exam page
                window.location.href = 'physics-exams.html';
            }
        }

        // Add click effects to cards
        document.querySelectorAll('.dashboard-card, .modern-card').forEach(card => {
            card.addEventListener('click', function() {
                this.style.transform = 'scale(0.98)';
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                }, 150);
            });
        });

        // Update wrong questions count
        function updateWrongQuestionsCount() {
            const wrongQuestions = JSON.parse(localStorage.getItem('physicsWrongQuestions')) || [];
            const customFolders = JSON.parse(localStorage.getItem('physicsCustomFolders')) || [];
            
            // Count questions in all folders (assignments, quizzes, exams, custom folders)
            let totalCount = 0;
            
            // Count questions in predefined activity folders
            const activityTypes = ['assignments', 'quizzes', 'exams'];
            activityTypes.forEach(activityType => {
                const count = wrongQuestions.filter(q => 
                    q.activityType === activityType || q.source === activityType.slice(0, -1)
                ).length;
                totalCount += count;
            });
            
            // Count questions in custom folders
            customFolders.forEach(folder => {
                const count = wrongQuestions.filter(q => q.folderId === folder.id).length;
                totalCount += count;
            });
            
            // Count questions not in any folder (uncategorized)
            const uncategorizedCount = wrongQuestions.filter(q => 
                !q.folderId && !q.activityType && !q.source
            ).length;
            totalCount += uncategorizedCount;
            
            const countElement = document.getElementById('wrongQuestionsCount');
            if (countElement) {
                countElement.textContent = totalCount;
            }
        }
        
        // Update tricky questions count
        function updateTrickyQuestionsCount() {
            const trickyQuestions = JSON.parse(localStorage.getItem('physicsTrickyQuestions')) || [];
            const customFolders = JSON.parse(localStorage.getItem('physicsTrickyCustomFolders')) || [];
            
            // Count questions in all folders (assignments, quizzes, exams, custom folders)
            let totalCount = 0;
            
            // Count questions in predefined activity folders
            const activityTypes = ['assignments', 'quizzes', 'exams'];
            activityTypes.forEach(activityType => {
                const count = trickyQuestions.filter(q => 
                    q.activityType === activityType || q.source === activityType.slice(0, -1)
                ).length;
                totalCount += count;
            });
            
            // Count questions in custom folders
            customFolders.forEach(folder => {
                const count = trickyQuestions.filter(q => q.folderId === folder.id).length;
                totalCount += count;
            });
            
            // Count questions not in any folder (uncategorized)
            const uncategorizedCount = trickyQuestions.filter(q => 
                !q.folderId && !q.activityType && !q.source
            ).length;
            totalCount += uncategorizedCount;
            
            const countElement = document.getElementById('trickyQuestionsCount');
            if (countElement) {
                countElement.textContent = totalCount;
            }
        }

        // Update daily practice statistics
        function updateDailyPracticeStats() {
            // Get today's date in YYYY-MM-DD format
            const today = new Date().toISOString().split('T')[0];
            console.log('📅 Today\'s date:', today);
            
            // Get practice questions from teacher's storage
            const allQuestions = JSON.parse(localStorage.getItem('physics_practice_questions') || '[]');
            console.log('📚 All practice questions from teacher:', allQuestions);
            
            // Filter questions created today
            const todaysQuestions = allQuestions.filter(question => {
                if (!question.createdAt) return false;
                const questionDate = new Date(question.createdAt).toISOString().split('T')[0];
                console.log('📅 Question date:', questionDate, 'Today:', today, 'Match:', questionDate === today);
                return questionDate === today;
            });
            
            console.log('📝 Today\'s questions from teacher:', todaysQuestions);
            
            // Also get legacy student questions as fallback, but filter them by today's date too
            const legacyQuestions = JSON.parse(localStorage.getItem('physics_daily_practice_questions_student') || '[]');
            console.log('📚 All legacy questions:', legacyQuestions);
            
            const todaysLegacyQuestions = legacyQuestions.filter(question => {
                if (!question.createdAt) return false;
                const questionDate = new Date(question.createdAt).toISOString().split('T')[0];
                console.log('📅 Legacy question date:', questionDate, 'Today:', today, 'Match:', questionDate === today);
                return questionDate === today;
            });
            
            console.log('📝 Today\'s legacy questions:', todaysLegacyQuestions);
            
            // Combine and remove duplicates based on question ID
            const allTodaysQuestions = [...todaysQuestions];
            todaysLegacyQuestions.forEach(legacyQuestion => {
                // Only add if not already present (check by ID or question content)
                const exists = allTodaysQuestions.some(existing => 
                    existing.id === legacyQuestion.id || 
                    (existing.question === legacyQuestion.question && existing.type === legacyQuestion.type)
                );
                if (!exists) {
                    allTodaysQuestions.push(legacyQuestion);
                }
            });
            
            console.log('📝 All today\'s questions combined (deduplicated):', allTodaysQuestions);
            
            const streak = parseInt(localStorage.getItem('physicsStreak') || '0');
            const solved = parseInt(localStorage.getItem('physicsQuestionsSolved') || '0');
            const correct = parseInt(localStorage.getItem('physicsCorrectAnswers') || '0');
            
            // Calculate accuracy
            const accuracy = solved > 0 ? Math.round((correct / solved) * 100) : 0;
            
            // Update UI
            document.getElementById('dailyPracticeStreak').textContent = streak;
            document.getElementById('dailyPracticeSolved').textContent = solved;
            document.getElementById('dailyPracticeAccuracy').textContent = accuracy + '%';
            document.getElementById('dailyPracticeAvailable').textContent = allTodaysQuestions.length;
            
            // Update questions overview text
            const overviewText = document.getElementById('questionsOverviewText');
            if (overviewText) {
                if (allTodaysQuestions.length === 0) {
                    overviewText.textContent = 'No questions available today';
                } else if (allTodaysQuestions.length === 1) {
                    overviewText.textContent = '1 question available for today';
                } else {
                    overviewText.textContent = `${allTodaysQuestions.length} questions available for today`;
                }
            }
            
            // Load inline question if available
            loadInlineQuestion(allTodaysQuestions);
        }

        // Global variables for question navigation
        let currentQuestionIndex = 0;
        let allTodaysQuestions = [];

        // Load inline question
        function loadInlineQuestion(questions) {
            const container = document.getElementById('inlineQuestionContainer');
            const noQuestionsMessage = document.getElementById('noQuestionsMessage');
            const questionText = document.getElementById('inlineQuestionText');
            const answerContainer = document.getElementById('inlineAnswerContainer');
            
            // Store questions globally and reset index
            allTodaysQuestions = questions;
            currentQuestionIndex = 0;
            
            if (questions.length > 0) {
                // Check if all questions are solved
                const answeredQuestions = JSON.parse(localStorage.getItem('physicsAnsweredQuestions') || '[]');
                const allSolved = questions.every(question => {
                    const questionId = question.id || `question_${questions.indexOf(question)}_${Date.now()}`;
                    return answeredQuestions.some(q => q.questionId === questionId);
                });
                
                if (allSolved) {
                    // Show completion message
                    container.style.display = 'flex';
                    noQuestionsMessage.style.display = 'none';
                    
                    questionText.innerHTML = `
                        <div style="text-align: center; padding: 2rem;">
                            <div style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1)); width: 100px; height: 100px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem auto;">
                                <iconify-icon icon="material-symbols:celebration" style="font-size: 3rem; color: #10b981;"></iconify-icon>
                            </div>
                            <h3 style="color: #1e293b; margin-bottom: 1rem; font-weight: 700; font-size: 1.8rem;">🎉 All Questions Solved!</h3>
                            <p style="margin: 0; font-size: 1.1rem; color: #64748b;">Today's practice questions are completed.</p>
                            <p style="margin-top: 0.5rem; font-size: 1rem; color: #10b981; font-weight: 600;">
                                <iconify-icon icon="material-symbols:check-circle" style="vertical-align: middle; font-size: 1.2rem; margin-right: 0.5rem;"></iconify-icon>
                                Great job!
                            </p>
                        </div>
                    `;
                    
                    // Hide answer input section
                    const mtAutoDiv = document.querySelector('.question-card .mt-auto');
                    if (mtAutoDiv) {
                        mtAutoDiv.style.display = 'none';
                    }
                } else {
                    displayCurrentQuestion();
                }
            } else {
                container.style.display = 'none';
                noQuestionsMessage.style.display = 'flex';
            }
        }

        // Display current question based on index
        function displayCurrentQuestion() {
            if (allTodaysQuestions.length === 0) return;
            
            const container = document.getElementById('inlineQuestionContainer');
            const noQuestionsMessage = document.getElementById('noQuestionsMessage');
            const questionText = document.getElementById('inlineQuestionText');
            const answerContainer = document.getElementById('inlineAnswerContainer');
            
            const currentQuestion = allTodaysQuestions[currentQuestionIndex];
            
            // Update question counter
            updateQuestionCounter();
            
            // Update navigation buttons
            updateNavigationButtons();
            
            // Check if this question has been answered before
            const questionId = currentQuestion.id || `question_${currentQuestionIndex}_${Date.now()}`;
            const answeredQuestions = JSON.parse(localStorage.getItem('physicsAnsweredQuestions') || '[]');
            const previousAnswer = answeredQuestions.find(q => q.questionId === questionId);
            
            // Handle different question field names from teacher vs student questions
            const questionContent = currentQuestion.question || currentQuestion.questionText || currentQuestion.text || 'No question text available';
            const difficulty = currentQuestion.difficulty || 'Medium';
            const topic = currentQuestion.topic || 'General';
            const questionType = currentQuestion.type || 'Multiple Choice';
            
            console.log('📝 Loading question:', {
                questionContent,
                difficulty,
                topic,
                questionType,
                currentIndex: currentQuestionIndex,
                totalQuestions: allTodaysQuestions.length,
                fullQuestion: currentQuestion,
                previousAnswer: previousAnswer
            });
            
            questionText.innerHTML = `
                <div style="margin-bottom: 1rem;">
                    <div class="d-flex gap-2 mb-2">
                        <span style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 0.4rem 0.8rem; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">
                            ${difficulty}
                        </span>
                        <span style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 0.4rem 0.8rem; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">
                            ${topic}
                        </span>
                        <span style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 0.4rem 0.8rem; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">
                            ${questionType}
                        </span>
                        ${previousAnswer ? `<span style="background: linear-gradient(135deg, #16a34a, #15803d); color: white; padding: 0.4rem 0.8rem; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">Answered</span>` : ''}
                    </div>
                    <div style="font-size: 1.1rem; line-height: 1.6;">${questionContent}</div>
                </div>
            `;
            
            // Create appropriate answer input based on question type
            let answerHtml = '';
            if (currentQuestion.type === 'multiple-choice' && currentQuestion.options && currentQuestion.options.length > 0) {
                // Multiple choice options
                answerHtml = `
                    <div class="mb-3">
                        <label class="form-label" style="font-weight: 600; color: #1e293b; margin-bottom: 1rem;">Select your answer:</label>
                        <div class="multiple-choice-options" style="display: flex; flex-direction: column; gap: 0.75rem;">
                            ${currentQuestion.options.map((option, index) => {
                                const isSelected = previousAnswer && previousAnswer.userAnswer === option;
                                const isCorrect = previousAnswer && previousAnswer.isCorrect && previousAnswer.userAnswer === option;
                                const isWrong = previousAnswer && !previousAnswer.isCorrect && previousAnswer.userAnswer === option;
                                
                                let borderColor = '#e2e8f0';
                                let backgroundColor = 'transparent';
                                
                                if (previousAnswer) {
                                    if (isCorrect) {
                                        borderColor = '#16a34a';
                                        backgroundColor = '#dcfce7';
                                    } else if (isWrong) {
                                        borderColor = '#dc2626';
                                        backgroundColor = '#fef2f2';
                                    }
                                }
                                
                                return `
                                    <label class="option-label" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; border: 2px solid ${borderColor}; border-radius: 10px; cursor: ${previousAnswer ? 'default' : 'pointer'}; transition: all 0.3s ease; background: ${backgroundColor};" onmouseover="${previousAnswer ? '' : "this.style.borderColor='#667eea'"}" onmouseout="${previousAnswer ? '' : "this.style.borderColor='#e2e8f0'"}">
                                        <input type="radio" name="inlineAnswer" value="${option}" style="margin: 0;" ${isSelected ? 'checked' : ''} ${previousAnswer ? 'disabled' : ''}>
                                        <span class="option-text" style="font-size: 0.95rem; color: #1e293b;">${option}</span>
                                    </label>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            } else {
                // Short answer textarea
                answerHtml = `
                    <div class="mb-3">
                        <label class="form-label" style="font-weight: 600; color: #1e293b; margin-bottom: 1rem;">Type your answer:</label>
                        <textarea id="inlineAnswerInput" class="form-control" rows="3" placeholder="Type your answer here..." style="border: 2px solid #e2e8f0; border-radius: 10px; resize: vertical; font-size: 0.95rem; transition: all 0.3s ease;" onfocus="this.style.borderColor='#667eea'" onblur="this.style.borderColor='#e2e8f0'" ${previousAnswer ? 'readonly' : ''}>${previousAnswer ? previousAnswer.userAnswer : ''}</textarea>
                    </div>
                `;
            }
            
            // Update the answer container
            const answerContainerDiv = document.querySelector('.mt-auto .row .col-md-8');
            if (answerContainerDiv) {
                answerContainerDiv.innerHTML = answerHtml;
            }
            
            // Store current question data for submission
            window.currentInlineQuestion = currentQuestion;
            
            container.style.display = 'flex';
            noQuestionsMessage.style.display = 'none';
            
            // If this question was previously answered, show the answer and hide submit buttons
            if (previousAnswer) {
                showInlineAnswer(previousAnswer.userAnswer, previousAnswer.isCorrect);
                
                // Hide submit/answer buttons for already answered questions
                const submitBtn = document.querySelector('.mt-auto .row .col-md-4');
                if (submitBtn) {
                    submitBtn.innerHTML = '';
                }
            } else {
                // Hide any previous answer display
                const answerDisplay = document.getElementById('inlineAnswerDisplay');
                if (answerDisplay) {
                    answerDisplay.style.display = 'none';
                }
                
                // Show submit/answer buttons only if not already there
                const submitBtnContainer = document.querySelector('.mt-auto .row .col-md-4');
                if (submitBtnContainer) {
                    const existingBtns = submitBtnContainer.querySelector('button');
                    if (!existingBtns) {
                        submitBtnContainer.innerHTML = `
                            <button onclick="submitInlineAnswer()" class="btn btn-primary w-100 mb-2" style="font-weight: 600; border-radius: 10px; padding: 0.75rem; transition: all 0.3s ease;">
                                <iconify-icon icon="material-symbols:check" class="me-1"></iconify-icon>
                                Submit
                            </button>
                            <button onclick="showInlineAnswer()" class="btn btn-outline-primary w-100" style="font-weight: 600; border-radius: 10px; padding: 0.75rem; transition: all 0.3s ease;">
                                <iconify-icon icon="material-symbols:visibility" class="me-1"></iconify-icon>
                                Show Answer
                            </button>
                        `;
                    }
                }
            }
        }

        // Update question counter display
        function updateQuestionCounter() {
            const counter = document.getElementById('questionCounter');
            if (counter) {
                counter.textContent = `Question ${currentQuestionIndex + 1} of ${allTodaysQuestions.length}`;
            }
        }

        // Update navigation buttons visibility
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevQuestionBtn');
            const nextBtn = document.getElementById('nextQuestionBtn');
            
            if (prevBtn) {
                prevBtn.style.display = currentQuestionIndex > 0 ? 'block' : 'none';
            }
            
            if (nextBtn) {
                nextBtn.style.display = currentQuestionIndex < allTodaysQuestions.length - 1 ? 'block' : 'none';
            }
        }

        // Navigate to next question
        function nextQuestion() {
            if (currentQuestionIndex < allTodaysQuestions.length - 1) {
                currentQuestionIndex++;
                displayCurrentQuestion();
                // Clear any previous answer display
                const answerDisplay = document.getElementById('inlineAnswerDisplay');
                if (answerDisplay) {
                    answerDisplay.style.display = 'none';
                }
            }
        }

        // Navigate to previous question
        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayCurrentQuestion();
                // Clear any previous answer display
                const answerDisplay = document.getElementById('inlineAnswerDisplay');
                if (answerDisplay) {
                    answerDisplay.style.display = 'none';
                }
            }
        }

        // Submit inline answer
        function submitInlineAnswer() {
            if (!window.currentInlineQuestion) {
                alert('No question available.');
                return;
            }

            // Check if this question has already been answered
            const questionId = window.currentInlineQuestion.id || `question_${currentQuestionIndex}_${Date.now()}`;
            const answeredQuestions = JSON.parse(localStorage.getItem('physicsAnsweredQuestions') || '[]');
            const previousAnswer = answeredQuestions.find(q => q.questionId === questionId);
            
            if (previousAnswer) {
                alert('This question has already been answered.');
                return;
            }

            let answer = '';
            let isCorrect = false;

            if (window.currentInlineQuestion.type === 'multiple-choice') {
                // Handle multiple choice answer
                const selectedOption = document.querySelector('input[name="inlineAnswer"]:checked');
                if (!selectedOption) {
                    alert('Please select an answer before submitting.');
                    return;
                }
                answer = selectedOption.value;
                // Check against correctAnswer, answer, or correctAnswerIndex fields
                const correctAnswerIndex = window.currentInlineQuestion.correctAnswer || 
                                         window.currentInlineQuestion.answer || 
                                         window.currentInlineQuestion.correctAnswerIndex;
                console.log('🔍 Multiple Choice Answer Validation:');
                console.log('Student answer:', answer);
                console.log('Correct answer index:', correctAnswerIndex);
                console.log('Question options:', window.currentInlineQuestion.options);
                console.log('Question object:', window.currentInlineQuestion);
                
                // Convert correct answer index to actual option text
                let correctAnswerText = '';
                if (typeof correctAnswerIndex === 'string' && correctAnswerIndex.match(/^[A-D]$/)) {
                    // If it's a letter (A, B, C, D), convert to index
                    const letterIndex = correctAnswerIndex.charCodeAt(0) - 65; // A=0, B=1, C=2, D=3
                    correctAnswerText = window.currentInlineQuestion.options[letterIndex] || '';
                } else if (typeof correctAnswerIndex === 'number' || !isNaN(parseInt(correctAnswerIndex))) {
                    // If it's a number, use as index
                    const index = parseInt(correctAnswerIndex);
                    correctAnswerText = window.currentInlineQuestion.options[index] || '';
                } else {
                    // If it's already text, use as is
                    correctAnswerText = correctAnswerIndex;
                }
                
                console.log('Correct answer text:', correctAnswerText);
                isCorrect = answer === correctAnswerText;
                console.log('Is correct:', isCorrect);
            } else {
                // Handle short answer
                const answerInput = document.getElementById('inlineAnswerInput');
                if (!answerInput) {
                    alert('Answer input not found.');
                    return;
                }
                answer = answerInput.value.trim();
                if (!answer) {
                    alert('Please enter an answer before submitting.');
                    return;
                }
                // Check against correctAnswer, answer, or correctAnswerIndex fields
                const correctAnswer = window.currentInlineQuestion.correctAnswer || 
                                    window.currentInlineQuestion.answer || 
                                    window.currentInlineQuestion.correctAnswerIndex;
                console.log('🔍 Short Answer Validation:');
                console.log('Student answer:', answer);
                console.log('Correct answer:', correctAnswer);
                console.log('Question object:', window.currentInlineQuestion);
                // Simple answer checking (case-insensitive)
                isCorrect = answer.toLowerCase().includes(correctAnswer.toLowerCase()) ||
                             correctAnswer.toLowerCase().includes(answer.toLowerCase());
                console.log('Is correct:', isCorrect);
            }

            // Update statistics
            let solved = parseInt(localStorage.getItem('physicsQuestionsSolved') || '0');
            let correct = parseInt(localStorage.getItem('physicsCorrectAnswers') || '0');
            let streak = parseInt(localStorage.getItem('physicsStreak') || '0');

            solved++;
            if (isCorrect) {
                correct++;
                streak++;
            } else {
                streak = Math.max(0, streak - 1);
            }

            localStorage.setItem('physicsQuestionsSolved', solved.toString());
            localStorage.setItem('physicsCorrectAnswers', correct.toString());
            localStorage.setItem('physicsStreak', streak.toString());

            // Save the question state to localStorage so it persists on refresh
            const questionState = {
                questionId: questionId,
                userAnswer: answer,
                isCorrect: isCorrect,
                timestamp: new Date().toISOString(),
                questionIndex: currentQuestionIndex,
                question: window.currentInlineQuestion // Store the full question data
            };
            
            // Remove any existing answer for this question
            const filteredAnswers = answeredQuestions.filter(q => q.questionId !== questionId);
            
            // Add the new answer
            filteredAnswers.push(questionState);
            
            // Save back to localStorage
            localStorage.setItem('physicsAnsweredQuestions', JSON.stringify(filteredAnswers));
            
            // Trigger custom event for localStorage update
            const event = new Event('localStorageUpdated');
            document.dispatchEvent(event);

            // Update statistics display
            updateDailyPracticeStats();

            // Check if all questions are now solved
            const allSolved = allTodaysQuestions.every(q => {
                const qId = q.id || `question_${allTodaysQuestions.indexOf(q)}_${Date.now()}`;
                return filteredAnswers.some(a => a.questionId === qId);
            });
            
            if (allSolved) {
                // Show alert and reload to show completion message
                setTimeout(() => {
                    alert('🎉 Congratulations! You\'ve completed all questions for today!');
                    loadInlineQuestion(allTodaysQuestions);
                }, 1500); // Wait 1.5 seconds to show feedback
            } else {
                // Show answer with user's choice preserved
                showInlineAnswer(answer, isCorrect);
                
                if (isCorrect) {
                    // Show congratulations message
                    alert('✅ Correct! Well done!');
                    
                    // For correct answers, move to next question after showing congratulations
                    setTimeout(() => {
                        nextQuestion();
                    }, 2500); // Give time to see the congratulations message
                } else {
                    // For incorrect answers, show answer feedback
                    alert('❌ Not quite right. Check the answer below.');
                }
            }
        }

        // Show inline answer
        function showInlineAnswer(userAnswer = '', isCorrect = false) {
            if (!window.currentInlineQuestion) return;

            const answerDisplay = document.getElementById('inlineAnswerDisplay');
            const correctAnswer = document.getElementById('inlineCorrectAnswer');
            const explanation = document.getElementById('inlineExplanation');

            // Display the correct answer text, not just the index
            const correctAnswerIndex = window.currentInlineQuestion.correctAnswer || 
                                     window.currentInlineQuestion.answer || 
                                     window.currentInlineQuestion.correctAnswerIndex;
            let correctAnswerText = '';
            
            if (window.currentInlineQuestion.type === 'multiple-choice' && window.currentInlineQuestion.options) {
                if (typeof correctAnswerIndex === 'string' && correctAnswerIndex.match(/^[A-D]$/)) {
                    // If it's a letter (A, B, C, D), convert to index
                    const letterIndex = correctAnswerIndex.charCodeAt(0) - 65; // A=0, B=1, C=2, D=3
                    correctAnswerText = window.currentInlineQuestion.options[letterIndex] || correctAnswerIndex;
                } else if (typeof correctAnswerIndex === 'number' || !isNaN(parseInt(correctAnswerIndex))) {
                    // If it's a number, use as index
                    const index = parseInt(correctAnswerIndex);
                    correctAnswerText = window.currentInlineQuestion.options[index] || correctAnswerIndex;
                } else {
                    // If it's already text, use as is
                    correctAnswerText = correctAnswerIndex;
                }
            } else {
                correctAnswerText = correctAnswerIndex;
            }
            
            // Show both user's answer and correct answer
            if (userAnswer) {
                if (isCorrect) {
                    // If correct, only show their correct answer with congratulations
                    correctAnswer.innerHTML = `
                        <div style="margin-bottom: 1rem;">
                            <div style="font-weight: 600; color: #16a34a; margin-bottom: 0.5rem;">
                                <iconify-icon icon="material-symbols:check-circle" style="font-size: 1.2rem; vertical-align: middle; margin-right: 0.5rem;"></iconify-icon>
                                Congratulations! Your Answer:
                            </div>
                            <div style="padding: 0.75rem; border-radius: 8px; background: #dcfce7; border: 2px solid #16a34a; color: #166534; font-weight: 600;">
                                ${userAnswer}
                            </div>
                        </div>
                        <div style="margin-top: 1rem; padding: 0.75rem; background: #f0fdf4; border-radius: 8px; color: #15803d; font-size: 0.9rem;">
                            <iconify-icon icon="material-symbols:celebration" style="font-size: 1.2rem; vertical-align: middle; margin-right: 0.5rem;"></iconify-icon>
                            You got it right! Keep up the great work!
                        </div>
                    `;
                } else {
                    // If wrong, show both user's answer and correct answer
                    correctAnswer.innerHTML = `
                        <div style="margin-bottom: 1rem;">
                            <div style="font-weight: 600; color: #1e293b; margin-bottom: 0.5rem;">Your Answer:</div>
                            <div style="padding: 0.75rem; border-radius: 8px; background: #fef2f2; border: 2px solid #dc2626; color: #991b1b; font-weight: 600;">
                                ${userAnswer}
                            </div>
                        </div>
                        <div>
                            <div style="font-weight: 600; color: #1e293b; margin-bottom: 0.5rem;">Correct Answer:</div>
                            <div style="padding: 0.75rem; border-radius: 8px; background: #dcfce7; border: 2px solid #16a34a; color: #166534; font-weight: 600;">
                                ${correctAnswerText}
                            </div>
                        </div>
                    `;
                }
            } else {
                correctAnswer.textContent = correctAnswerText;
            }
            
            explanation.textContent = window.currentInlineQuestion.explanation || 'No explanation provided.';
            
            answerDisplay.style.display = 'block';
            
            // Hide submit buttons after showing the answer
            const submitBtn = document.querySelector('.mt-auto .row .col-md-4');
            if (submitBtn) {
                submitBtn.innerHTML = '';
            }
        }
        
        // Flashcard functionality - use same data as the physics flashcards page
        function updateFlashcardStats() {
            // Load categories/chapters as defined by the teacher dashboard / flashcards page
            let chapters = [];
            try {
                chapters = JSON.parse(localStorage.getItem('physicsFlashcardsCategories') || '[]');
            } catch (e) {
                chapters = [];
            }

            // Fallback in case there are no categories yet
            if (!Array.isArray(chapters)) {
                chapters = [];
            }

            // For each chapter, recompute cardsCount from actual flashcard storage
            chapters = chapters.map(chapter => {
                const flashcards = JSON.parse(localStorage.getItem(`physicsFlashcards_${chapter.id}`) || '[]');
                return {
                    ...chapter,
                    cardsCount: Array.isArray(flashcards) ? flashcards.length : 0
                };
            });

            const progress = JSON.parse(localStorage.getItem('physicsFlashcardProgress') || '{}');
            const forgottenCards = JSON.parse(localStorage.getItem('physicsForgottenCards') || '{}');
            
            let totalCards = 0;
            let masteredCards = 0;
            let studyingCards = 0;
            let forgottenCount = 0;

            chapters.forEach(chapter => {
                const cardsCount = chapter.cardsCount || 0;
                totalCards += cardsCount;

                const raw = progress[chapter.id] || { mastered: 0, studying: cardsCount };
                const mastered = Math.min(raw.mastered || 0, cardsCount);
                const studying = Math.min(raw.studying || cardsCount, Math.max(cardsCount - mastered, 0));

                masteredCards += mastered;
                studyingCards += studying;
            });

            // Count forgotten cards
            Object.keys(forgottenCards).forEach(chapterId => {
                if (Array.isArray(forgottenCards[chapterId])) {
                    forgottenCount += forgottenCards[chapterId].length;
                }
            });

            // Update UI
            const totalEl = document.getElementById('flashcardTotal');
            const masteredEl = document.getElementById('flashcardMastered');
            const studyingEl = document.getElementById('flashcardStudying');
            const forgottenEl = document.getElementById('flashcardForgotten');
            const forgottenBtnEl = document.getElementById('forgottenCountBtn');

            if (totalEl) totalEl.textContent = totalCards;
            if (masteredEl) masteredEl.textContent = masteredCards;
            if (studyingEl) studyingEl.textContent = studyingCards;
            if (forgottenEl) forgottenEl.textContent = forgottenCount;
            if (forgottenBtnEl) forgottenBtnEl.textContent = forgottenCount;

            const forgottenButtonWrapper = document.getElementById('reviewForgottenBtn');
            if (forgottenButtonWrapper) {
                forgottenButtonWrapper.style.display = forgottenCount === 0 ? 'none' : 'flex';
            }

            // Populate quick access chapters (show first 4 chapters with any cards)
            const quickAccessContainer = document.getElementById('quickAccessChapters');
            if (quickAccessContainer) {
                const visibleChapters = chapters.filter(ch => (ch.cardsCount || 0) > 0).slice(0, 4);

                quickAccessContainer.innerHTML = visibleChapters.map(chapter => {
                    const cardsCount = chapter.cardsCount || 0;
                    const raw = progress[chapter.id] || { mastered: 0 };
                    const mastered = Math.min(raw.mastered || 0, cardsCount);
                    const masteredPercentage = cardsCount > 0 ? Math.round((mastered / cardsCount) * 100) : 0;
                    const icon = chapter.icon || 'material-symbols:style';

                    return `
                        <div class="col-6 col-md-3 mb-3">
                            <div onclick="window.location.href='physics-flashcards.html'" style="background: white; border: 2px solid rgba(102, 126, 234, 0.2); border-radius: 15px; padding: 1rem; text-align: center; cursor: pointer; transition: all 0.3s ease; height: 100%;">
                                <iconify-icon icon="${icon}" style="font-size: 2.5rem; color: #667eea; margin-bottom: 0.5rem;"></iconify-icon>
                                <div style="font-size: 0.85rem; font-weight: 600; color: #1e293b; margin-bottom: 0.5rem;">${chapter.title}</div>
                                <div style="font-size: 0.75rem; color: #6c757d;">${masteredPercentage}% Mastered</div>
                                <div style="height: 4px; background: rgba(102, 126, 234, 0.2); border-radius: 10px; margin-top: 0.5rem; overflow: hidden;">
                                    <div style="height: 100%; background: linear-gradient(135deg, #667eea, #764ba2); width: ${masteredPercentage}%; transition: width 0.3s ease;"></div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');

                // Add hover effect via inline styles
                quickAccessContainer.querySelectorAll('[onclick]').forEach(el => {
                    el.addEventListener('mouseenter', function() {
                        this.style.transform = 'translateY(-5px)';
                        this.style.boxShadow = '0 8px 25px rgba(102, 126, 234, 0.2)';
                        this.style.borderColor = '#667eea';
                    });
                    el.addEventListener('mouseleave', function() {
                        this.style.transform = 'translateY(0)';
                        this.style.boxShadow = 'none';
                        this.style.borderColor = 'rgba(102, 126, 234, 0.2)';
                    });
                });
            }
        }

        // Function to update greeting with student name
        function updateGreeting() {
            const userName = localStorage.getItem('userName');
            const greetingEl = document.getElementById('greetingText');
            
            if (userName && greetingEl) {
                // Get current hour to determine greeting
                const hour = new Date().getHours();
                let greeting = 'Good evening';
                
                if (hour < 12) {
                    greeting = 'Good morning';
                } else if (hour < 18) {
                    greeting = 'Good afternoon';
                }
                
                // Extract first name
                const firstName = userName.split(' ')[0];
                greetingEl.textContent = `${greeting}, ${firstName}!`;
            }
        }

        // Schedule Widget Functions
        function generateScheduleWidget() {
            console.log('generateScheduleWidget called (Physics)');
            const widget = document.getElementById('scheduleWidget');
            console.log('Widget element (Physics):', widget);
            if (!widget) {
                console.log('Widget not found! (Physics)');
                return;
            }

            const currentDate = new Date();
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();
            
            // Load sessions from student-facing schedule store
            const scheduleEntries = JSON.parse(localStorage.getItem('physicsStudentSchedule') || '[]');
            const sessions = scheduleEntries
                .filter(e => {
                    // e.date is yyyy-mm-dd
                    const [y, m, d] = e.date.split('-').map(x => parseInt(x, 10));
                    return y === currentYear && (m - 1) === currentMonth;
                })
                .map(e => ({
                    date: parseInt(e.date.split('-')[2], 10),
                    title: e.title,
                    time: e.time,
                    type: e.type
                }));

            const monthNames = ["January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"];

            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const firstDayOfMonth = new Date(currentYear, currentMonth, 1).getDay();
            const today = currentDate.getDate();

            let calendarHTML = `
                <div class="schedule-widget">
                    <div class="schedule-header">
                        <div class="schedule-view-toggles">
                            <button class="schedule-view-toggle active" onclick="setScheduleView('month')">month</button>
                            <button class="schedule-view-toggle" onclick="setScheduleView('week')">week</button>
                            <button class="schedule-view-toggle" onclick="setScheduleView('day')">day</button>
                        </div>
                        <button class="schedule-today-btn" onclick="goToToday()">today</button>
                    </div>
                    
                    <div class="schedule-calendar">
                        <div class="schedule-days-header">
                            <div class="schedule-day-header">Sun</div>
                            <div class="schedule-day-header">Mon</div>
                            <div class="schedule-day-header">Tue</div>
                            <div class="schedule-day-header">Wed</div>
                            <div class="schedule-day-header">Thu</div>
                            <div class="schedule-day-header">Fri</div>
                            <div class="schedule-day-header">Sat</div>
                        </div>
                        
                        <div class="schedule-days-grid">
            `;

            // Previous month days
            const prevMonth = new Date(currentYear, currentMonth, 0);
            const daysInPrevMonth = prevMonth.getDate();
            for (let i = firstDayOfMonth - 1; i >= 0; i--) {
                calendarHTML += `<div class="schedule-day other-month">${daysInPrevMonth - i}</div>`;
            }

            // Current month days
            for (let day = 1; day <= daysInMonth; day++) {
                const daySessions = sessions.filter(session => session.date === day);
                const hasSession = daySessions.length > 0;
                const isToday = day === today;
                let dayClass = '';
                
                if (isToday) dayClass = 'today';
                else if (hasSession) dayClass = 'has-session';
                
                // Create day cell content - only show day number
                let dayContent = `<div class="day-number">${day}</div>`;
                
                // Add click handler for days with sessions
                const clickHandler = hasSession ? `onclick="showSessionDetails(${day})"` : '';
                
                calendarHTML += `<div class="schedule-day ${dayClass}" ${clickHandler}>${dayContent}</div>`;
            }

            // Next month days
            const remainingCells = 42 - (firstDayOfMonth + daysInMonth);
            for (let day = 1; day <= remainingCells; day++) {
                calendarHTML += `<div class="schedule-day other-month">${day}</div>`;
            }

            calendarHTML += `
                        </div>
                    </div>
                    
                    <div class="schedule-navigation">
                        <div class="schedule-monitor-icon">
                            <iconify-icon icon="material-symbols:monitor"></iconify-icon>
                        </div>
                        <button class="schedule-nav-btn" onclick="navigateSchedule(-1)">
                            <iconify-icon icon="material-symbols:chevron-left"></iconify-icon>
                            <iconify-icon icon="material-symbols:chevron-right"></iconify-icon>
                        </button>
                    </div>
                </div>
            `;

            widget.innerHTML = calendarHTML;
        }

        function setScheduleView(view) {
            // Remove active class from all toggles
            document.querySelectorAll('.schedule-view-toggle').forEach(toggle => {
                toggle.classList.remove('active');
            });
            
            // Add active class to clicked toggle
            event.target.classList.add('active');
            
            // Handle view change (for future implementation)
            console.log(`Switched to ${view} view`);
        }

        function goToToday() {
            console.log('Go to today clicked');
            // Implementation for going to today
        }

        function showSessionDetails(day) {
            const currentDate = new Date();
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();
            const scheduleEntries = JSON.parse(localStorage.getItem('physicsStudentSchedule') || '[]');
            const sessions = scheduleEntries
                .filter(e => {
                    const [y, m, d] = e.date.split('-').map(x => parseInt(x, 10));
                    return y === currentYear && (m - 1) === currentMonth && d === day;
                })
                .map(e => ({
                    date: day,
                    title: e.title,
                    time: e.time,
                    type: e.type
                }));
            
            if (sessions.length > 0) {
                // Create modal HTML
                const monthNames = ["January", "February", "March", "April", "May", "June",
                    "July", "August", "September", "October", "November", "December"];
                const monthName = monthNames[currentMonth];
                
                let sessionsHTML = '';
                sessions.forEach(session => {
                    sessionsHTML += `
                        <div class="session-detail-item" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 1rem; border-radius: 10px; margin-bottom: 1rem;">
                            <div style="font-weight: 600; font-size: 1.1rem; margin-bottom: 0.5rem;">${session.title}</div>
                            <div style="font-size: 0.9rem; opacity: 0.9;">
                                <div><strong>Time:</strong> ${session.time}</div>
                                <div><strong>Type:</strong> ${session.type}</div>
                            </div>
                        </div>
                    `;
                });
                
                const modalHTML = `
                    <div id="sessionDetailsModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; display: flex; align-items: center; justify-content: center;">
                        <div style="background: white; border-radius: 15px; padding: 2rem; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 20px 40px rgba(0,0,0,0.3);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                                <h4 style="margin: 0; color: #1e293b; font-weight: 600;">Sessions on ${monthName} ${day}</h4>
                                <button onclick="closeSessionDetailsModal()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #64748b;">&times;</button>
                            </div>
                            <div>
                                ${sessionsHTML}
                            </div>
                            <div style="text-align: center; margin-top: 1.5rem;">
                                <button onclick="closeSessionDetailsModal()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 0.75rem 2rem; border-radius: 10px; cursor: pointer; font-weight: 600;">Close</button>
                            </div>
                        </div>
                    </div>
                `;
                
                // Remove existing modal if any
                const existingModal = document.getElementById('sessionDetailsModal');
                if (existingModal) {
                    existingModal.remove();
                }
                
                // Add modal to page
                document.body.insertAdjacentHTML('beforeend', modalHTML);
            } else {
                console.log(`No session on day ${day}`);
            }
        }

        function closeSessionDetailsModal() {
            const modal = document.getElementById('sessionDetailsModal');
            if (modal) {
                modal.remove();
            }
        }

        function navigateSchedule(direction) {
            console.log(`Navigate schedule: ${direction > 0 ? 'next' : 'previous'}`);
            // Implementation for navigation
        }
        
        // Open cart functionality
        function openCart() {
            // Get cart items from localStorage
            const cartItems = JSON.parse(localStorage.getItem('cart') || '[]');
            
            if (cartItems.length === 0) {
                alert('Your cart is empty!');
                return;
            }
            
            // Redirect to cart page or open cart modal
            console.log('Opening cart with items:', cartItems.length);
            // window.location.href = 'cart.html'; // Uncomment if you have a cart page
            alert(`Cart has ${cartItems.length} item(s)`);
        }
        
        // Update cart badge count
        function updateCartBadge() {
            const cartItems = JSON.parse(localStorage.getItem('cart') || '[]');
            const cartBadge = document.getElementById('cartBadge');
            
            if (cartBadge) {
                if (cartItems.length > 0) {
                    cartBadge.textContent = cartItems.length > 99 ? '99+' : cartItems.length;
                    cartBadge.style.display = 'flex';
                } else {
                    cartBadge.style.display = 'none';
                }
            }
        }
        
        // Check and show/hide course switcher based on purchased courses
        function checkCourseSwitcherVisibility() {
            const courseSwitcherContainer = document.getElementById('courseSwitcherContainer');
            const dropdownContent = document.querySelector('.dropdown-content');
            
            // Check enrolled courses from localStorage
            const enrolledCourses = JSON.parse(localStorage.getItem('enrolledCourses') || '[]');
            
            // Course mapping with IDs
            const courseMap = {
                '1': 'mathematics',
                '2': 'physics', 
                '3': 'english',
                'mathematics': 'mathematics',
                'physics': 'physics',
                'english': 'english'
            };
            
            // Get purchased courses (convert numeric IDs to string IDs)
            const purchasedCourseIds = enrolledCourses.map(id => courseMap[id] || id).filter(Boolean);
            
            console.log('Enrolled courses from localStorage:', enrolledCourses);
            console.log('Purchased course IDs:', purchasedCourseIds);
            
            // Course details
            const courseDetails = {
                'physics': {
                    name: 'Physics IGCSE',
                    icon: 'material-symbols:science',
                    gradient: 'linear-gradient(135deg, #f093fb, #f5576c)',
                    url: 'physics-dashboard.html'
                },
                'mathematics': {
                    name: 'Mathematics IGCSE',
                    icon: 'material-symbols:calculate',
                    gradient: 'linear-gradient(135deg, #667eea, #764ba2)',
                    url: 'mathematics-dashboard.html'
                },
                'english': {
                    name: 'English IGCSE',
                    icon: 'material-symbols:menu-book',
                    gradient: 'linear-gradient(135deg, #43e97b, #38f9d7)',
                    url: 'english-dashboard.html'
                },
                'chemistry': {
                    name: 'Chemistry IGCSE',
                    icon: 'material-symbols:biotech',
                    gradient: 'linear-gradient(135deg, #4facfe, #00f2fe)',
                    url: 'chemistry-dashboard.html'
                }
            };
            
            // Generate course items HTML for purchased courses only
            if (dropdownContent && purchasedCourseIds.length > 0) {
                let coursesHTML = '';
                
                purchasedCourseIds.forEach(courseId => {
                    const course = courseDetails[courseId];
                    if (!course) return;
                    
                    const isActive = courseId === 'physics';
                    const activeClass = isActive ? 'active' : '';
                    const activeStyle = isActive ? 'background: #f8f9ff;' : '';
                    const checkIcon = isActive ? '<iconify-icon icon="material-symbols:check-circle" style="color: #10b981; font-size: 1.2rem;"></iconify-icon>' : '';
                    const statusText = isActive ? 'Current Course' : 'Available';
                    
                    coursesHTML += `
                        <div class="course-item ${activeClass}" onclick="switchCourse('${courseId}')" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; ${activeStyle}">
                            <div class="course-icon" style="width: 32px; height: 32px; background: ${course.gradient}; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                <iconify-icon icon="${course.icon}" style="color: white; font-size: 1.1rem;"></iconify-icon>
                            </div>
                            <div class="course-info">
                                <div style="font-weight: 600; color: #333; font-size: 0.9rem;">${course.name}</div>
                                <div style="font-size: 0.8rem; color: #666;">${statusText}</div>
                            </div>
                            ${checkIcon}
                        </div>
                    `;
                });
                
                dropdownContent.innerHTML = coursesHTML;
                console.log('✅ Updated course switcher with', purchasedCourseIds.length, 'purchased courses');
            }
            
            // Show/hide course switcher based on number of purchased courses
            if (courseSwitcherContainer) {
                if (purchasedCourseIds.length > 1) {
                    courseSwitcherContainer.style.display = 'flex';
                    console.log('✅ Showing course switcher (multiple courses)');
                } else {
                    courseSwitcherContainer.style.display = 'none';
                    console.log('ℹ️ Hiding course switcher (only one course)');
                }
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // Set current course for todolists page detection
            localStorage.setItem('lastViewedCourse', 'physics');
            
            // Update greeting with student name
            updateGreeting();
            
            // Load todos from localStorage
            loadTodosFromLocalStorage();
            
            // Render deadlines
            renderDeadlines();
            
            // Update flashcard stats
            updateFlashcardStats();
            
            // Update daily practice stats
            updateDailyPracticeStats();
            
            // Render leaderboard (will fetch from API)
            renderLeaderboard();
            
            // Update Alex's profile information
            updateAlexProfile();
            
            // Update wrong questions count
            updateWrongQuestionsCount();
            
            // Update tricky questions count
            updateTrickyQuestionsCount();
            
            // Check and show/hide course switcher based on purchased courses
            checkCourseSwitcherVisibility();
            
            // Update cart badge
            updateCartBadge();
            
            // Listen for localStorage changes (when assignments/quizzes/exams are completed)
            window.addEventListener('storage', function(e) {
                if (e.key === 'mathematicsAssignments' || e.key === 'mathematicsQuizzes' || e.key === 'mathematicsExams' ||
                    e.key === 'physicsAssignments' || e.key === 'physicsQuizzes' || e.key === 'physicsExams') {
                    console.log('Detected change in', e.key, '- updating points');
                    updateAlexProfile();
                    renderLeaderboard();
                }
            });
            
            // Also listen for custom localStorageUpdated event (dispatched when items are saved on the same page)
            document.addEventListener('localStorageUpdated', function(e) {
                console.log('Detected localStorageUpdated event - updating points');
                updateAlexProfile();
                renderLeaderboard();
            });
            
            // Update Alex profile once on load (removed interval to prevent infinite loop)
            updateAlexProfile();
            
            // Generate schedule widget (at the end to ensure DOM is ready)
            setTimeout(() => {
                generateScheduleWidget();
            }, 100);
        });

        // Cache for student points to prevent repeated calculations
        let studentPointsCache = {};
        let cacheExpiry = Date.now() + 30000; // Cache for 30 seconds

        // Function to clear the cache (call when data changes)
        function clearStudentPointsCache() {
            studentPointsCache = {};
            cacheExpiry = Date.now() + 30000;
        }

        // Function to calculate student points from completed work
        function calculateStudentPoints(studentId) {
            // Check cache first
            if (studentPointsCache[studentId] && Date.now() < cacheExpiry) {
                return studentPointsCache[studentId];
            }

            let totalPoints = 0;
            let quizPoints = 0;
            let assignmentPoints = 0;
            let examPoints = 0;
            let completedQuizzes = 0;
            let completedAssignments = 0;
            let completedExams = 0;

            // Calculate quiz points from all quiz storage keys
            const studentQuizzes = JSON.parse(localStorage.getItem('physicsQuizzes') || '[]');
            const teacherQuizzes = JSON.parse(localStorage.getItem('physicsTeacherQuizzes') || '[]');
            const quizList = JSON.parse(localStorage.getItem('physicsQuizzesList') || '[]');
            
            console.log('Calculating points - All quizzes:', [...studentQuizzes, ...teacherQuizzes, ...quizList]);
            
            [...studentQuizzes, ...teacherQuizzes, ...quizList].forEach(quiz => {
                // Check if quiz is completed by current student (support both old and new completion status)
                const isCompleted = (quiz.completed === true || quiz.status === 'completed');
                const hasScore = (quiz.score !== undefined && quiz.score !== null);
                
                if (isCompleted && hasScore) {
                    // Calculate points based on score percentage
                    let points = 0;
                    
                    if (quiz.totalPoints && quiz.score !== undefined) {
                        // Calculate percentage and multiply by total points
                        const percentage = quiz.score / quiz.totalPoints;
                        points = Math.round(percentage * (quiz.totalPoints || quiz.points || (quiz.questions ? quiz.questions.length * 10 : 50)));
                    } else if (quiz.score && quiz.score <= 100) {
                        // If score is a percentage (0-100)
                        points = Math.round((quiz.score / 100) * (quiz.points || (quiz.questions ? quiz.questions.length * 10 : 50)));
                    } else if (quiz.score) {
                        // Use score directly if it's already in points
                        points = quiz.score;
                    }
                    
                    console.log(`Quiz "${quiz.title}" earned ${points} points (score: ${quiz.score}, totalPoints: ${quiz.totalPoints})`);
                    quizPoints += points;
                    totalPoints += points;
                    completedQuizzes++;
                }
            });

            // Calculate assignment points from all assignment storage keys
            const studentAssignments = JSON.parse(localStorage.getItem('physicsAssignments') || '[]');
            const teacherAssignments = JSON.parse(localStorage.getItem('physicsTeacherAssignments') || '[]');
            const mathematicsAssignments = JSON.parse(localStorage.getItem('physicsAssignmentsList') || '[]');
            
            console.log('Calculating points - All assignments:', [...studentAssignments, ...teacherAssignments, ...mathematicsAssignments]);
            
            [...studentAssignments, ...teacherAssignments, ...mathematicsAssignments].forEach(assignment => {
                console.log(`Checking assignment: "${assignment.title}" - status: ${assignment.status}, completed: ${assignment.completed}, score: ${assignment.score}, totalScore: ${assignment.totalScore}, finalScore: ${assignment.finalScore}, points: ${assignment.points}`);
                
                // Check if assignment is completed (support both old and new completion status)
                const isCompleted = (assignment.status === 'completed' || assignment.completed === true || assignment.gradingStatus === 'graded');
                const hasScore = (assignment.score !== undefined && assignment.score !== null) || 
                               (assignment.finalScore !== undefined && assignment.finalScore !== null);
                
                if (isCompleted && hasScore) {
                    // Calculate points based on the assignment's point value
                    let points = 0;
                    
                    // Use finalScore if available, otherwise use score
                    const actualScore = assignment.finalScore !== undefined ? assignment.finalScore : assignment.score;
                    const maxPoints = assignment.totalPoints || assignment.points || 100;
                    
                    if (assignment.totalPoints && actualScore !== undefined) {
                        // Calculate percentage and multiply by total points
                        const percentage = actualScore / assignment.totalPoints;
                        points = Math.round(percentage * maxPoints);
                    } else if (assignment.points && actualScore !== undefined) {
                        // If assignment has a points field but no totalPoints, calculate percentage from score/points
                        const percentage = actualScore / assignment.points;
                        points = Math.round(percentage * assignment.points);
                    } else if (actualScore && actualScore <= 100) {
                        // If score is a percentage (0-100), use it directly
                        const percentage = actualScore / 100;
                        points = Math.round(percentage * 75); // Default 75 points for assignments
                    } else if (assignment.questions && actualScore !== undefined) {
                        // Calculate based on number of questions
                        const percentage = actualScore / (assignment.questions.length * 100);
                        points = Math.round(percentage * assignment.questions.length * 15);
                    } else if (actualScore) {
                        // Use score directly if it's already in points
                        points = actualScore;
                    }
                    
                    console.log(`Assignment "${assignment.title}" earned ${points} points (score: ${actualScore}/${assignment.totalPoints || maxPoints})`);
                    assignmentPoints += points;
                    totalPoints += points;
                    completedAssignments++;
                }
            });

            // Calculate exam points from all exam storage keys
            const studentExams = JSON.parse(localStorage.getItem('physicsExams') || '[]');
            const teacherExams = JSON.parse(localStorage.getItem('physicsTeacherExams') || '[]');
            const mathematicsExams = JSON.parse(localStorage.getItem('physicsExamsList') || '[]');
            
            console.log('Calculating points - All exams:', [...studentExams, ...teacherExams, ...mathematicsExams]);
            
            [...studentExams, ...teacherExams, ...mathematicsExams].forEach(exam => {
                // Check if exam is completed (support both old and new completion status)
                const isCompleted = (exam.completed === true || exam.status === 'completed');
                const hasScore = (exam.score !== undefined && exam.score !== null);
                
                if (isCompleted && hasScore) {
                    // Calculate points based on score percentage
                    let points = 0;
                    
                    // Check if we have a percentage field
                    if (exam.percentage !== undefined) {
                        // Use percentage directly
                        points = Math.round((exam.percentage / 100) * (exam.points || exam.totalPoints || (exam.questions ? exam.questions.length * 20 : 100)));
                    } else if (exam.totalPoints && exam.score !== undefined) {
                        // Calculate percentage from score and totalPoints
                        const percentage = exam.score / exam.totalPoints;
                        points = Math.round(percentage * (exam.totalPoints || exam.points || (exam.questions ? exam.questions.length * 20 : 100)));
                    } else if (exam.score && exam.score <= 100) {
                        // If score is a percentage (0-100)
                        points = Math.round((exam.score / 100) * (exam.points || (exam.questions ? exam.questions.length * 20 : 100)));
                    } else if (exam.score) {
                        // Use score directly if it's already in points
                        points = exam.score;
                    }
                    
                    console.log(`Exam "${exam.title}" earned ${points} points (score: ${exam.score}, totalPoints: ${exam.totalPoints}, percentage: ${exam.percentage})`);
                    examPoints += points;
                    totalPoints += points;
                    completedExams++;
                }
            });
            
            console.log('Total points calculated:', {totalPoints, quizPoints, assignmentPoints, examPoints, completedQuizzes, completedAssignments, completedExams});

            const result = {
                totalPoints,
                quizPoints,
                assignmentPoints,
                examPoints,
                completedQuizzes,
                completedAssignments,
                completedExams
            };

            // Cache the result
            studentPointsCache[studentId] = result;
            
            return result;
        }

        // Function to render the leaderboard
        function renderLeaderboard() {
            const leaderboardList = document.getElementById('leaderboardList');
            
            // Show loading state
            leaderboardList.innerHTML = `
                <div style="text-align: center; padding: 2rem; color: #666;">
                    <iconify-icon icon="material-symbols:hourglass-empty" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></iconify-icon>
                    <p style="font-weight: 600;">Loading leaderboard...</p>
                </div>
            `;
            
            // Fetch enrolled students from API
            const apiUrl = (window.API_CONFIG && window.API_CONFIG.apiURL) || 'http://localhost:3000/api';
            const token = localStorage.getItem('authToken'); // Fixed: Use 'authToken' instead of 'token'
            
            console.log('🔍 Leaderboard Debug:');
            console.log('- API URL:', apiUrl);
            console.log('- Token exists:', !!token);
            console.log('- Token length:', token ? token.length : 0);
            console.log('- Token starts with Bearer:', token ? token.startsWith('Bearer ') : false);
            
            // Check if user is logged in by checking for currentUser
            const currentUser = localStorage.getItem('currentUser');
            console.log('👤 Current user in localStorage:', !!currentUser);
            if (currentUser) {
                try {
                    const userObj = JSON.parse(currentUser);
                    console.log('👤 User email:', userObj.email);
                    console.log('👤 User name:', `${userObj.firstName || ''} ${userObj.lastName || ''}`.trim());
                } catch (e) {
                    console.log('❌ Error parsing currentUser:', e);
                }
            }
            
            // Also check user info from separate keys
            const userEmail = localStorage.getItem('userEmail');
            const userName = localStorage.getItem('userName');
            const userRole = localStorage.getItem('userRole');
            console.log('👤 User from separate keys:', { userEmail, userName, userRole });
            
            if (!token) {
                // If no token, show message
                console.log('❌ No authToken found in localStorage');
                leaderboardList.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #666;">
                        <iconify-icon icon="material-symbols:login" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></iconify-icon>
                        <p style="font-weight: 600; margin-bottom: 0.5rem;">Please login to view leaderboard</p>
                        <p style="font-size: 0.9rem; opacity: 0.8;">Login to see enrolled students rankings.</p>
                        <p style="font-size: 0.8rem; color: #999; margin-top: 1rem;">Debug: No authentication token found</p>
                    </div>
                `;
                return;
            }
            
            const requestUrl = `${apiUrl}/course/physics/students`;
            console.log('🌐 Making request to:', requestUrl);
            
            fetch(requestUrl, {
                headers: {
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json'
                }
            })
            .then(response => {
                console.log('📡 Response status:', response.status);
                console.log('📡 Response ok:', response.ok);
                return response.json();
            })
            .then(data => {
                console.log('📊 API Response:', data);
                
                if (!data.success || !data.students || data.students.length === 0) {
                    // No students enrolled
                    console.log('📭 No students found or API error');
                    leaderboardList.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: #666;">
                            <iconify-icon icon="material-symbols:person-off" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></iconify-icon>
                            <p style="font-weight: 600; margin-bottom: 0.5rem;">No students registered yet</p>
                            <p style="font-size: 0.9rem; opacity: 0.8;">The leaderboard will appear when students enroll in this course.</p>
                        </div>
                    `;
                    return;
                }
                
                console.log('✅ Found students:', data.students.length);
                
                // Sync API data to localStorage for personalized greeting / profile
                localStorage.setItem('physicsStudents', JSON.stringify(data.students));
                console.log('🔄 Synced API data to localStorage');
                
                // Update personalized greeting with current user's points
                const currentUserEmail = localStorage.getItem('userEmail');
                const currentUser = data.students.find(student => 
                    student.email === currentUserEmail || 
                    student.first_name?.toLowerCase() === 'alex' ||
                    student.name?.toLowerCase().includes('alex')
                );
                
                if (currentUser) {
                    console.log('🎯 Found current user in API data:', currentUser);
                    
                    // Recalculate points from completed work for the current user
                    const pointsData = calculateStudentPoints(currentUser.id);
                    const totalPoints = pointsData.totalPoints != null
                        ? pointsData.totalPoints
                        : (currentUser.points || 0);

                    // Persist recalculated points into localStorage-backed students
                    const syncedStudents = JSON.parse(localStorage.getItem('physicsStudents') || '[]');
                    const idx = syncedStudents.findIndex(s => s.id === currentUser.id);
                    if (idx !== -1) {
                        syncedStudents[idx] = {
                            ...syncedStudents[idx],
                            ...pointsData,
                            points: totalPoints,
                            totalPoints
                        };
                        localStorage.setItem('physicsStudents', JSON.stringify(syncedStudents));
                    }

                    // Also mutate the in-memory API students array so the leaderboard
                    // row for the current user shows the same unified points value.
                    const apiIndex = data.students.findIndex(s => s.id === currentUser.id);
                    if (apiIndex !== -1) {
                        data.students[apiIndex] = {
                            ...data.students[apiIndex],
                            ...pointsData,
                            points: totalPoints,
                            totalPoints
                        };
                    }
                    
                    // Update personalized greeting with unified total points
                    const totalPointsElement = document.getElementById('totalPoints');
                    if (totalPointsElement) {
                        totalPointsElement.textContent = `${totalPoints} points`;
                    }
                    
                    // Update ranking
                    const sortedStudents = [...data.students].map(s => {
                        if (s.id === currentUser.id) {
                            return { ...s, points: totalPoints, totalPoints };
                        }
                        return s;
                    }).sort((a, b) => (b.points || 0) - (a.points || 0));
                    const userRank = sortedStudents.findIndex(student => student.id === currentUser.id) + 1;
                    const rankingElement = document.getElementById('studentRanking');
                    if (rankingElement) {
                        rankingElement.textContent = `#${userRank} in class`;
                    }
                    
                    console.log('✅ Updated personalized greeting - Points:', totalPoints, 'Rank:', userRank);
                }
                
                // Generate leaderboard HTML with real student data
                const leaderboardHtml = data.students.map((student, index) => {
                    const rank = index + 1;
                    const rankClass = rank <= 3 ? `rank-${rank}` : '';
                    const initials = (student.first_name && student.last_name) 
                        ? `${student.first_name[0]}${student.last_name[0]}`.toUpperCase()
                        : 'ST';
                    const fullName = `${student.first_name || 'Student'} ${student.last_name || ''}`.trim();
                    const points = (student.totalPoints != null ? student.totalPoints : student.points) || 0;
                    const subjects = 'Physics';
                    
                    return `
                        <div class="leaderboard-item ${rankClass}">
                            <div class="rank-number">${rank}</div>
                            <div class="student-avatar">${initials}</div>
                            <div class="student-info">
                                <div class="student-name">${fullName}</div>
                                <div class="student-score">${subjects}</div>
                            </div>
                            <div class="student-points">${points.toLocaleString()}</div>
                        </div>
                    `;
                }).join('');
                
                leaderboardList.innerHTML = leaderboardHtml;
            })
            .catch(error => {
                console.error('❌ Error fetching leaderboard data:', error);
                leaderboardList.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #666;">
                        <iconify-icon icon="material-symbols:error" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></iconify-icon>
                        <p style="font-weight: 600; margin-bottom: 0.5rem;">Unable to load leaderboard</p>
                        <p style="font-size: 0.9rem; opacity: 0.8;">Please check your connection and try again.</p>
                    </div>
                `;
            });
        }

        // Sidebar Menu Functions
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (sidebar.style.left === '-350px' || sidebar.style.left === '') {
                // Open sidebar
                sidebar.style.left = '0';
                overlay.style.display = 'block';
                document.body.style.overflow = 'hidden'; // Prevent background scrolling
            } else {
                // Close sidebar
                sidebar.style.left = '-350px';
                overlay.style.display = 'none';
                document.body.style.overflow = 'auto'; // Restore scrolling
                
                // Close all submenus when closing sidebar
                closeAllSubmenus();
            }
        }

        function toggleSubmenu(menuId) {
            const submenu = document.getElementById(menuId + '-submenu');
            const arrow = document.getElementById(menuId + '-arrow');
            
            if (submenu.style.display === 'none' || submenu.style.display === '') {
                // Close other submenus first
                closeAllSubmenus();
                
                // Open this submenu
                submenu.style.display = 'block';
                arrow.style.transform = 'rotate(180deg)';
            } else {
                // Close this submenu
                submenu.style.display = 'none';
                arrow.style.transform = 'rotate(0deg)';
            }
        }

        function closeAllSubmenus() {
            const submenus = ['books', 'lectures', 'progress', 'practice', 'badges', 'papers'];
            
            submenus.forEach(menuId => {
                const submenu = document.getElementById(menuId + '-submenu');
                const arrow = document.getElementById(menuId + '-arrow');
                
                if (submenu) {
                    submenu.style.display = 'none';
                }
                if (arrow) {
                    arrow.style.transform = 'rotate(0deg)';
                }
            });
        }

        // Close sidebar when clicking outside (overlay)
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const hamburgerBtn = document.querySelector('.hamburger-menu-btn');
            
            // Check if click is outside sidebar and not on hamburger button
            if (!sidebar.contains(event.target) && !hamburgerBtn.contains(event.target)) {
                if (sidebar.style.left === '0') {
                    toggleSidebar();
                }
            }
        });

        // Close sidebar on escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const sidebar = document.getElementById('sidebar');
                if (sidebar.style.left === '0') {
                    toggleSidebar();
                }
            }
        });

        // Badges Bar Functions
        function toggleBadgesBar() {
            const badgesBar = document.getElementById('badgesBar');
            if (badgesBar.style.display === 'none') {
                badgesBar.style.display = 'block';
                // Smooth slide down animation
                badgesBar.style.opacity = '0';
                badgesBar.style.transform = 'translateY(-20px)';
                setTimeout(() => {
                    badgesBar.style.transition = 'all 0.3s ease';
                    badgesBar.style.opacity = '1';
                    badgesBar.style.transform = 'translateY(0)';
                }, 10);
            } else {
                // Smooth slide up animation
                badgesBar.style.transition = 'all 0.3s ease';
                badgesBar.style.opacity = '0';
                badgesBar.style.transform = 'translateY(-20px)';
                setTimeout(() => {
                    badgesBar.style.display = 'none';
                }, 300);
            }
        }

        // Global function accessible from other pages to trigger points update
        window.updateStudentPoints = function() {
            if (typeof updateAlexProfile === 'function') {
                updateAlexProfile();
            }
            if (typeof renderLeaderboard === 'function') {
                renderLeaderboard();
            }
        };

        // Function to update Alex's ranking and badges
        function updateAlexProfile() {
            const students = JSON.parse(localStorage.getItem('physicsStudents') || '[]');
            
            // Find Alex in the students list (assuming Alex is the first student or has a specific ID)
            let alex = students.find(student => student.name && student.name.toLowerCase().includes('alex')) || students[0];
            
            if (alex) {
                // Recalculate Alex's points from completed work
                const pointsData = calculateStudentPoints(alex.id);
                alex = {
                    ...alex,
                    ...pointsData
                };
                
                // Update the student in the array and save
                const alexIndex = students.findIndex(s => s.id === alex.id);
                if (alexIndex !== -1) {
                    students[alexIndex] = alex;
                    localStorage.setItem('physicsStudents', JSON.stringify(students));
                }
                
                // Calculate ranking
                const sortedStudents = [...students].sort((a, b) => b.totalPoints - a.totalPoints);
                const alexRank = sortedStudents.findIndex(student => student.id === alex.id) + 1;
                
                // Update ranking display
                const rankingElement = document.getElementById('studentRanking');
                if (rankingElement) {
                    rankingElement.textContent = `#${alexRank} in class`;
                }
                
                // Update total points display
                const totalPointsElement = document.getElementById('totalPoints');
                if (totalPointsElement) {
                    totalPointsElement.textContent = `${alex.totalPoints} points`;
                }
                
                console.log('Updated Alex profile - Points:', alex.totalPoints, 'Rank:', alexRank);
                
                // Calculate earned badges based on achievements
                let earnedBadges = 0;
                let badgeDescriptions = [];
                
                // Quiz Master Badge (complete 5+ quizzes)
                if (alex.completedQuizzes >= 5) {
                    earnedBadges++;
                    badgeDescriptions.push('Quiz Master');
                }
                
                // Assignment Ace Badge (complete assignments with high scores)
                if (alex.completedAssignments >= 3) {
                    earnedBadges++;
                    badgeDescriptions.push('Assignment Ace');
                }
                
                // Study Streak Badge (active recently)
                const lastActive = new Date(alex.lastActive);
                const daysSinceActive = (new Date() - lastActive) / (1000 * 60 * 60 * 24);
                if (daysSinceActive <= 7) {
                    earnedBadges++;
                    badgeDescriptions.push('Study Streak');
                }
                
                // Top Performer Badge (rank in top 3)
                if (alexRank <= 3) {
                    earnedBadges++;
                    badgeDescriptions.push('Top Performer');
                }
                
                // Update badges count
                const badgesElement = document.getElementById('earnedBadges');
                if (badgesElement) {
                    badgesElement.textContent = `${earnedBadges} badges`;
                }
                
                console.log(`Alex's Profile Updated: Rank #${alexRank}, ${earnedBadges} badges earned`);
            }
        }

        // Navigation Button Functions
        function navigateToProfile() {
            console.log('Profile button clicked');
            
            // Get actual user info from localStorage
            const userName = localStorage.getItem('userName') || 'Student';
            const userEmail = localStorage.getItem('userEmail') || 'student@example.com';
            
            // Calculate total points from completed work
            const pointsData = calculateStudentPoints();
            const totalPoints = pointsData.totalPoints || 0;
            
            // Create profile dropdown menu
            const dropdownHtml = `
                <div id="profileDropdown" style="position: fixed; top: 70px; right: 20px; background: white; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.15); padding: 1rem; z-index: 9999; min-width: 250px; animation: fadeIn 0.3s ease;">
                    <div style="border-bottom: 1px solid #e9ecef; padding-bottom: 0.75rem; margin-bottom: 0.75rem;">
                        <div style="font-weight: 600; color: #333; font-size: 1.1rem;">${userName}</div>
                        <div style="font-size: 0.85rem; color: #666;">${userEmail}</div>
                        <div style="margin-top: 0.5rem; display: flex; gap: 0.5rem;">
                            <span style="background: #667eea; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">${totalPoints} pts</span>
                            <span style="background: #22c55e; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">Active</span>
                        </div>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                        <button onclick="event.stopPropagation(); window.location.href='student-profile.html'" style="width: 100%; text-align: left; padding: 0.75rem; background: transparent; border: none; cursor: pointer; border-radius: 8px; transition: all 0.2s; display: flex; align-items: center; gap: 0.5rem;" onmouseover="this.style.background='#f3f4f6'" onmouseout="this.style.background='transparent'">
                            <iconify-icon icon="material-symbols:person" style="font-size: 1.2rem; color: #667eea;"></iconify-icon>
                            <span>My Profile</span>
                        </button>
                        <button onclick="event.stopPropagation(); handleLogout()" style="width: 100%; text-align: left; padding: 0.75rem; background: transparent; border: none; cursor: pointer; border-radius: 8px; transition: all 0.2s; display: flex; align-items: center; gap: 0.5rem; color: #ef4444;" onmouseover="this.style.background='#fef2f2'" onmouseout="this.style.background='transparent'">
                            <iconify-icon icon="material-symbols:logout" style="font-size: 1.2rem;"></iconify-icon>
                            <span>Logout</span>
                        </button>
                    </div>
                </div>
            `;
            
            // Remove existing dropdown if any
            const existing = document.getElementById('profileDropdown');
            if (existing) {
                existing.remove();
                return;
            }
            
            // Add dropdown to page
            document.body.insertAdjacentHTML('beforeend', dropdownHtml);
            
            // Close on outside click
            setTimeout(() => {
                document.addEventListener('click', function closeDropdown(e) {
                    const dropdown = document.getElementById('profileDropdown');
                    if (dropdown && !dropdown.contains(e.target)) {
                        dropdown.remove();
                        document.removeEventListener('click', closeDropdown);
                    }
                }, {once: false});
            }, 100);
        }
        
        function handleLogout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('token');
                localStorage.removeItem('authToken');
                localStorage.removeItem('userEmail');
                localStorage.removeItem('userName');
                localStorage.removeItem('userId');
                localStorage.removeItem('userLoggedIn');
                window.location.href = 'index.html';
            }
        }

        function navigateToCommunity() {
            console.log('Community button clicked');
            window.location.href = 'physics-community.html';
        }

        function navigateToNotifications() {
            console.log('Notifications button clicked');
            showNotificationsModal();
        }

        function navigateToFocusMode() {
            console.log('Focus Mode button clicked');
            showFocusModeModal();
        }
        
        function showFocusModeModal() {
            const modalHtml = `
                <div id="focusModeModal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.95); z-index: 99999; display: flex; align-items: center; justify-content: center; animation: fadeIn 0.3s ease;">
                    <iframe src="focus-mode.html" style="width: 95vw; height: 95vh; border: none; border-radius: 24px; box-shadow: 0 20px 60px rgba(0,0,0,0.5);"></iframe>
                    <button onclick="closeFocusMode()" style="position: absolute; top: 2rem; right: 2rem; background: rgba(255,255,255,0.9); border: none; width: 50px; height: 50px; border-radius: 50%; cursor: pointer; font-size: 1.5rem; color: #333; box-shadow: 0 4px 12px rgba(0,0,0,0.3); transition: all 0.3s;" onmouseover="this.style.background='white'; this.style.transform='scale(1.1)'" onmouseout="this.style.background='rgba(255,255,255,0.9)'; this.style.transform='scale(1)'">
                        ×
                    </button>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            document.body.style.overflow = 'hidden';
            
            // Start blocking websites
            startWebsiteBlocking();
        }
        
        function closeFocusMode() {
            const modal = document.getElementById('focusModeModal');
            if (modal) {
                modal.remove();
            }
            document.body.style.overflow = 'auto';
            stopWebsiteBlocking();
        }
        
        // Website blocking system
        let blockingInterval = null;
        
        function startWebsiteBlocking() {
            // Check for blocked sites every second
            blockingInterval = setInterval(() => {
                const blockedSites = JSON.parse(localStorage.getItem('blockedSites') || '[]');
                const currentUrl = window.location.href;
                
                // This is a demo - actual blocking requires a browser extension
                console.log('Blocking active. Blocked sites:', blockedSites);
            }, 1000);
        }
        
        function stopWebsiteBlocking() {
            if (blockingInterval) {
                clearInterval(blockingInterval);
                blockingInterval = null;
            }
        }
        
        // Check if user tries to open blocked sites (demonstration)
        window.addEventListener('beforeunload', function(e) {
            const blockedSites = JSON.parse(localStorage.getItem('blockedSites') || '[]');
            if (blockedSites.length > 0 && document.getElementById('focusModeModal')) {
                // This would work if we could intercept navigation
                console.log('Focus mode active - some sites are blocked');
            }
        });

        // Course Switcher Functions
        function toggleCourseDropdown() {
            const dropdown = document.getElementById('courseDropdown');
            const arrow = document.getElementById('courseDropdownArrow');
            
            if (dropdown.style.opacity === '1') {
                // Close dropdown
                dropdown.style.opacity = '0';
                dropdown.style.visibility = 'hidden';
                dropdown.style.transform = 'translateY(-10px)';
                arrow.style.transform = 'rotate(0deg)';
            } else {
                // Open dropdown
                dropdown.style.opacity = '1';
                dropdown.style.visibility = 'visible';
                dropdown.style.transform = 'translateY(0)';
                arrow.style.transform = 'rotate(180deg)';
            }
        }

        function switchCourse(course) {
            // Close dropdown
            const dropdown = document.getElementById('courseDropdown');
            const arrow = document.getElementById('courseDropdownArrow');
            dropdown.style.opacity = '0';
            dropdown.style.visibility = 'hidden';
            dropdown.style.transform = 'translateY(-10px)';
            arrow.style.transform = 'rotate(0deg)';
            
            // Update active course item
            document.querySelectorAll('.course-item').forEach(item => {
                item.classList.remove('active');
                item.style.background = '';
            });
            event.currentTarget.classList.add('active');
            event.currentTarget.style.background = '#f8f9ff';
            
            // Navigate to selected course dashboard
            const courseUrls = {
                'physics': 'physics-dashboard.html',
                'mathematics': 'mathematics-dashboard.html',
                'chemistry': 'chemistry-dashboard.html',
                'english': 'english-dashboard.html'
            };
            
            if (courseUrls[course]) {
                // Show loading state
                const button = document.querySelector('.course-switcher-btn span');
                const originalText = button.textContent;
                button.textContent = 'Switching...';
                
                setTimeout(() => {
                    window.location.href = courseUrls[course];
                }, 500);
            }
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const courseSwitcher = document.querySelector('.course-switcher');
            const dropdown = document.getElementById('courseDropdown');
            
            if (!courseSwitcher.contains(event.target)) {
                dropdown.style.opacity = '0';
                dropdown.style.visibility = 'hidden';
                dropdown.style.transform = 'translateY(-10px)';
                document.getElementById('courseDropdownArrow').style.transform = 'rotate(0deg)';
            }
        });

        // Purchase Course Functions
        let selectedCourse = null;

        function showPurchaseModal() {
            const modal = new bootstrap.Modal(document.getElementById('purchaseModal'));
            modal.show();
        }

        function selectCourse(course) {
            // Remove previous selection
            document.querySelectorAll('.course-card').forEach(card => {
                card.style.borderColor = '#e9ecef';
                card.style.background = '';
            });
            
            // Highlight selected course
            event.currentTarget.style.borderColor = '#10b981';
            event.currentTarget.style.background = '#f0fdf4';
            
            // Set selected course data
            const courseData = {
                'mathematics': { name: 'Mathematics IGCSE', price: '$49.99' },
                'chemistry': { name: 'Chemistry IGCSE', price: '$49.99' },
                'english': { name: 'English IGCSE', price: '$39.99' },
                'bundle': { name: 'All Courses Bundle', price: '$149.99' }
            };
            
            selectedCourse = courseData[course];
            
            // Update selected course info
            document.getElementById('selectedCourseName').textContent = selectedCourse.name;
            document.getElementById('selectedCoursePrice').textContent = selectedCourse.price;
            document.getElementById('selectedCourseInfo').style.display = 'block';
            
            // Enable purchase button
            document.getElementById('purchaseBtn').disabled = false;
        }

        function proceedToPurchase() {
            if (!selectedCourse) {
                alert('Please select a course first.');
                return;
            }
            
            // Show loading state
            const purchaseBtn = document.getElementById('purchaseBtn');
            const originalText = purchaseBtn.innerHTML;
            purchaseBtn.innerHTML = '<iconify-icon icon="material-symbols:hourglass-empty" class="me-1"></iconify-icon>Processing...';
            purchaseBtn.disabled = true;
            
            // Simulate purchase process
            setTimeout(() => {
                // Show success message
                alert(`Successfully purchased ${selectedCourse.name} for ${selectedCourse.price}! You will be redirected to the course dashboard.`);
                
                // Reset button
                purchaseBtn.innerHTML = originalText;
                purchaseBtn.disabled = false;
                
                // Close modal
                const modal = bootstrap.Modal.getInstance(document.getElementById('purchaseModal'));
                modal.hide();
                
                // In a real application, you would redirect to payment processing
                // For demo purposes, we'll just show a success message
                console.log(`Purchase completed: ${selectedCourse.name} - ${selectedCourse.price}`);
                
            }, 2000);
        }

        // Navigation function for progress cards
        function navigateToSection(section) {
            // Map section types to specific Physics pages
            const pageMap = {
                'quiz': 'physics-quizzes.html',
                'exam': 'physics-exams.html',
                'assignment': 'physics-homework.html',
                'progress': 'physics-progress.html'
            };
            
            // Get the URL for the section
            const url = pageMap[section] || 'physics-progress.html';
            
            // Redirect to the appropriate page
            window.location.href = url;
        }

        // Function to open quizzes
        function openQuizzes() {
            window.location.href = 'physics-quizzes.html';
        }

        // Function to open exams
        function openExams() {
            window.location.href = 'physics-exams.html';
        }

        // Navigation functionality - Same as course-mathematics page
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                // Add a subtle highlight effect to the target section
                element.style.transition = 'all 0.3s ease';
                element.style.boxShadow = '0 0 20px rgba(16, 185, 129, 0.3)';
                
                // Smooth scroll to the element with offset for better positioning
                const elementPosition = element.offsetTop - 100; // 100px offset from top
                window.scrollTo({
                    top: elementPosition,
                    behavior: 'smooth'
                });
                
                // Remove highlight effect after animation
                setTimeout(() => {
                    element.style.boxShadow = '';
                }, 1000);
            }
        }

        // Navigation active state - Same as course-mathematics page
        document.querySelectorAll('.dashboard-nav .nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Add click animation effect
                this.style.transform = 'scale(0.95)';
                this.style.transition = 'transform 0.1s ease';
                
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                }, 100);
                
                // Remove active class from all links
                document.querySelectorAll('.dashboard-nav .nav-link').forEach(l => l.classList.remove('active'));
                
                // Add active class to clicked link
                this.classList.add('active');
                
                // Scroll to section
                const targetId = this.getAttribute('href').substring(1);
                scrollToSection(targetId);
            });
        });

        // Update navigation active state on scroll - Same as course-mathematics page
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('section[id], div[id]');
            const navLinks = document.querySelectorAll('.dashboard-nav .nav-link');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (window.pageYOffset >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        });
    </script>

    <!-- Modals for Grade Charts -->
    <div class="modal fade" id="quizGradesModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header" style="background: linear-gradient(135deg, #3b82f6, #2563eb); color: white;">
                    <h5 class="modal-title">
                        <iconify-icon icon="material-symbols:quiz" class="me-2"></iconify-icon>
                        All Quiz Grades
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <canvas id="quizGradesChart" style="max-height: 400px;"></canvas>
                    <div id="quizGradesDetails" class="mt-4"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="examGradesModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white;">
                    <h5 class="modal-title">
                        <iconify-icon icon="material-symbols:school" class="me-2"></iconify-icon>
                        All Exam Grades
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <canvas id="examGradesChart" style="max-height: 400px;"></canvas>
                    <div id="examGradesDetails" class="mt-4"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Purchase Course Modal -->
    <div class="modal fade" id="purchaseModal" tabindex="-1" aria-labelledby="purchaseModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="border: none; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.15);">
                <div class="modal-header" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 20px 20px 0 0; padding: 2rem;">
                    <h5 class="modal-title" id="purchaseModalLabel" style="font-weight: 700; font-size: 1.5rem;">
                        <iconify-icon icon="material-symbols:school" class="me-2"></iconify-icon>
                        Purchase Additional Courses
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" style="padding: 2rem;">
                    <div class="row">
                        <div class="col-md-6 mb-4">
                            <div class="course-card" style="border: 2px solid #e9ecef; border-radius: 15px; padding: 1.5rem; transition: all 0.3s ease; cursor: pointer;" onmouseover="this.style.borderColor='#667eea'; this.style.transform='translateY(-5px)'" onmouseout="this.style.borderColor='#e9ecef'; this.style.transform='translateY(0)'" onclick="selectCourse('mathematics')">
                                <div class="course-icon" style="width: 60px; height: 60px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 15px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem;">
                                    <iconify-icon icon="material-symbols:calculate" style="color: white; font-size: 2rem;"></iconify-icon>
                                </div>
                                <h6 style="font-weight: 700; color: #333; margin-bottom: 0.5rem;">Mathematics IGCSE</h6>
                                <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">Complete mathematics curriculum with interactive lessons, quizzes, and exams.</p>
                                <div class="course-features" style="margin-bottom: 1rem;">
                                    <div style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                                        <iconify-icon icon="material-symbols:check-circle" style="color: #10b981; margin-right: 0.5rem;"></iconify-icon>
                                        <span style="font-size: 0.85rem; color: #666;">200+ Practice Questions</span>
                                    </div>
                                    <div style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                                        <iconify-icon icon="material-symbols:check-circle" style="color: #10b981; margin-right: 0.5rem;"></iconify-icon>
                                        <span style="font-size: 0.85rem; color: #666;">Interactive Lessons</span>
                                    </div>
                                    <div style="display: flex; align-items: center;">
                                        <iconify-icon icon="material-symbols:check-circle" style="color: #10b981; margin-right: 0.5rem;"></iconify-icon>
                                        <span style="font-size: 0.85rem; color: #666;">Progress Tracking</span>
                                    </div>
                                </div>
                                <div class="course-price" style="display: flex; align-items: center; justify-content: space-between;">
                                    <span style="font-size: 1.5rem; font-weight: 700; color: #10b981;">$49.99</span>
                                    <span style="font-size: 0.9rem; color: #666; text-decoration: line-through;">$99.99</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="course-card" style="border: 2px solid #e9ecef; border-radius: 15px; padding: 1.5rem; transition: all 0.3s ease; cursor: pointer;" onmouseover="this.style.borderColor='#4facfe'; this.style.transform='translateY(-5px)'" onmouseout="this.style.borderColor='#e9ecef'; this.style.transform='translateY(0)'" onclick="selectCourse('chemistry')">
                                <div class="course-icon" style="width: 60px; height: 60px; background: linear-gradient(135deg, #4facfe, #00f2fe); border-radius: 15px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem;">
                                    <iconify-icon icon="material-symbols:biotech" style="color: white; font-size: 2rem;"></iconify-icon>
                                </div>
                                <h6 style="font-weight: 700; color: #333; margin-bottom: 0.5rem;">Chemistry IGCSE</h6>
                                <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">Master chemistry concepts with hands-on experiments and detailed explanations.</p>
                                <div class="course-features" style="margin-bottom: 1rem;">
                                    <div style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                                        <iconify-icon icon="material-symbols:check-circle" style="color: #10b981; margin-right: 0.5rem;"></iconify-icon>
                                        <span style="font-size: 0.85rem; color: #666;">150+ Lab Simulations</span>
                                    </div>
                                    <div style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                                        <iconify-icon icon="material-symbols:check-circle" style="color: #10b981; margin-right: 0.5rem;"></iconify-icon>
                                        <span style="font-size: 0.85rem; color: #666;">Video Explanations</span>
                                    </div>
                                    <div style="display: flex; align-items: center;">
                                        <iconify-icon icon="material-symbols:check-circle" style="color: #10b981; margin-right: 0.5rem;"></iconify-icon>
                                        <span style="font-size: 0.85rem; color: #666;">Periodic Table Tools</span>
                                    </div>
                                </div>
                                <div class="course-price" style="display: flex; align-items: center; justify-content: space-between;">
                                    <span style="font-size: 1.5rem; font-weight: 700; color: #10b981;">$49.99</span>
                                    <span style="font-size: 0.9rem; color: #666; text-decoration: line-through;">$99.99</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="course-card" style="border: 2px solid #e9ecef; border-radius: 15px; padding: 1.5rem; transition: all 0.3s ease; cursor: pointer;" onmouseover="this.style.borderColor='#43e97b'; this.style.transform='translateY(-5px)'" onmouseout="this.style.borderColor='#e9ecef'; this.style.transform='translateY(0)'" onclick="selectCourse('english')">
                                <div class="course-icon" style="width: 60px; height: 60px; background: linear-gradient(135deg, #43e97b, #38f9d7); border-radius: 15px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem;">
                                    <iconify-icon icon="material-symbols:menu-book" style="color: white; font-size: 2rem;"></iconify-icon>
                                </div>
                                <h6 style="font-weight: 700; color: #333; margin-bottom: 0.5rem;">English IGCSE</h6>
                                <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">Improve your English skills with comprehensive reading, writing, and grammar exercises.</p>
                                <div class="course-features" style="margin-bottom: 1rem;">
                                    <div style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                                        <iconify-icon icon="material-symbols:check-circle" style="color: #10b981; margin-right: 0.5rem;"></iconify-icon>
                                        <span style="font-size: 0.85rem; color: #666;">Writing Workshops</span>
                                    </div>
                                    <div style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                                        <iconify-icon icon="material-symbols:check-circle" style="color: #10b981; margin-right: 0.5rem;"></iconify-icon>
                                        <span style="font-size: 0.85rem; color: #666;">Literature Analysis</span>
                                    </div>
                                    <div style="display: flex; align-items: center;">
                                        <iconify-icon icon="material-symbols:check-circle" style="color: #10b981; margin-right: 0.5rem;"></iconify-icon>
                                        <span style="font-size: 0.85rem; color: #666;">Grammar Mastery</span>
                                    </div>
                                </div>
                                <div class="course-price" style="display: flex; align-items: center; justify-content: space-between;">
                                    <span style="font-size: 1.5rem; font-weight: 700; color: #10b981;">$39.99</span>
                                    <span style="font-size: 0.9rem; color: #666; text-decoration: line-through;">$79.99</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="course-card" style="border: 2px solid #e9ecef; border-radius: 15px; padding: 1.5rem; transition: all 0.3s ease; cursor: pointer; background: linear-gradient(135deg, #f8f9ff, #e8f2ff);" onmouseover="this.style.borderColor='#f093fb'; this.style.transform='translateY(-5px)'" onmouseout="this.style.borderColor='#e9ecef'; this.style.transform='translateY(0)'" onclick="selectCourse('bundle')">
                                <div class="course-icon" style="width: 60px; height: 60px; background: linear-gradient(135deg, #f093fb, #f5576c); border-radius: 15px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem;">
                                    <iconify-icon icon="material-symbols:star" style="color: white; font-size: 2rem;"></iconify-icon>
                                </div>
                                <h6 style="font-weight: 700; color: #333; margin-bottom: 0.5rem;">All Courses Bundle</h6>
                                <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">Get access to all IGCSE courses with maximum savings and premium features.</p>
                                <div class="course-features" style="margin-bottom: 1rem;">
                                    <div style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                                        <iconify-icon icon="material-symbols:check-circle" style="color: #10b981; margin-right: 0.5rem;"></iconify-icon>
                                        <span style="font-size: 0.85rem; color: #666;">All 4 Courses Included</span>
                                    </div>
                                    <div style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                                        <iconify-icon icon="material-symbols:check-circle" style="color: #10b981; margin-right: 0.5rem;"></iconify-icon>
                                        <span style="font-size: 0.85rem; color: #666;">Priority Support</span>
                                    </div>
                                    <div style="display: flex; align-items: center;">
                                        <iconify-icon icon="material-symbols:check-circle" style="color: #10b981; margin-right: 0.5rem;"></iconify-icon>
                                        <span style="font-size: 0.85rem; color: #666;">Lifetime Access</span>
                                    </div>
                                </div>
                                <div class="course-price" style="display: flex; align-items: center; justify-content: space-between;">
                                    <span style="font-size: 1.5rem; font-weight: 700; color: #10b981;">$149.99</span>
                                    <span style="font-size: 0.9rem; color: #666; text-decoration: line-through;">$299.99</span>
                                </div>
                                <div style="background: #10b981; color: white; padding: 0.25rem 0.5rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; text-align: center; margin-top: 0.5rem;">
                                    BEST VALUE
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="border: none; padding: 1.5rem 2rem; background: #f8f9fa; border-radius: 0 0 20px 20px;">
                    <div class="d-flex justify-content-between align-items-center w-100">
                        <div class="selected-course-info" id="selectedCourseInfo" style="display: none;">
                            <span style="font-weight: 600; color: #333;">Selected: </span>
                            <span id="selectedCourseName" style="color: #667eea; font-weight: 600;"></span>
                            <span id="selectedCoursePrice" style="color: #10b981; font-weight: 700; margin-left: 1rem;"></span>
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal" style="border-radius: 25px; padding: 0.5rem 1.5rem;">Cancel</button>
                            <button type="button" class="btn btn-success" onclick="proceedToPurchase()" id="purchaseBtn" disabled style="border-radius: 25px; padding: 0.5rem 1.5rem; background: linear-gradient(135deg, #10b981, #059669); border: none;">
                                <iconify-icon icon="material-symbols:shopping-cart" class="me-1"></iconify-icon>
                                Purchase Now
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="js/progress-tracking.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Only clear data on first visit (if flag doesn't exist)
            if (!localStorage.getItem('physicsAcademicDataCleared')) {
                clearPhysicsAcademicData();
                localStorage.setItem('physicsAcademicDataCleared', 'true');
            }
            
            loadCourseProgressData('physics');
            loadDailyPracticeStats('physics');
            
            // Auto-refresh dashboard every 3 seconds
            setInterval(function() {
                loadCourseProgressData('physics');
                loadDailyPracticeStats('physics');
                
                // Update notification badge if the function exists
                if (typeof updateNotificationBadge === 'function') {
                    updateNotificationBadge();
                }
                
                // Update student points to reflect completed quizzes and exams
                if (typeof updateAlexProfile === 'function') {
                    updateAlexProfile();
                }
            }, 3000);
        });
        
        // Function to clear all quizzes, assignments, and exams
        function clearPhysicsAcademicData() {
            // Clear quizzes
            localStorage.removeItem('physicsQuizzes');
            localStorage.removeItem('physicsTeacherQuizzes');
            localStorage.removeItem('physicsQuizzesList');
            
            // Clear assignments (homeworks)
            localStorage.removeItem('physicsAssignments');
            localStorage.removeItem('physicsTeacherAssignments');
            localStorage.removeItem('physicsAssignmentsList');
            
            // Clear exams
            localStorage.removeItem('physicsExams');
            localStorage.removeItem('physicsTeacherExams');
            localStorage.removeItem('physicsExamsList');
            
            // Clear assessments (used by the new system)
            localStorage.removeItem('physicsAssessments');
            
            console.log('✅ Cleared all physics quizzes, assignments, and exams from localStorage');
        }
        
        function showAllQuizGrades() {
            window.showAllQuizGrades('physics');
        }
        
        function showAllExamGrades() {
            window.showAllExamGrades('physics');
        }
    </script>
    
    <!-- Focus Timer Widget -->
    <script src="js/focus-timer-widget.js"></script>
    
    <!-- Focus Music Widget -->
    <script src="js/focus-music-widget.js"></script>
</body>
</html>


