<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mathematics Course | IG Nation</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="images/favicon.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/iconify-icon@1.0.7/dist/iconify-icon.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@400;600;700&family=Roboto+Slab&display=swap" rel="stylesheet">
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    
    <style>
        * {
            box-sizing: border-box;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        html, body {
            margin: 0 !important;
            padding: 0 !important;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }
        
        body {
            font-family: 'Jost', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh;
            position: relative;
        }

        /* Global Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Intersection Observer Animation Classes */
        .animate-on-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .animate-on-scroll.animated {
            opacity: 1;
            transform: translateY(0);
        }

        .animate-on-scroll-left {
            opacity: 0;
            transform: translateX(-30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .animate-on-scroll-left.animated {
            opacity: 1;
            transform: translateX(0);
        }

        .animate-on-scroll-right {
            opacity: 0;
            transform: translateX(30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .animate-on-scroll-right.animated {
            opacity: 1;
            transform: translateX(0);
        }

        .animate-on-scroll-scale {
            opacity: 0;
            transform: scale(0.9);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .animate-on-scroll-scale.animated {
            opacity: 1;
            transform: scale(1);
        }

        /* Delay Classes */
        .animate-delay-1 { transition-delay: 0.1s; }
        .animate-delay-2 { transition-delay: 0.2s; }
        .animate-delay-3 { transition-delay: 0.3s; }
        .animate-delay-4 { transition-delay: 0.4s; }
        .animate-delay-5 { transition-delay: 0.5s; }

        /* Header - Same as course-mathematics page */
        .dashboard-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            color: #333;
            padding: 1rem 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin: 0;
            position: relative;
            top: 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 999;
        }

        .dashboard-header .container-fluid {
            margin: 0 !important;
            padding: 0 !important;
        }

        .dashboard-header .row {
            margin: 0 !important;
        }

        /* Navigation - Same styling as course-mathematics */
        .dashboard-nav {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 50px;
            padding: 8px;
            margin: 10px 0;
        }

        .dashboard-nav .nav-link {
            color: #333;
            font-weight: 600;
            padding: 12px 24px;
            border-radius: 25px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .dashboard-nav .nav-link:hover,
        .dashboard-nav .nav-link.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .dashboard-nav .nav-link {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .dashboard-nav .nav-link:active {
            transform: scale(0.95) translateY(-1px);
        }

        .welcome-section {
            padding-left: 0;
            margin-left: 0;
        }

        .welcome-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
            margin: 0;
        }

        .welcome-subtext {
            color: #64748b;
            font-size: 0.9rem;
        }

        /* Main Content */
        .main-content {
            padding: 2rem 0;
            margin-top: 80px;
        }

        /* Cards */
        .dashboard-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            height: 100%;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .dashboard-card::before {
            content: '';
            position: absolute;
            top: -20px;
            right: -20px;
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-radius: 50%;
        }

        .dashboard-card::after {
            content: '';
            position: absolute;
            bottom: -30px;
            left: -30px;
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.08), rgba(118, 75, 162, 0.08));
            border-radius: 50%;
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        /* Modern Cards from Math Course */
        .modern-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            height: 100%;
        }

        .modern-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .modern-card::before {
            content: '';
            position: absolute;
            top: -20px;
            right: -20px;
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-radius: 50%;
        }

        .modern-card::after {
            content: '';
            position: absolute;
            bottom: -30px;
            left: -30px;
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.08), rgba(118, 75, 162, 0.08));
            border-radius: 50%;
        }

        /* Progress Circles */
        .progress-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin: 0 auto 1rem;
            animation: pulse 2s ease-in-out infinite;
        }


        .progress-circle::before {
            content: '';
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            position: absolute;
        }

        .progress-value {
            font-size: 1.2rem;
            font-weight: 800;
            color: #1e293b;
            z-index: 1;
        }

        /* Collapsible Todo Panel Styles */
        .todo-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 25px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease;
            z-index: 999;
            overflow-y: auto;
        }

        .todo-panel.open {
            right: 0;
        }

        .todo-panel-header {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            padding: 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .close-todo-btn {
            background: none;
            border: none;
            padding: 0.5rem;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-todo-btn:hover {
            background: rgba(100, 116, 139, 0.1);
        }

        .todo-panel-content {
            padding: 1.5rem;
        }

        /* Floating Todo Button */
        .floating-todo-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            z-index: 998;
        }

        .floating-todo-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.5);
        }

        .todo-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
        }

        /* Todo List Styles */
        .todo-item {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 0.5rem;
            border-left: 4px solid #667eea;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .todo-item:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: translateX(5px);
        }

        .todo-item.completed {
            opacity: 0.6;
            text-decoration: line-through;
            border-left-color: #10b981;
        }

        .todo-item.high-priority {
            border-left-color: #ef4444;
        }

        .todo-item.medium-priority {
            border-left-color: #f59e0b;
        }

        .todo-item.low-priority {
            border-left-color: #10b981;
        }

        .todo-checkbox {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            border: 2px solid #667eea;
            margin-right: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .todo-checkbox.checked {
            background: #667eea;
            border-color: #667eea;
        }

        /* Deadline Styles */
        .deadline-item {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 0.5rem;
            border-left: 4px solid #ef4444;
            transition: all 0.3s ease;
        }

        .deadline-item:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: translateX(5px);
        }

        .deadline-item.urgent {
            border-left-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        .deadline-item.warning {
            border-left-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }

        .deadline-item.normal {
            border-left-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }

        .deadline-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.25rem;
        }

        .deadline-time {
            font-size: 0.8rem;
            color: #64748b;
        }

        .deadline-subject {
            font-size: 0.75rem;
            color: #667eea;
            font-weight: 600;
            text-transform: uppercase;
        }

        /* Leaderboard Styles */
        .leaderboard-item {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
        }

        .leaderboard-item:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: translateX(5px);
        }

        .leaderboard-item.rank-1 {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.1));
            border: 2px solid #ffd700;
        }

        .leaderboard-item.rank-2 {
            background: linear-gradient(135deg, rgba(192, 192, 192, 0.2), rgba(192, 192, 192, 0.1));
            border: 2px solid #c0c0c0;
        }

        .leaderboard-item.rank-3 {
            background: linear-gradient(135deg, rgba(205, 127, 50, 0.2), rgba(205, 127, 50, 0.1));
            border: 2px solid #cd7f32;
        }

        .rank-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            font-size: 0.9rem;
        }

        .rank-1 .rank-number {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #1e293b;
        }

        .rank-2 .rank-number {
            background: linear-gradient(135deg, #c0c0c0, #e5e5e5);
            color: #1e293b;
        }

        .rank-3 .rank-number {
            background: linear-gradient(135deg, #cd7f32, #daa520);
        }

        .rank-number:not(.rank-1):not(.rank-2):not(.rank-3) {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .student-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1rem;
        }

        .student-info {
            flex: 1;
        }

        .student-name {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.25rem;
        }

        .student-score {
            font-size: 0.8rem;
            color: #64748b;
        }

        .student-points {
            font-weight: 700;
            color: #667eea;
            font-size: 1.1rem;
        }

        /* Add Todo Form */
        .add-todo-form {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .add-todo-form .form-control {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 0.75rem;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .add-todo-form .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }

        .add-todo-form .btn {
            border-radius: 8px;
            font-size: 0.9rem;
        }

        /* Responsive adjustments for todo form */
        @media (max-width: 768px) {
            .add-todo-form .row {
                margin: 0;
            }
            .add-todo-form .col-6,
            .add-todo-form .col-12 {
                padding: 0.25rem;
            }
        }

        .form-control {
            border: 2px solid rgba(102, 126, 234, 0.2);
            border-radius: 10px;
            padding: 0.75rem;
            transition: all 0.3s ease;
            color: #1e293b !important;
            background-color: #ffffff !important;
        }

        .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }
        
        .form-control::placeholder {
            color: #64748b !important;
            opacity: 1;
        }
        
        .form-control option {
            color: #1e293b !important;
            background-color: #ffffff !important;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 10px;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        /* Save Todo Button */
        .save-todo-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            border-radius: 10px;
            padding: 0.75rem 2rem;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
            margin-top: 1rem;
        }

        .save-todo-btn:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
            color: white;
        }

        .save-todo-btn:active {
            transform: translateY(0);
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        /* Clickable Cards */
        .clickable-card {
            transition: all 0.3s ease;
        }

        .clickable-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
        }

        .clickable-card:active {
            transform: translateY(-2px) scale(0.98);
        }

        /* Schedule Widget Styles */
        .schedule-widget {
            background: white;
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .schedule-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .schedule-view-toggles {
            display: flex;
            background: #f8fafc;
            border-radius: 12px;
            padding: 4px;
            gap: 4px;
        }

        .schedule-view-toggle {
            padding: 0.5rem 1rem;
            border: none;
            background: transparent;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .schedule-view-toggle.active {
            background: #667eea;
            color: white;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .schedule-today-btn {
            background: #e0f2fe;
            color: #0369a1;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .schedule-today-btn:hover {
            background: #bae6fd;
            transform: translateY(-1px);
        }

        .schedule-calendar {
            margin-bottom: 1rem;
        }

        .schedule-days-header {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            margin-bottom: 0.5rem;
        }

        .schedule-day-header {
            text-align: center;
            font-weight: 600;
            font-size: 0.8rem;
            color: #64748b;
            padding: 0.5rem 0;
        }

        .schedule-days-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
        }

        .schedule-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            min-height: 40px;
        }

        .schedule-day:hover {
            background: #f1f5f9;
        }

        .schedule-day.other-month {
            color: #cbd5e1;
        }

        .schedule-day.today {
            background: #fef3c7;
            color: #92400e;
            font-weight: 600;
        }

        .schedule-day.has-session {
            background: #ddd6fe;
            color: #5b21b6;
            font-weight: 600;
        }

        .schedule-day.has-session::after {
            content: '';
            position: absolute;
            bottom: 4px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            background: #5b21b6;
            border-radius: 50%;
        }

        .schedule-navigation {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }

        .schedule-nav-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .schedule-nav-btn:hover {
            background: #5a67d8;
            transform: translateY(-1px);
        }

        .schedule-monitor-icon {
            width: 32px;
            height: 32px;
            background: #f1f5f9;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #64748b;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .main-content {
                padding: 1rem 0;
            }
            
            .dashboard-card {
                padding: 1.5rem;
                margin-bottom: 1rem;
            }
            
            .progress-circle {
                width: 80px;
                height: 80px;
            }
            
            .progress-value {
                font-size: 1rem;
            }
            
            /* Hamburger menu responsive */
            .hamburger-menu-btn {
                width: 40px !important;
                height: 40px !important;
            }
            
            .hamburger-menu-btn iconify-icon {
                font-size: 1.3rem !important;
            }
        }
        
        @media (max-width: 576px) {
            .hamburger-menu-btn {
                width: 38px !important;
                height: 38px !important;
            }
            
            .hamburger-menu-btn iconify-icon {
                font-size: 1.2rem !important;
            }
        }

        /* Navigation Icon Buttons */
        .nav-icon-btn {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Focus Mode Styles */
        .focus-mode .dashboard-nav {
            opacity: 0.3;
            pointer-events: none;
        }

        .focus-mode .welcome-section {
            opacity: 0.5;
        }

        .focus-mode .leaderboard-item {
            opacity: 0.4;
        }

        .focus-mode .todo-item {
            opacity: 0.4;
        }

        /* Responsive Design for Icon Buttons */
        @media (max-width: 1200px) {
            .nav-icon-btn {
                width: 40px !important;
                height: 40px !important;
            }
            
            .nav-icon-btn iconify-icon {
                font-size: 1.1rem !important;
            }
            
            .nav-icon-btn img {
                width: 18px !important;
                height: 18px !important;
            }
        }

        @media (max-width: 992px) {
            .nav-icon-btn {
                width: 38px !important;
                height: 38px !important;
            }
            
            .nav-icon-btn iconify-icon {
                font-size: 1rem !important;
            }
            
            .nav-icon-btn img {
                width: 16px !important;
                height: 16px !important;
            }
            
            .personalized-greeting {
                padding: 0.4rem 0.8rem !important;
            }
            
            .personalized-greeting .greeting-text {
                font-size: 0.8rem !important;
            }
            
            .personalized-greeting .ranking-info {
                font-size: 0.7rem !important;
            }
        }

        @media (max-width: 768px) {
            .nav-icon-btn {
                width: 36px !important;
                height: 36px !important;
            }
            
            .nav-icon-btn iconify-icon {
                font-size: 0.9rem !important;
            }
            
            .nav-icon-btn img {
                width: 14px !important;
                height: 14px !important;
            }
            
            .personalized-greeting {
                padding: 0.3rem 0.6rem !important;
            }
            
            .personalized-greeting .greeting-text {
                font-size: 0.75rem !important;
            }
            
            .personalized-greeting .ranking-info {
                font-size: 0.65rem !important;
            }
            
            .personalized-greeting .sample-badges {
                display: none !important;
            }
        }

        @media (max-width: 576px) {
            .nav-icon-btn {
                width: 34px !important;
                height: 34px !important;
            }
            
            .nav-icon-btn iconify-icon {
                font-size: 0.8rem !important;
            }
            
            .nav-icon-btn img {
                width: 12px !important;
                height: 12px !important;
            }
            
            .personalized-greeting {
                padding: 0.25rem 0.5rem !important;
            }
            
            .personalized-greeting .greeting-text {
                font-size: 0.7rem !important;
            }
            
            .personalized-greeting .ranking-info {
                font-size: 0.6rem !important;
            }
        }


        /* Section Headers */
        .section-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 2.5rem;
            font-weight: 800;
            color: #1e293b;
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .gradient-text {
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Enhanced Daily Practice Styles */
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .question-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #10b981;
        }

        .question-card {
            animation: slideInUp 0.6s ease-out;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .no-questions-message {
            animation: fadeIn 0.8s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        /* Enhanced button hover effects */
        .btn-success:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }

        .btn-outline-success:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
        }
    </style>
    
    <!-- Focus Mode Website Blocker -->
    <script src="focus-mode-blocker.js"></script>
</head>
<body>

    <!-- Dashboard Header -->
    <header class="dashboard-header">
        <div class="container-fluid">
            <!-- Top Header with Hamburger Menu and Navigation Buttons -->
            <div class="row align-items-center" style="padding: 0.5rem 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                <div class="col-6">
                    <div class="d-flex align-items-center">
                        <!-- Hamburger Menu Button -->
                        <button class="hamburger-menu-btn" onclick="toggleSidebar()" style="width: 45px; height: 45px; background: white; border: 1px solid #e9ecef; border-radius: 8px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-right: 1rem;" onmouseover="this.style.boxShadow='0 4px 8px rgba(0,0,0,0.15)'" onmouseout="this.style.boxShadow='0 2px 4px rgba(0,0,0,0.1)'">
                            <iconify-icon icon="material-symbols:menu" style="font-size: 1.5rem; color: #333;"></iconify-icon>
                        </button>
                        
                        <!-- Personalized Greeting -->
                        <div class="personalized-greeting" onclick="toggleBadgesBar()" style="cursor: pointer; display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background: rgba(255, 255, 255, 0.9); border-radius: 25px; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)'">
                            <div class="greeting-content">
                                <div class="greeting-text" id="greetingText" style="font-weight: 600; color: #333; font-size: 0.9rem;">Good afternoon, Alex!</div>
                                <div class="ranking-info" style="font-size: 0.75rem; color: #666; display: flex; align-items: center; gap: 0.3rem;">
                                    <span id="studentRanking">No ranking yet</span>
                                    <span>•</span>
                                    <span id="totalPoints" style="color: #667eea; font-weight: 600;">0 points</span>
                                    <span>•</span>
                                    <span id="earnedBadges">0 badges</span>
                                </div>
                            </div>
                            <div class="sample-badges" style="display: flex; gap: 0.2rem;">
                                <div class="badge-sample" style="width: 24px; height: 24px; background: linear-gradient(135deg, #ffd700, #ffed4e); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; color: #333; font-weight: bold;">1</div>
                                <div class="badge-sample" style="width: 24px; height: 24px; background: linear-gradient(135deg, #c0c0c0, #e5e5e5); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; color: #333; font-weight: bold;">2</div>
                                <div class="badge-sample" style="width: 24px; height: 24px; background: linear-gradient(135deg, #cd7f32, #daa520); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; color: white; font-weight: bold;">3</div>
                            </div>
                        </div>
                        
                        <!-- Course Switcher Dropdown (only shown if user has more than one course) -->
                        <div class="course-switcher" id="courseSwitcherContainer" style="margin-left: 1rem; position: relative; display: flex;">
                            <button class="course-switcher-btn" onclick="toggleCourseDropdown()" style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background: rgba(255, 255, 255, 0.9); border: 1px solid #e9ecef; border-radius: 25px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)'">
                                <iconify-icon icon="material-symbols:school" style="font-size: 1.2rem; color: #667eea;"></iconify-icon>
                                <span style="font-weight: 600; color: #333; font-size: 0.9rem;">Mathematics</span>
                                <iconify-icon icon="material-symbols:keyboard-arrow-down" style="font-size: 1rem; color: #666; transition: transform 0.3s ease;" id="courseDropdownArrow"></iconify-icon>
                            </button>
                            
                            <!-- Course Dropdown Menu -->
                            <div class="course-dropdown" id="courseDropdown" style="position: absolute; top: 100%; left: 0; background: white; border: 1px solid #e9ecef; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.15); min-width: 200px; z-index: 1000; opacity: 0; visibility: hidden; transform: translateY(-10px); transition: all 0.3s ease;">
                                <div class="dropdown-header" style="padding: 1rem; border-bottom: 1px solid #f1f3f4;">
                                    <h6 style="margin: 0; color: #333; font-weight: 600;">My Courses</h6>
                                    <small style="color: #666;">Switch between your purchased courses</small>
                                </div>
                                <div class="dropdown-content" style="padding: 0.5rem;">
                                    <!-- Course items will be dynamically generated by course-switcher.js -->
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
                <div class="col-6">
                    <div class="d-flex justify-content-end align-items-center gap-2">
                        <!-- IG Nation Logo -->
                        <a href="student-dashboard.html" style="margin-right: 2rem; display: flex; align-items: center; text-decoration: none;">
                            <img src="images/ig-nation-logo-graduation.png" alt="IG Nation" style="height: 45px; width: auto;">
                        </a>
                        
                        <!-- Focus Mode Button -->
                        <button class="nav-icon-btn" onclick="navigateToFocusMode()" style="width: 45px; height: 45px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);" onmouseover="this.style.boxShadow='0 4px 8px rgba(0,0,0,0.15)'" onmouseout="this.style.boxShadow='0 2px 4px rgba(0,0,0,0.1)'">
                            <img src="images/7898418_focus_business_finance_office_marketing_icon.png" alt="Focus" style="width: 20px; height: 20px; filter: brightness(0) invert(0);">
                        </button>
                        
                        <!-- Notifications Button -->
                        <button class="nav-icon-btn" onclick="navigateToNotifications()" style="width: 45px; height: 45px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1); position: relative;" onmouseover="this.style.boxShadow='0 4px 8px rgba(0,0,0,0.15)'" onmouseout="this.style.boxShadow='0 2px 4px rgba(0,0,0,0.1)'">
                            <iconify-icon icon="material-symbols:notifications" style="font-size: 1.2rem; color: #333;"></iconify-icon>
                            <span id="notificationBadge" style="position: absolute; top: -5px; right: -5px; background: #ef4444; color: white; border-radius: 50%; width: 18px; height: 18px; font-size: 0.7rem; display: flex; align-items: center; justify-content: center; font-weight: 700;">0</span>
                        </button>
                        
                        <!-- Community Button -->
                        <button class="nav-icon-btn" onclick="navigateToCommunity()" style="width: 45px; height: 45px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);" onmouseover="this.style.boxShadow='0 4px 8px rgba(0,0,0,0.15)'" onmouseout="this.style.boxShadow='0 2px 4px rgba(0,0,0,0.1)'">
                            <img src="images/4213440_community_group_leader_people_team_icon.png" alt="Community" style="width: 20px; height: 20px; filter: brightness(0) invert(0);">
                        </button>
                        
                        <!-- Profile Button -->
                        <button class="nav-icon-btn" onclick="navigateToProfile()" style="width: 45px; height: 45px; background: white; border: 1px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);" onmouseover="this.style.boxShadow='0 4px 8px rgba(0,0,0,0.15)'" onmouseout="this.style.boxShadow='0 2px 4px rgba(0,0,0,0.1)'">
                            <img src="images/4092564_profile_about_mobile ui_user_icon.png" alt="Profile" style="width: 20px; height: 20px; filter: brightness(0) invert(0);">
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Main Navigation -->
            <div class="row align-items-center">
                <div class="col-12">
                    <div class="dashboard-nav">
                        <ul class="nav justify-content-center">
                            <li class="nav-item">
                                <a class="nav-link active" href="#progress">Progress</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#schedule">Schedule</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#leaderboard">Leaderboard</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#flashcards">Flashcards</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Sidebar Menu -->
    <div id="sidebar" class="sidebar" style="position: fixed; top: 0; left: -350px; width: 350px; height: 100vh; background: white; box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1); transition: left 0.3s ease; z-index: 1000; overflow-y: auto;">
        <!-- Sidebar Header -->
        <div class="sidebar-header" style="padding: 1.5rem; border-bottom: 1px solid #e9ecef; display: flex; justify-content: space-between; align-items: center;">
            <h4 style="margin: 0; color: #333; font-weight: 700;">My Courses</h4>
            <button onclick="toggleSidebar()" style="background: none; border: none; color: #666; cursor: pointer; font-size: 1.5rem; padding: 0.25rem;" onmouseover="this.style.color='#333'" onmouseout="this.style.color='#666'">
                <iconify-icon icon="material-symbols:close"></iconify-icon>
            </button>
        </div>
        
        <!-- Sidebar Content -->
        <div class="sidebar-content" style="padding: 1rem;">
            <!-- Books Section -->
            <div class="menu-section">
                <div class="menu-item" onclick="window.location.href='mathematics-library.html'" style="display: flex; align-items: center; padding: 1rem; background: #f8f9fa; border-radius: 12px; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#e9ecef'" onmouseout="this.style.background='#f8f9fa'">
                    <div class="menu-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                        <iconify-icon icon="material-symbols:menu-book" style="font-size: 1.5rem; color: white;"></iconify-icon>
                    </div>
                    <div class="menu-text" style="flex: 1;">
                        <div class="menu-title" style="font-weight: 600; color: #333; font-size: 1rem;">Books</div>
                        <div class="menu-subtitle" style="font-size: 0.8rem; color: #666;">Textbooks & Study Materials</div>
                    </div>
                    <iconify-icon icon="material-symbols:keyboard-arrow-right" style="font-size: 1.2rem; color: #666;"></iconify-icon>
                </div>
            </div>

            <!-- Lectures Section -->
            <div class="menu-section">
                <div class="menu-item" onclick="window.location.href='mathematics-lectures.html'" style="display: flex; align-items: center; padding: 1rem; background: #f8f9fa; border-radius: 12px; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#e9ecef'" onmouseout="this.style.background='#f8f9fa'">
                    <div class="menu-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                        <iconify-icon icon="material-symbols:play-circle" style="font-size: 1.5rem; color: white;"></iconify-icon>
                    </div>
                    <div class="menu-text" style="flex: 1;">
                        <div class="menu-title" style="font-weight: 600; color: #333; font-size: 1rem;">Lectures</div>
                        <div class="menu-subtitle" style="font-size: 0.8rem; color: #666;">Video Lessons & Tutorials</div>
                    </div>
                    <iconify-icon icon="material-symbols:keyboard-arrow-right" style="font-size: 1.2rem; color: #666;"></iconify-icon>
                </div>
            </div>

            <!-- Track Progress Section -->
            <div class="menu-section">
                <div class="menu-item" onclick="toggleSubmenu('progress')" style="display: flex; align-items: center; padding: 1rem; background: #f8f9fa; border-radius: 12px; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#e9ecef'" onmouseout="this.style.background='#f8f9fa'">
                    <div class="menu-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                        <iconify-icon icon="material-symbols:trending-up" style="font-size: 1.5rem; color: white;"></iconify-icon>
                    </div>
                    <div class="menu-text" style="flex: 1;">
                        <div class="menu-title" style="font-weight: 600; color: #333; font-size: 1rem;">Track Progress</div>
                        <div class="menu-subtitle" style="font-size: 0.8rem; color: #666;">Monitor Learning Journey</div>
                    </div>
                    <iconify-icon id="progress-arrow" icon="material-symbols:keyboard-arrow-down" style="font-size: 1.2rem; color: #666; transition: transform 0.3s ease;"></iconify-icon>
                </div>
                <div id="progress-submenu" class="submenu" style="display: none; margin-left: 1rem; margin-bottom: 0.5rem;">
                    <div class="submenu-item" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem;">Quiz Scores</div>
                    <div class="submenu-item" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem;">Assignment Grades</div>
                    <div class="submenu-item" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem;">Study Time</div>
                </div>
            </div>

            <!-- Practice Section -->
            <div class="menu-section">
                <div class="menu-item" onclick="window.location.href='coming-soon.html'" style="display: flex; align-items: center; padding: 1rem; background: #f8f9fa; border-radius: 12px; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#e9ecef'" onmouseout="this.style.background='#f8f9fa'">
                    <div class="menu-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                        <iconify-icon icon="material-symbols:fitness-center" style="font-size: 1.5rem; color: white;"></iconify-icon>
                    </div>
                    <div class="menu-text" style="flex: 1;">
                        <div class="menu-title" style="font-weight: 600; color: #333; font-size: 1rem;">Practice on Topic</div>
                        <div class="menu-subtitle" style="font-size: 0.8rem; color: #666;">Topic-based Practice</div>
                    </div>
                    <iconify-icon icon="material-symbols:keyboard-arrow-right" style="font-size: 1.2rem; color: #666;"></iconify-icon>
                </div>
            </div>

            <!-- Badges Section -->
            <div class="menu-section">
                <div class="menu-item" onclick="window.location.href='coming-soon.html'" style="display: flex; align-items: center; padding: 1rem; background: #f8f9fa; border-radius: 12px; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#e9ecef'; this.style.transform='translateX(5px)'" onmouseout="this.style.background='#f8f9fa'; this.style.transform='translateX(0)'">
                    <div class="menu-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                        <iconify-icon icon="material-symbols:workspace-premium" style="font-size: 1.5rem; color: white;"></iconify-icon>
                    </div>
                    <div class="menu-text" style="flex: 1;">
                        <div class="menu-title" style="font-weight: 600; color: #333; font-size: 1rem;">Badges</div>
                    </div>
                    <iconify-icon icon="material-symbols:keyboard-arrow-right" style="font-size: 1.2rem; color: #666;"></iconify-icon>
                </div>
            </div>

            
            <!-- Live Sessions Section -->
            <div class="menu-section">
                <div class="menu-item" onclick="window.location.href='mathematics-live-sessions.html'" style="display: flex; align-items: center; padding: 1rem; background: #f8f9fa; border-radius: 12px; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#e9ecef'" onmouseout="this.style.background='#f8f9fa'">
                    <div class="menu-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                        <iconify-icon icon="material-symbols:video-call" style="font-size: 1.5rem; color: white;"></iconify-icon>
                    </div>
                    <div class="menu-text" style="flex: 1;">
                        <div class="menu-title" style="font-weight: 600; color: #333; font-size: 1rem;">Live Sessions</div>
                        <div class="menu-subtitle" style="font-size: 0.8rem; color: #666;">Interactive Learning Sessions</div>
                    </div>
                    <iconify-icon icon="material-symbols:keyboard-arrow-right" style="font-size: 1.2rem; color: #666;"></iconify-icon>
                </div>
            </div>
            
            <!-- Past Papers Section -->
            <div class="menu-section">
                <div class="menu-item" onclick="window.location.href='mathematics-past-papers.html'" style="display: flex; align-items: center; padding: 1rem; background: #f8f9fa; border-radius: 12px; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='#e9ecef'" onmouseout="this.style.background='#f8f9fa'">
                    <div class="menu-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                        <iconify-icon icon="material-symbols:description" style="font-size: 1.5rem; color: white;"></iconify-icon>
                    </div>
                    <div class="menu-text" style="flex: 1;">
                        <div class="menu-title" style="font-weight: 600; color: #333; font-size: 1rem;">Past Papers</div>
                        <div class="menu-subtitle" style="font-size: 0.8rem; color: #666;">Previous Exam Papers & Solutions</div>
                    </div>
                    <iconify-icon icon="material-symbols:keyboard-arrow-right" style="font-size: 1.2rem; color: #666;"></iconify-icon>
                </div>
                <div id="papers-submenu" class="submenu" style="display: none; margin-left: 1rem; margin-bottom: 0.5rem;">
                    <div class="submenu-item" onclick="window.location.href='mathematics-past-papers.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">All Past Papers</div>
                    <div class="submenu-item" onclick="window.location.href='mathematics-past-papers-2025.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2025 Papers</div>
                    <div class="submenu-item" onclick="window.location.href='mathematics-past-papers-2024.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2024 Papers</div>
                    <div class="submenu-item" onclick="window.location.href='mathematics-past-papers-2023.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2023 Papers</div>
                    <div class="submenu-item" onclick="window.location.href='mathematics-past-papers-2022.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2022 Papers</div>
                    <div class="submenu-item" onclick="window.location.href='mathematics-past-papers-2021.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2021 Papers</div>
                    <div class="submenu-item" onclick="window.location.href='mathematics-past-papers-2020.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2020 Papers</div>
                    <div class="submenu-item" onclick="window.location.href='mathematics-past-papers-2019.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2019 Papers</div>
                    <div class="submenu-item" onclick="window.location.href='mathematics-past-papers-2018.html'" style="padding: 0.75rem; color: #666; font-size: 0.9rem; border-left: 2px solid #e9ecef; padding-left: 1rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#667eea'" onmouseout="this.style.background='transparent'; this.style.color='#666'">2018 Papers</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sidebar Overlay -->
    <div id="sidebarOverlay" class="sidebar-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 999; display: none;" onclick="toggleSidebar()"></div>

    <!-- Badges Bar (Hidden by default) -->
    <div id="badgesBar" class="badges-bar" style="display: none; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(20px); padding: 1rem; border-bottom: 1px solid rgba(255, 255, 255, 0.2); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col-12">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 style="margin: 0; color: #333; font-weight: 600;">Alex's Earned Badges</h6>
                        <button onclick="toggleBadgesBar()" style="background: none; border: none; color: #666; cursor: pointer; font-size: 1.2rem;" onmouseover="this.style.color='#333'" onmouseout="this.style.color='#666'">
                            <iconify-icon icon="material-symbols:close"></iconify-icon>
                        </button>
                    </div>
                    <div class="badges-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem; margin-top: 1rem;">
                        <!-- Gold Badge -->
                        <div class="badge-item" style="text-align: center; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: 15px; border: 2px solid #ffd700; cursor: pointer; transition: all 0.3s ease;" onclick="window.location.href='coming-soon.html'" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(255, 215, 0, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(255, 215, 0, 0.3)'">
                            <div class="badge-icon" style="width: 50px; height: 50px; background: linear-gradient(135deg, #ffd700, #ffed4e); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; margin: 0 auto 0.5rem; box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);">🏆</div>
                            <div class="badge-name" style="font-weight: 600; color: #333; font-size: 0.85rem;">Quiz Master</div>
                        </div>
                        
                        <!-- Silver Badge -->
                        <div class="badge-item" style="text-align: center; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: 15px; border: 2px solid #c0c0c0; cursor: pointer; transition: all 0.3s ease;" onclick="window.location.href='coming-soon.html'" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(192, 192, 192, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(192, 192, 192, 0.3)'">
                            <div class="badge-icon" style="width: 50px; height: 50px; background: linear-gradient(135deg, #c0c0c0, #e5e5e5); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; margin: 0 auto 0.5rem; box-shadow: 0 4px 12px rgba(192, 192, 192, 0.3);">🎯</div>
                            <div class="badge-name" style="font-weight: 600; color: #333; font-size: 0.85rem;">Assignment Ace</div>
                        </div>
                        
                        <!-- Bronze Badge -->
                        <div class="badge-item" style="text-align: center; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: 15px; border: 2px solid #cd7f32; cursor: pointer; transition: all 0.3s ease;" onclick="window.location.href='coming-soon.html'" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(205, 127, 50, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(205, 127, 50, 0.3)'">
                            <div class="badge-icon" style="width: 50px; height: 50px; background: linear-gradient(135deg, #cd7f32, #daa520); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; margin: 0 auto 0.5rem; box-shadow: 0 4px 12px rgba(205, 127, 50, 0.3);">📚</div>
                            <div class="badge-name" style="font-weight: 600; color: #333; font-size: 0.85rem;">Study Streak</div>
                        </div>
                        
                        <!-- Achievement Badge -->
                        <div class="badge-item" style="text-align: center; padding: 1rem; background: rgba(255, 255, 255, 0.7); border-radius: 15px; border: 2px solid #10b981; cursor: pointer; transition: all 0.3s ease;" onclick="window.location.href='coming-soon.html'" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(16, 185, 129, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(16, 185, 129, 0.3)'">
                            <div class="badge-icon" style="width: 50px; height: 50px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; margin: 0 auto 0.5rem; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);">⭐</div>
                            <div class="badge-name" style="font-weight: 600; color: #333; font-size: 0.85rem;">Top Performer</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="container">
            <!-- Section Header -->
            <div class="section-header animate-on-scroll">
                <h1 class="section-title">
                    Your Learning <span class="gradient-text">Dashboard</span>
                </h1>
            </div>

            <!-- Progress Cards from Math Course Page -->
            <div id="progress" class="row mb-5">
                <div class="col-12">
                    <h3 class="mb-4 animate-on-scroll animate-delay-1" style="color: #1e293b; font-weight: 700;">
                        <iconify-icon icon="material-symbols:trending-up" class="me-2" style="color: #667eea;"></iconify-icon>
                        Your Progress Overview
                    </h3>
                </div>
                <div class="col-md-3 mb-4">
                    <div class="modern-card text-center animate-on-scroll animate-delay-1 clickable-card" onclick="navigateToSection('quiz')" style="cursor: pointer;">
                        <img src="images/New folder/quiz.webp" alt="Quizzes" style="width: 80px; height: 80px; margin-bottom: 1rem; border-radius: 10px;">
                        <h4 style="color: #1e293b; font-weight: 700; margin: 0;">Quizzes</h4>
                    </div>
                </div>
                
                <div class="col-md-3 mb-4">
                    <div class="modern-card text-center animate-on-scroll animate-delay-2 clickable-card" onclick="navigateToSection('exam')" style="cursor: pointer;">
                        <img src="images/New folder/quiz.webp" alt="Exams" style="width: 80px; height: 80px; margin-bottom: 1rem; border-radius: 10px;">
                        <h4 style="color: #1e293b; font-weight: 700; margin: 0;">Exams</h4>
                    </div>
                </div>
                
                <div class="col-md-3 mb-4">
                    <div class="modern-card text-center animate-on-scroll animate-delay-3 clickable-card" onclick="navigateToSection('assignment')" style="cursor: pointer;">
                        <img src="images/New folder/homework.webp" alt="Assignments" style="width: 80px; height: 80px; margin-bottom: 1rem; border-radius: 10px;">
                        <h4 style="color: #1e293b; font-weight: 700; margin: 0;">Assignments</h4>
                    </div>
                </div>
                
                <div class="col-md-3 mb-4">
                    <div class="modern-card text-center animate-on-scroll animate-delay-4 clickable-card" onclick="window.location.href='mathematics-progress.html'" style="cursor: pointer;">
                        <img src="images/New folder/tracj.webp" alt="Track Your Progress" style="width: 80px; height: 80px; margin-bottom: 1rem; border-radius: 10px;">
                        <h4 style="color: #1e293b; font-weight: 700; margin: 0;">Track Your Progress</h4>
                    </div>
                </div>
            </div>

            <!-- New Two-Column Layout: Schedule (Left) and Deadlines (Right) -->
            <div id="schedule" class="row mb-5">
                <!-- Left Column - Schedule (50% width) -->
                <div class="col-md-6 mb-4">
                    <div class="dashboard-card animate-on-scroll-left animate-delay-1" style="height: 100%;">
                        <h3 class="card-title">
                            <div class="card-icon">
                                <iconify-icon icon="material-symbols:calendar-month"></iconify-icon>
                            </div>
                            Monthly Schedule
                    </h3>
                        <div id="scheduleWidget">
                            <!-- Enhanced Schedule Widget -->
                            <div class="schedule-widget">
                                <div class="schedule-header">
                                    <h4 style="margin: 0; color: #1e293b; font-weight: 700;">January 2025</h4>
                                    <div class="schedule-view-toggles">
                                        <button class="schedule-view-toggle active">Month</button>
                                        <button class="schedule-view-toggle">Week</button>
                </div>
                                    </div>
                                
                                <div class="schedule-calendar">
                                    <div class="schedule-days-header">
                                        <div class="schedule-day-header">Sun</div>
                                        <div class="schedule-day-header">Mon</div>
                                        <div class="schedule-day-header">Tue</div>
                                        <div class="schedule-day-header">Wed</div>
                                        <div class="schedule-day-header">Thu</div>
                                        <div class="schedule-day-header">Fri</div>
                                        <div class="schedule-day-header">Sat</div>
                                    </div>
                                    
                                    <div class="schedule-days-grid" id="calendarGrid">
                                        <!-- Calendar days will be populated dynamically -->
                                </div>
                                </div>
                                
                                <div class="schedule-navigation">
                                    <button class="schedule-nav-btn" onclick="previousMonth()">
                                        <iconify-icon icon="material-symbols:chevron-left"></iconify-icon>
                                        Previous
                                    </button>
                                    <button class="schedule-today-btn" onclick="goToToday()">
                                        <iconify-icon icon="material-symbols:today"></iconify-icon>
                                        Today
                                    </button>
                                    <button class="schedule-nav-btn" onclick="nextMonth()">
                                        Next
                                        <iconify-icon icon="material-symbols:chevron-right"></iconify-icon>
                                    </button>
                            </div>
                                
                                <!-- Upcoming Sessions -->
                                <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid #e2e8f0;">
                                    <h5 style="color: #1e293b; font-weight: 600; margin-bottom: 1rem;">
                                        <iconify-icon icon="material-symbols:schedule" style="vertical-align: middle; margin-right: 0.5rem;"></iconify-icon>
                                        Upcoming Sessions
                                    </h5>
                                    <div id="upcomingSessions">
                                        <!-- Sessions will be loaded dynamically -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column - Upcoming Deadlines (50% width) -->
                <div class="col-md-6 mb-4">
                    <div class="dashboard-card animate-on-scroll-right animate-delay-1" style="height: 100%;">
                                <h3 class="card-title">
                                    <div class="card-icon">
                                        <iconify-icon icon="material-symbols:schedule"></iconify-icon>
                                    </div>
                                    Upcoming Deadlines
                                </h3>
                                <div id="deadlinesList">
                            <!-- Enhanced Deadlines List -->
                            <div class="deadline-item urgent">
                                <div class="deadline-subject">MATHEMATICS</div>
                                <div class="deadline-title">Calculus Assignment #3</div>
                                <div class="deadline-time">Due Tomorrow at 11:59 PM</div>
                                    </div>
                            <div class="deadline-item warning">
                                <div class="deadline-subject">MATHEMATICS</div>
                                <div class="deadline-title">Algebra Quiz - Functions</div>
                                <div class="deadline-time">Due in 2 days at 3:00 PM</div>
                                </div>
                            <div class="deadline-item normal">
                                <div class="deadline-subject">MATHEMATICS</div>
                                <div class="deadline-title">Statistics Project</div>
                                <div class="deadline-time">Due in 5 days at 5:00 PM</div>
                                </div>
                            <div class="deadline-item normal">
                                <div class="deadline-subject">MATHEMATICS</div>
                                <div class="deadline-title">Geometry Problem Set</div>
                                <div class="deadline-time">Due in 1 week at 11:59 PM</div>
                            </div>
                            <div class="deadline-item warning">
                                <div class="deadline-subject">MATHEMATICS</div>
                                <div class="deadline-title">Midterm Exam Preparation</div>
                                <div class="deadline-time">Exam in 10 days</div>
                    </div>

                            <!-- View All Button -->
                            <div style="text-align: center; margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid #e2e8f0;">
                                <button style="background: linear-gradient(135deg, #667eea, #764ba2); border: none; color: white; padding: 0.75rem 2rem; border-radius: 25px; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.3)'">
                                    <iconify-icon icon="material-symbols:view-list" style="vertical-align: middle; margin-right: 0.5rem;"></iconify-icon>
                                    View All Deadlines
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bottom Row: Leaderboard (Left) and Wrong/Tricky Questions (Right) -->
            <div id="leaderboard" class="row mb-5">
                <!-- Left Column - Leaderboard (50% width) -->
                <div class="col-md-6 mb-4">
                            <div class="dashboard-card animate-on-scroll-left animate-delay-2">
                        <h3 class="card-title">
                            <div class="card-icon">
                                <iconify-icon icon="material-symbols:leaderboard"></iconify-icon>
                            </div>
                            Class Leaderboard
                        </h3>
                        <div id="leaderboardList">
                            <!-- Leaderboard items will be loaded dynamically -->
                        </div>
                    </div>
                </div>

                <!-- Right Column - Wrong Questions and Tricky Questions (50% width) -->
                <div class="col-md-6 mb-4" style="display: flex; flex-direction: column; gap: 1rem;">
                    <!-- Wrong Questions Card (Top - 50% height) -->
                    <div class="modern-card animate-on-scroll clickable-card" onclick="window.location.href='mathematics-wrong-questions.html'" style="cursor: pointer; border-left: 5px solid #ef4444; flex: 1; display: flex; align-items: center;">
                        <div class="d-flex align-items-center justify-content-between w-100">
                            <div>
                                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #ef4444, #dc2626); border-radius: 15px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);">
                                        <iconify-icon icon="material-symbols:close-rounded" style="font-size: 1.5rem; color: white;"></iconify-icon>
                                    </div>
                                    <div>
                                        <h4 style="color: #1e293b; font-weight: 700; margin: 0; font-size: 1.1rem;">Wrong Questions</h4>
                                        <p style="color: #64748b; margin: 0; font-size: 0.8rem;">Review your mistakes</p>
                                </div>
                            </div>
                                <div style="background: rgba(239, 68, 68, 0.1); padding: 0.5rem; border-radius: 10px;">
                                    <div style="color: #ef4444; font-weight: 600; font-size: 1.2rem;" id="wrongQuestionsCount">0</div>
                                    <div style="color: #64748b; font-size: 0.75rem;">Questions to review</div>
                                </div>
                            </div>
                            <iconify-icon icon="material-symbols:arrow-forward-rounded" style="font-size: 1.5rem; color: #cbd5e1;"></iconify-icon>
                        </div>
                    </div>

                    <!-- Tricky Questions Card (Bottom - 50% height) -->
                    <div class="modern-card animate-on-scroll clickable-card" onclick="window.location.href='mathematics-tricky-questions.html'" style="cursor: pointer; border-left: 5px solid #f59e0b; background: linear-gradient(135deg, rgba(245, 158, 11, 0.05), rgba(251, 191, 36, 0.05)); flex: 1; display: flex; align-items: center;">
                        <div class="d-flex align-items-center justify-content-between w-100">
                            <div>
                                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #f59e0b, #d97706); border-radius: 15px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);">
                                        <iconify-icon icon="material-symbols:lightbulb" style="font-size: 1.5rem; color: white;"></iconify-icon>
                                    </div>
                                    <div>
                                        <h4 style="color: #1e293b; font-weight: 700; margin: 0; font-size: 1.1rem;">Tricky Questions</h4>
                                        <p style="color: #64748b; margin: 0; font-size: 0.8rem;">Practice challenging problems</p>
                                    </div>
                                </div>
                                <div style="background: rgba(245, 158, 11, 0.15); padding: 0.5rem; border-radius: 10px;">
                                    <div style="color: #f59e0b; font-weight: 600; font-size: 1.2rem;" id="trickyQuestionsCount">0</div>
                                    <div style="color: #64748b; font-size: 0.75rem;">Questions saved</div>
                                </div>
                            </div>
                            <iconify-icon icon="material-symbols:arrow-forward-rounded" style="font-size: 1.5rem; color: #cbd5e1;"></iconify-icon>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Daily Practice and Flashcards Section -->
            <div id="flashcards" class="row mb-5">
                <!-- Daily Practice Section (50% width) -->
                <div class="col-md-6 mb-4">
                    <div class="dashboard-card animate-on-scroll" style="height: 100%; display: flex; flex-direction: column;">
                        <div class="card-header" style="border-bottom: 1px solid rgba(0,0,0,0.1); padding: 1.5rem 1.5rem 1rem 1.5rem;">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h3 class="card-title" style="margin: 0; margin-bottom: 0.5rem; color: #1e293b; font-weight: 700;">
                                        <div class="card-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                                            <iconify-icon icon="material-symbols:quiz"></iconify-icon>
                                        </div>
                                        Daily Practice Questions
                                    </h3>
                                    <p style="margin: 0; color: #6c757d;">Solve a new challenge every day!</p>
                                </div>
                                <button class="btn btn-success" onclick="window.location.href='mathematics-daily-practice.html'" style="font-weight: 600; border-radius: 10px; padding: 0.75rem 1.5rem;">
                                    <iconify-icon icon="material-symbols:arrow-forward" class="me-1"></iconify-icon>
                                    Start Practice
                                </button>
                            </div>
                        </div>
                        
                        <!-- Statistics Row -->
                        <div class="row mx-3 mb-3 mt-3" style="font-size: 0.9rem;">
                            <div class="col-4 text-center">
                                <div class="stat-card" style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1)); padding: 1rem; border-radius: 12px; text-align: center; transition: all 0.3s ease;">
                                    <div style="font-size: 1.5rem; font-weight: 700; color: #10b981;" id="dailyPracticeStreak">0</div>
                                    <div style="color: #6c757d; font-weight: 600;">Day Streak</div>
                                </div>
                            </div>
                            <div class="col-4 text-center">
                                <div class="stat-card" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); padding: 1rem; border-radius: 12px; text-align: center; transition: all 0.3s ease;">
                                    <div style="font-size: 1.5rem; font-weight: 700; color: #667eea;" id="dailyPracticeSolved">0</div>
                                    <div style="color: #6c757d; font-weight: 600;">Solved</div>
                                </div>
                            </div>
                            <div class="col-4 text-center">
                                <div class="stat-card" style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.1)); padding: 1rem; border-radius: 12px; text-align: center; transition: all 0.3s ease;">
                                    <div style="font-size: 1.5rem; font-weight: 700; color: #f59e0b;" id="dailyPracticeAccuracy">0%</div>
                                    <div style="color: #6c757d; font-weight: 600;">Accuracy</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Question Display Area - Takes remaining height -->
                        <div class="flex-grow-1 mx-3 mb-3" style="display: flex; flex-direction: column; min-height: 0;">
                            <div id="inlineQuestionContainer" style="display: none; flex: 1; display: flex; flex-direction: column;">
                                <div class="question-card" style="background: linear-gradient(135deg, #d1fae5, #a7f3d0); border: 2px solid #10b981; border-radius: 16px; padding: 1.5rem; flex: 1; display: flex; flex-direction: column; transition: all 0.3s ease; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
                                    <div class="d-flex align-items-center mb-3">
                                        <div style="background: linear-gradient(135deg, #10b981, #059669); width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                                            <iconify-icon icon="material-symbols:quiz" style="color: white; font-size: 1.2rem;"></iconify-icon>
                                        </div>
                                        <h6 style="margin: 0; color: #1e293b; font-weight: 600;">Today's Practice Question</h6>
                                    </div>
                                    
                                    <div id="inlineQuestionText" style="color: #1e293b; margin-bottom: 1.5rem; font-size: 1rem; line-height: 1.6; flex: 1; overflow-y: auto;">
                                        <!-- Question will be loaded here -->
                                    </div>
                                    
                                    <div class="mt-auto">
                                        <div class="row">
                                            <div class="col-md-8">
                                                <textarea id="inlineAnswerInput" class="form-control" rows="3" placeholder="Type your answer here..." style="border: 2px solid #10b981; border-radius: 10px; resize: vertical; font-size: 0.95rem; transition: all 0.3s ease;" onfocus="this.style.borderColor='#059669'" onblur="this.style.borderColor='#10b981'"></textarea>
                                            </div>
                                            <div class="col-md-4">
                                                <button onclick="submitInlineAnswer()" class="btn btn-success w-100 mb-2" style="font-weight: 600; border-radius: 10px; padding: 0.75rem; transition: all 0.3s ease;">
                                                    <iconify-icon icon="material-symbols:check" class="me-1"></iconify-icon>
                                                    Submit
                                                </button>
                                                <button onclick="showInlineAnswer()" class="btn btn-outline-success w-100" style="font-weight: 600; border-radius: 10px; padding: 0.75rem; transition: all 0.3s ease;">
                                                    <iconify-icon icon="material-symbols:visibility" class="me-1"></iconify-icon>
                                                    Show Answer
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <div id="inlineAnswerDisplay" style="display: none; margin-top: 1.5rem; padding: 1.5rem; background: linear-gradient(135deg, #f1f5f9, #e2e8f0); border-radius: 12px; border-left: 4px solid #10b981;">
                                            <div class="d-flex align-items-center mb-2">
                                                <iconify-icon icon="material-symbols:check-circle" style="color: #10b981; font-size: 1.2rem; margin-right: 0.5rem;"></iconify-icon>
                                                <strong style="color: #1e293b;">Correct Answer:</strong>
                                            </div>
                                            <div id="inlineCorrectAnswer" style="color: #1e293b; margin-bottom: 1rem; font-weight: 500;"></div>
                                            <div id="inlineExplanation" style="color: #64748b; font-size: 0.9rem; line-height: 1.5;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- No Questions Message -->
                            <div id="noQuestionsMessage" class="text-center" style="display: flex; align-items: center; justify-content: center; flex: 1; color: #6c757d;">
                                <div class="no-questions-message">
                                    <div style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1)); width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem auto;">
                                        <iconify-icon icon="material-symbols:quiz" style="font-size: 2.5rem; color: #10b981;"></iconify-icon>
                                    </div>
                                    <h5 style="color: #1e293b; margin-bottom: 0.5rem; font-weight: 600;">No Questions Here Yet</h5>
                                    <p style="margin: 0; font-size: 1rem; color: #64748b;">Your teacher hasn't added any practice questions yet.</p>
                                    <p style="margin: 0; font-size: 0.9rem; color: #94a3b8; margin-top: 0.5rem;">Check back later for new challenges!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Flashcards Section (50% width) -->
                <div class="col-md-6 mb-4">
                    <div class="dashboard-card animate-on-scroll-left animate-delay-3" style="height: 100%;">
                        <h3 class="card-title">
                            <div class="card-icon">
                                <iconify-icon icon="material-symbols:style"></iconify-icon>
                            </div>
                            Mathematics Flashcards
                        </h3>
                        <p style="color: #6c757d; margin-bottom: 1.5rem;">
                            Study with interactive flashcards and track your progress across all mathematics chapters
                        </p>
                        
                        <!-- Flashcard Stats -->
                        <div class="row mb-4">
                            <div class="col-6 col-md-3 mb-3">
                                <div style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); padding: 1.5rem; border-radius: 15px; text-align: center;">
                                    <div style="font-size: 2rem; font-weight: 700; color: #667eea;" id="flashcardTotal">0</div>
                                    <div style="font-size: 0.85rem; color: #6c757d; font-weight: 600;">Total Cards</div>
                                </div>
                            </div>
                            <div class="col-6 col-md-3 mb-3">
                                <div style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1)); padding: 1.5rem; border-radius: 15px; text-align: center;">
                                    <div style="font-size: 2rem; font-weight: 700; color: #10b981;" id="flashcardMastered">0</div>
                                    <div style="font-size: 0.85rem; color: #6c757d; font-weight: 600;">Mastered</div>
                                </div>
                            </div>
                            <div class="col-6 col-md-3 mb-3">
                                <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.1)); padding: 1.5rem; border-radius: 15px; text-align: center;">
                                    <div style="font-size: 2rem; font-weight: 700; color: #f59e0b;" id="flashcardStudying">0</div>
                                    <div style="font-size: 0.85rem; color: #6c757d; font-weight: 600;">Studying</div>
                                </div>
                            </div>
                            <div class="col-6 col-md-3 mb-3">
                                <div style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.1)); padding: 1.5rem; border-radius: 15px; text-align: center;">
                                    <div style="font-size: 2rem; font-weight: 700; color: #ef4444;" id="flashcardForgotten">0</div>
                                    <div style="font-size: 0.85rem; color: #6c757d; font-weight: 600;">Need Review</div>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Access Buttons -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <button onclick="window.location.href='mathematics-flashcards.html'" style="width: 100%; background: linear-gradient(135deg, #667eea, #764ba2); border: none; color: white; padding: 1rem; border-radius: 12px; font-weight: 600; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 0.5rem; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);">
                                    <iconify-icon icon="material-symbols:style" style="font-size: 1.5rem;"></iconify-icon>
                                    Browse All Flashcards
                                </button>
                            </div>
                            <div class="col-md-6 mb-3">
                                <button onclick="window.location.href='flashcards-forgotten.html'" style="width: 100%; background: linear-gradient(135deg, #ef4444, #dc2626); border: none; color: white; padding: 1rem; border-radius: 12px; font-weight: 600; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 0.5rem; box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);" id="reviewForgottenBtn">
                                    <iconify-icon icon="material-symbols:priority-high" style="font-size: 1.5rem;"></iconify-icon>
                                    Review Forgotten Cards (<span id="forgottenCountBtn">0</span>)
                                </button>
                            </div>
                        </div>

                        <!-- Recent Chapters -->
                        <div class="mt-4">
                            <h4 style="font-size: 1.1rem; font-weight: 700; color: #1e293b; margin-bottom: 1rem;">
                                <iconify-icon icon="material-symbols:history" style="vertical-align: middle; margin-right: 0.5rem;"></iconify-icon>
                                Quick Access Chapters
                            </h4>
                            <div class="row" id="quickAccessChapters">
                                <!-- Will be populated dynamically -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/course-switcher.js"></script>
    <script src="js/notifications.js"></script>
    <script>
        // Intersection Observer for animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animated');
                }
            });
        }, observerOptions);

        // Observe all animated elements
        document.querySelectorAll('.animate-on-scroll, .animate-on-scroll-right, .animate-on-scroll-left, .animate-on-scroll-scale').forEach(el => {
            observer.observe(el);
        });

        // Todo List Functions
        function toggleTodo(element) {
            const checkbox = element.querySelector('.todo-checkbox');
            const title = element.querySelector('div[style*="font-weight: 600"]');
            
            if (checkbox.classList.contains('checked')) {
                checkbox.classList.remove('checked');
                element.classList.remove('completed');
                title.style.textDecoration = 'none';
            } else {
                checkbox.classList.add('checked');
                element.classList.add('completed');
                title.style.textDecoration = 'line-through';
            }
            
            // Save changes to localStorage immediately
            saveTodosToLocalStorage();
        }

        function addTodo() {
            const input = document.getElementById('newTodoInput');
            const priority = document.getElementById('prioritySelect').value;
            const todoText = input.value.trim();
            
            if (todoText === '') {
                alert('Please enter a task!');
                return;
            }
            
            const todoList = document.getElementById('todoList');
            
            // Clear any "no tasks" message if it exists
            const noTasksMessage = todoList.querySelector('div[style*="text-align: center"]');
            if (noTasksMessage) {
                noTasksMessage.remove();
            }
            
            const newTodo = document.createElement('div');
            newTodo.className = `todo-item ${priority}-priority`;
            newTodo.onclick = () => toggleTodo(newTodo);
            
            const priorityText = priority.charAt(0).toUpperCase() + priority.slice(1);
            
            newTodo.innerHTML = `
                <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                    <div style="display: flex; align-items: center; flex: 1;">
                        <div class="todo-checkbox"></div>
                        <div>
                            <div style="font-weight: 600; color: #1e293b;">${todoText}</div>
                            <small style="color: #64748b;">${priorityText} Priority • Just added</small>
                        </div>
                    </div>
                    <button class="btn btn-sm btn-outline-danger" onclick="event.stopPropagation(); removeTodoItem(this)" style="padding: 0.25rem 0.5rem; margin-left: 0.5rem;">
                        <iconify-icon icon="material-symbols:delete-outline" style="font-size: 1rem;"></iconify-icon>
                    </button>
                </div>
            `;
            
            todoList.insertBefore(newTodo, todoList.firstChild);
            input.value = '';
            
            // Add animation
            newTodo.style.opacity = '0';
            newTodo.style.transform = 'translateY(-20px)';
            setTimeout(() => {
                newTodo.style.transition = 'all 0.3s ease';
                newTodo.style.opacity = '1';
                newTodo.style.transform = 'translateY(0)';
            }, 100);
            
            // Save to localStorage immediately
            saveTodosToLocalStorage();
        }

        // Allow Enter key to add todo (check if element exists first)
        const newTodoInput = document.getElementById('newTodoInput');
        if (newTodoInput) {
            newTodoInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addTodo();
                }
            });
        }

        // Save todos to localStorage
        function saveTodosToLocalStorage() {
            const todoItems = document.querySelectorAll('#todoList .todo-item');
            const todoData = [];
            
            todoItems.forEach(item => {
                const checkbox = item.querySelector('.todo-checkbox');
                const title = item.querySelector('div[style*="font-weight: 600"]');
                const priority = item.classList.contains('high-priority') ? 'high' : 
                               item.classList.contains('medium-priority') ? 'medium' : 'low';
                
                todoData.push({
                    text: title.textContent.trim(),
                    completed: checkbox.classList.contains('checked'),
                    priority: priority
                });
            });
            
            localStorage.setItem('mathematicsTodoList', JSON.stringify(todoData));
        }

        // Load todos from localStorage
        function loadTodosFromLocalStorage() {
            const todoList = document.getElementById('todoList');
            const savedTodos = localStorage.getItem('mathematicsTodoList');
            
            // Always clear the sample tasks first
            todoList.innerHTML = '';
            
            if (savedTodos) {
                const todos = JSON.parse(savedTodos);
                
                if (todos.length === 0) {
                    // Show "no tasks" message
                    todoList.innerHTML = '<div style="text-align: center; padding: 2rem; color: #64748b;"><iconify-icon icon="material-symbols:check-circle-outline" style="font-size: 3rem; opacity: 0.3;"></iconify-icon><p style="margin-top: 1rem; font-weight: 500;">No tasks yet. Add your first task!</p></div>';
                    return;
                }
                
                // Load saved todos
                todos.forEach(todo => {
                    const todoItem = document.createElement('div');
                    todoItem.className = `todo-item ${todo.priority}-priority ${todo.completed ? 'completed' : ''}`;
                    todoItem.onclick = () => toggleTodo(todoItem);
                    
                    const priorityText = todo.priority.charAt(0).toUpperCase() + todo.priority.slice(1);
                    const statusText = todo.completed ? 'Completed' : 'Pending';
                    
                    todoItem.innerHTML = `
                        <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <div style="display: flex; align-items: center; flex: 1;">
                                <div class="todo-checkbox ${todo.completed ? 'checked' : ''}"></div>
                                <div>
                                    <div style="font-weight: 600; color: #1e293b;">${todo.text}</div>
                                    <small style="color: #64748b;">${priorityText} Priority • ${statusText}</small>
                                </div>
                            </div>
                            <button class="btn btn-sm btn-outline-danger" onclick="event.stopPropagation(); removeTodoItem(this)" style="padding: 0.25rem 0.5rem; margin-left: 0.5rem;">
                                <iconify-icon icon="material-symbols:delete-outline" style="font-size: 1rem;"></iconify-icon>
                            </button>
                        </div>
                    `;
                    
                    todoList.appendChild(todoItem);
                });
            } else {
                // No saved todos - show "no tasks" message
                todoList.innerHTML = '<div style="text-align: center; padding: 2rem; color: #64748b;"><iconify-icon icon="material-symbols:check-circle-outline" style="font-size: 3rem; opacity: 0.3;"></iconify-icon><p style="margin-top: 1rem; font-weight: 500;">No tasks yet. Add your first task!</p></div>';
            }
        }

        function saveTodoList() {
            console.log('💾 Starting save process...');
            
            // Check if there are any todos
            const todos = document.querySelectorAll('#todoList .todo-item');
            console.log('   Found', todos.length, 'todo items');
            
            if (todos.length === 0) {
                alert('⚠️ Please add at least one task before saving!');
                return;
            }
            
            // Ask for a name for this todo list
            const listName = prompt('Enter a name for this todo list:', `My Tasks - ${new Date().toLocaleDateString()}`);
            console.log('   List name entered:', listName);
            
            if (!listName || listName.trim() === '') {
                console.log('   ❌ Save cancelled - no name provided');
                alert('⚠️ Please provide a name for your todo list!');
                return;
            }
            
            // Get current todos data
            const todoItems = document.querySelectorAll('#todoList .todo-item');
            const todoData = [];
            
            todoItems.forEach((item, index) => {
                const checkbox = item.querySelector('.todo-checkbox');
                const title = item.querySelector('div[style*="font-weight: 600"]');
                const priority = item.classList.contains('high-priority') ? 'high' : 
                               item.classList.contains('medium-priority') ? 'medium' : 'low';
                
                const taskData = {
                    text: title ? title.textContent.trim() : 'Untitled Task',
                    completed: checkbox ? checkbox.classList.contains('checked') : false,
                    priority: priority
                };
                
                console.log(`   Task ${index + 1}:`, taskData.text, `[${priority} priority]`);
                todoData.push(taskData);
            });
            
            console.log('   Total tasks to save:', todoData.length);
            
            // Get existing saved todo lists (array of lists)
            const savedLists = JSON.parse(localStorage.getItem('mathematicsSavedTodoLists') || '[]');
            console.log('   Existing saved lists:', savedLists.length);
            
            // Add new list to the array
            const newList = {
                id: Date.now(),
                name: listName.trim(),
                tasks: todoData,
                createdAt: new Date().toISOString()
            };
            savedLists.push(newList);
            
            console.log('   New list object:', newList);
            
            // Save back to localStorage
            localStorage.setItem('mathematicsSavedTodoLists', JSON.stringify(savedLists));
            console.log('✅ Saved todo list for Mathematics:', listName, '- Total lists:', savedLists.length);
            
            // Verify save
            const verifyLists = JSON.parse(localStorage.getItem('mathematicsSavedTodoLists') || '[]');
            console.log('   Verification - Lists in storage:', verifyLists.length);
            
            // Clear the dashboard todo list
            document.getElementById('todoList').innerHTML = '';
            localStorage.removeItem('mathematicsTodoList');
            console.log('   Dashboard todo list cleared');
            
            // Show success message
            const saveBtn = document.querySelector('.save-todo-btn');
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '<iconify-icon icon="material-symbols:check" class="me-1"></iconify-icon>Saved!';
            saveBtn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
            
            setTimeout(() => {
                saveBtn.innerHTML = originalText;
                saveBtn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
            }, 2000);
        }
        
        function viewAllTodoLists() {
            // Navigate to course-specific todo lists page
            window.location.href = 'mathematics-todolists.html';
        }
        
        function clearTodoList() {
            clearAllTodos();
        }
        
        function clearAllTodos() {
            if (confirm('⚠️ Are you sure you want to clear ALL tasks?\n\nThis will remove all tasks from your current to-do list. This action cannot be undone!')) {
                // Save empty array to localStorage
                localStorage.setItem('mathematicsTodoList', JSON.stringify([]));
                
                // Reload the display
                loadTodosFromLocalStorage();
                
                // Show success message
                const successMsg = document.createElement('div');
                successMsg.style.cssText = 'position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 1rem 1.5rem; border-radius: 10px; box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3); z-index: 10000; animation: slideInRight 0.3s ease;';
                successMsg.innerHTML = '<iconify-icon icon="material-symbols:check-circle" style="margin-right: 0.5rem;"></iconify-icon>All tasks cleared successfully!';
                document.body.appendChild(successMsg);
                
                setTimeout(() => successMsg.remove(), 2000);
            }
        }

        function removeTodoItem(button) {
            const todoItem = button.closest('.todo-item');
            
            // Add fade out animation
            todoItem.style.transition = 'all 0.3s ease';
            todoItem.style.opacity = '0';
            todoItem.style.transform = 'translateX(20px)';
            
            // Remove after animation
            setTimeout(() => {
                todoItem.remove();
                // Save to localStorage after removal
                saveTodosToLocalStorage();
            }, 300);
        }

        // Update welcome message based on time
        function updateWelcomeMessage() {
            // Function disabled - welcome section was removed from header
            // This prevents the JavaScript error
            return;
        }

        // Add floating animation to progress circles
        document.querySelectorAll('.progress-circle').forEach(circle => {
            circle.style.animation = 'pulse 2s ease-in-out infinite';
        });

        // Submission tracking system
        function markAsSubmitted(type, id) {
            const submissionKey = `mathematicsSubmissions_${type}`;
            let submissions = JSON.parse(localStorage.getItem(submissionKey) || '[]');
            
            // Check if already submitted
            if (!submissions.includes(id)) {
                submissions.push(id);
                localStorage.setItem(submissionKey, JSON.stringify(submissions));
                console.log(`Marked ${type} ${id} as submitted`);
                
                // Refresh deadlines after submission
                loadDeadlines();
            }
        }

        function isSubmitted(type, id) {
            const submissionKey = `mathematicsSubmissions_${type}`;
            const submissions = JSON.parse(localStorage.getItem(submissionKey) || '[]');
            return submissions.includes(id);
        }

        // Function to load deadlines from localStorage
        function loadDeadlinesFromPages() {
            const deadlines = [];
            
            console.log('Loading deadlines from pages...');
            
            // Load assignments from localStorage (check mathematics-specific keys)
            const studentAssignments = JSON.parse(localStorage.getItem('mathematicsAssignments') || '[]');
            const teacherAssignments = JSON.parse(localStorage.getItem('mathematicsTeacherAssignments') || '[]');
            const assignmentsList = JSON.parse(localStorage.getItem('mathematicsAssignmentsList') || '[]');
            
            // No sample data - only show real assignments from teacher panel
            
            // Combine all assignment sources, prioritizing studentAssignments
            let allAssignments = [...studentAssignments];
            teacherAssignments.forEach(teacherAssignment => {
                // Only add if not already in studentAssignments
                if (!allAssignments.find(a => a.id === teacherAssignment.id)) {
                    allAssignments.push(teacherAssignment);
                }
            });
            if (allAssignments.length === 0) {
                allAssignments = assignmentsList;
            }
            
            console.log('Assignments found:', allAssignments.length, allAssignments);
            
            allAssignments.forEach(assignment => {
                // Check if assignment is submitted using our tracking system
                const assignmentSubmitted = isSubmitted('assignment', assignment.id);
                
                // Handle multiple completion status formats for assignments
                const isNotCompleted = (
                    !assignmentSubmitted && (
                        assignment.status !== 'completed' && 
                        assignment.status !== 'graded' &&
                        assignment.completed !== true &&
                        assignment.status !== 'submitted'
                    )
                );
                
                if (assignment.dueDate && isNotCompleted) {
                    const daysUntil = calculateDaysUntil(assignment.dueDate);
                    if (daysUntil >= 0) { // Only show future or today's deadlines
                        console.log('Adding assignment to deadlines:', assignment.title);
                        deadlines.push({
                            type: 'Assignment',
                            subject: assignment.subject || 'Mathematics',
                            title: assignment.title,
                            dueDate: assignment.dueDate,
                            daysUntil: daysUntil,
                            id: assignment.id
                        });
                    }
                }
            });
            
            // Load quizzes from localStorage (check mathematics-specific keys)
            const studentQuizzes = JSON.parse(localStorage.getItem('mathematicsQuizzes') || '[]');
            const teacherQuizzes = JSON.parse(localStorage.getItem('mathematicsTeacherQuizzes') || '[]');
            const quizzesList = JSON.parse(localStorage.getItem('mathematicsQuizzesList') || '[]');
            
            // No sample data - only show real quizzes from teacher panel
            
            // Combine all quiz sources, prioritizing studentQuizzes
            let allQuizzes = [...studentQuizzes];
            teacherQuizzes.forEach(teacherQuiz => {
                // Only add if not already in studentQuizzes
                if (!allQuizzes.find(q => q.id === teacherQuiz.id)) {
                    allQuizzes.push(teacherQuiz);
                }
            });
            if (allQuizzes.length === 0) {
                allQuizzes = quizzesList;
            }
            
            console.log('Quizzes found:', allQuizzes.length, allQuizzes);
            
            allQuizzes.forEach(quiz => {
                // Check if quiz is submitted using our tracking system
                const quizSubmitted = isSubmitted('quiz', quiz.id);
                
                // Check if quiz is published and not completed
                // Handle multiple completion status formats
                const isNotCompleted = (
                    !assignmentSubmitted && (
                        quiz.completed === false || 
                        quiz.completed === undefined || 
                        quiz.status === 'pending' ||
                        quiz.status === 'available' ||
                        quiz.status === 'published' ||
                        (quiz.status && quiz.status !== 'completed' && quiz.status !== 'graded') ||
                        !quiz.status  // If no status field, assume not completed
                    )
                );
                
                const isPublished = quiz.published === true || quiz.status === 'available' || quiz.status === 'published' || quiz.status === 'pending';
                
                // If no dueDate is set, create one based on published date or current date
                let dueDate = quiz.dueDate;
                if (!dueDate && isPublished) {
                    // If published but no due date, set due date to 7 days from published date or now
                    const publishedDate = quiz.publishedDate ? new Date(quiz.publishedDate) : new Date();
                    dueDate = new Date(publishedDate.getTime() + 7 * 24 * 60 * 60 * 1000).toISOString();
                }
                
                console.log('Quiz:', quiz.title, 'has dueDate:', dueDate, 'published:', isPublished, 'not completed:', isNotCompleted, 'submitted:', quizSubmitted, 'completed field:', quiz.completed, 'status field:', quiz.status);
                
                if (dueDate && isPublished && isNotCompleted) {
                    const daysUntil = calculateDaysUntil(dueDate);
                    if (daysUntil >= 0) {
                        console.log('Adding quiz to deadlines:', quiz.title);
                        deadlines.push({
                            type: 'Quiz',
                            subject: quiz.subject || 'Mathematics',
                            title: quiz.title,
                            dueDate: dueDate,
                            daysUntil: daysUntil,
                            id: quiz.id
                        });
                    }
                }
            });
            
            // Load exams from localStorage (check mathematics-specific keys)
            const studentExams = JSON.parse(localStorage.getItem('mathematicsExams') || '[]');
            const teacherExams = JSON.parse(localStorage.getItem('mathematicsTeacherExams') || '[]');
            const examsList = JSON.parse(localStorage.getItem('mathematicsExamsList') || '[]');
            
            // No sample data - only show real exams from teacher panel
            
            // Combine all exam sources, prioritizing studentExams
            let allExams = [...studentExams];
            teacherExams.forEach(teacherExam => {
                // Only add if not already in studentExams
                if (!allExams.find(e => e.id === teacherExam.id)) {
                    allExams.push(teacherExam);
                }
            });
            if (allExams.length === 0) {
                allExams = examsList;
            }
            
            console.log('Exams found:', allExams.length, allExams);
            
            allExams.forEach(exam => {
                // Check if exam is submitted using our tracking system
                const examSubmitted = isSubmitted('exam', exam.id);
                
                // Check if exam is published and not completed
                // Handle multiple completion status formats
                const isNotCompleted = (
                    !assignmentSubmitted && (
                        exam.completed === false || 
                        exam.completed === undefined || 
                        exam.status === 'pending' ||
                        exam.status === 'available' ||
                        (exam.status && exam.status !== 'completed' && exam.status !== 'graded') ||
                        !exam.status  // If no status field, assume not completed
                    )
                );
                
                const isPublished = exam.published === true || exam.status === 'available';
                
                // If no dueDate is set, create one based on published date or current date
                let dueDate = exam.dueDate;
                if (!dueDate && isPublished) {
                    // If published but no due date, set due date to 7 days from published date or now
                    const publishedDate = exam.publishedDate ? new Date(exam.publishedDate) : new Date();
                    dueDate = new Date(publishedDate.getTime() + 7 * 24 * 60 * 60 * 1000).toISOString();
                }
                
                console.log('Exam:', exam.title, 'has dueDate:', dueDate, 'published:', isPublished, 'not completed:', isNotCompleted, 'submitted:', quizSubmitted, 'completed field:', exam.completed, 'status field:', exam.status);
                
                if (dueDate && isPublished && isNotCompleted) {
                    const daysUntil = calculateDaysUntil(dueDate);
                    if (daysUntil >= 0) {
                        console.log('Adding exam to deadlines:', exam.title);
                        deadlines.push({
                            type: 'Exam',
                            subject: exam.subject || 'Mathematics',
                            title: exam.title,
                            dueDate: dueDate,
                            daysUntil: daysUntil,
                            id: exam.id
                        });
                    }
                }
            });
            
            console.log('Total deadlines found:', deadlines.length);
            console.log('Final deadlines array:', deadlines);
            return deadlines;
        }

        // Function to refresh deadlines display
        function loadDeadlines() {
            const deadlinesList = document.getElementById('deadlinesList');
            if (!deadlinesList) return;
            
            const deadlineData = loadDeadlinesFromPages();
            
            // Check if there are no deadlines
            if (deadlineData.length === 0) {
                deadlinesList.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #6c757d;">
                        <iconify-icon icon="material-symbols:check-circle" style="font-size: 3rem; color: #10b981; margin-bottom: 1rem;"></iconify-icon>
                        <p style="font-size: 1.1rem; font-weight: 600; margin-bottom: 0.5rem;">All caught up!</p>
                        <p style="font-size: 0.9rem;">No upcoming deadlines at the moment.</p>
                    </div>
                `;
                return;
            }
            
            // Sort deadlines by days until due (urgent first)
            deadlineData.sort((a, b) => a.daysUntil - b.daysUntil);
            
            let deadlinesHTML = '';
            deadlineData.forEach(deadline => {
                let urgencyClass = 'normal';
                if (deadline.daysUntil === 0) urgencyClass = 'urgent';
                else if (deadline.daysUntil <= 2) urgencyClass = 'warning';
                
                deadlinesHTML += `
                    <div class="deadline-item ${urgencyClass}" data-type="${deadline.type}" data-id="${deadline.id}">
                        <div class="deadline-subject">${deadline.subject}</div>
                        <div class="deadline-title">${deadline.title}</div>
                        <div class="deadline-time">${formatDeadlineTime(deadline.daysUntil, deadline.dueDate)}</div>
                    </div>
                `;
            });
            
            deadlinesList.innerHTML = deadlinesHTML;
        }

        // Expose submission functions globally
        window.markAsSubmitted = markAsSubmitted;
        window.isSubmitted = isSubmitted;
        window.loadDeadlines = loadDeadlines;
        
        // Function to calculate days until deadline
        function calculateDaysUntil(dueDate) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const deadline = new Date(dueDate);
            deadline.setHours(0, 0, 0, 0);
            const diffTime = deadline - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            return diffDays;
        }

        // Function to determine deadline urgency class
        function getDeadlineClass(daysUntil) {
            if (daysUntil === 0) return 'urgent';      // Red - Today
            if (daysUntil <= 3) return 'warning';      // Yellow - 1-3 days
            return 'normal';                            // Green - More than 3 days
        }

        // Function to format deadline time
        function formatDeadlineTime(daysUntil) {
            const today = new Date();
            const deadlineDate = new Date(today);
            deadlineDate.setDate(today.getDate() + daysUntil);
            
            const options = { month: 'short', day: 'numeric', year: 'numeric' };
            const dateStr = deadlineDate.toLocaleDateString('en-US', options);
            
            if (daysUntil === 0) return 'Due: Today at 11:59 PM';
            if (daysUntil === 1) return 'Due: Tomorrow at 11:59 PM';
            if (daysUntil <= 3) return `Due: in ${daysUntil} days (${dateStr})`;
            if (daysUntil <= 7) return `Due: in ${daysUntil} days (${dateStr})`;
            if (daysUntil <= 14) return `Due: in ${Math.ceil(daysUntil / 7)} week${daysUntil > 7 ? 's' : ''} (${dateStr})`;
            return `Due: ${dateStr}`;
        }

        // Function to get type icon
        function getTypeIcon(type) {
            const icons = {
                'Assignment': 'material-symbols:assignment',
                'Quiz': 'material-symbols:quiz',
                'Exam': 'material-symbols:school'
            };
            return icons[type] || 'material-symbols:event';
        }

        // Function to get action button for each deadline type
        function getActionButton(type, title) {
            const buttonStyle = `
                background: linear-gradient(135deg, #667eea, #764ba2);
                border: none;
                color: white;
                padding: 0.5rem 1rem;
                border-radius: 8px;
                font-size: 0.85rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 0.3rem;
                box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
            `;
            
            const hoverStyle = `
                transform: translateY(-2px);
                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            `;
            
            const buttonId = `actionBtn_${type}_${title.replace(/\s+/g, '_')}`;
            
            switch(type) {
                case 'Assignment':
                    return `
                        <button id="${buttonId}" style="${buttonStyle}" 
                                onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.4)'"
                                onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(102, 126, 234, 0.3)'"
                                onclick="startAssignment('${title}')">
                            <iconify-icon icon="material-symbols:play-arrow" style="font-size: 1rem;"></iconify-icon>
                            Start
                        </button>
                    `;
                case 'Quiz':
                    return `
                        <button id="${buttonId}" style="${buttonStyle}" 
                                onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.4)'"
                                onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(102, 126, 234, 0.3)'"
                                onclick="startQuiz('${title}')">
                            <iconify-icon icon="material-symbols:quiz" style="font-size: 1rem;"></iconify-icon>
                            Take Quiz
                        </button>
                    `;
                case 'Exam':
                    return `
                        <button id="${buttonId}" style="${buttonStyle}" 
                                onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.4)'"
                                onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(102, 126, 234, 0.3)'"
                                onclick="startExam('${title}')">
                            <iconify-icon icon="material-symbols:school" style="font-size: 1rem;"></iconify-icon>
                            Take Exam
                        </button>
                    `;
                default:
                    return '';
            }
        }

        // Function to render deadlines
        function renderDeadlines() {
            const deadlinesList = document.getElementById('deadlinesList');
            deadlinesList.innerHTML = '';
            
            // Load deadlines from localStorage
            const deadlineData = loadDeadlinesFromPages();
            
            // Check if there are no deadlines
            if (deadlineData.length === 0) {
                deadlinesList.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #6c757d;">
                        <iconify-icon icon="material-symbols:check-circle" style="font-size: 3rem; color: #10b981; margin-bottom: 1rem;"></iconify-icon>
                        <p style="font-size: 1.1rem; font-weight: 600; margin-bottom: 0.5rem;">All caught up!</p>
                        <p style="font-size: 0.9rem;">No upcoming deadlines at the moment.</p>
                    </div>
                `;
                return;
            }
            
            // Sort deadlines by days until due
            const sortedDeadlines = [...deadlineData].sort((a, b) => a.daysUntil - b.daysUntil);
            
            sortedDeadlines.forEach((deadline, index) => {
                const deadlineClass = getDeadlineClass(deadline.daysUntil);
                const timeText = formatDeadlineTime(deadline.daysUntil);
                const icon = getTypeIcon(deadline.type);
                
                const deadlineItem = document.createElement('div');
                deadlineItem.className = `deadline-item ${deadlineClass}`;
                deadlineItem.style.opacity = '0';
                deadlineItem.style.transform = 'translateY(20px)';
                
                deadlineItem.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <iconify-icon icon="${icon}" style="font-size: 1.5rem; color: ${
                            deadlineClass === 'urgent' ? '#ef4444' : 
                            deadlineClass === 'warning' ? '#f59e0b' : '#10b981'
                        };"></iconify-icon>
                        <div style="flex: 1;">
                            <div class="deadline-subject">${deadline.subject} • ${deadline.type}</div>
                            <div class="deadline-title">${deadline.title}</div>
                            <div class="deadline-time">${timeText}</div>
                        </div>
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            ${getActionButton(deadline.type, deadline.title)}
                        </div>
                    </div>
                `;
                
                deadlinesList.appendChild(deadlineItem);
                
                // Add animation
                setTimeout(() => {
                    deadlineItem.style.transition = 'all 0.3s ease';
                    deadlineItem.style.opacity = '1';
                    deadlineItem.style.transform = 'translateY(0)';
                }, index * 100);
            });
        }

        // Simulate real-time updates
        function updateDeadlines() {
            const deadlineItems = document.querySelectorAll('.deadline-item');
            deadlineItems.forEach(item => {
                // Add subtle animation every few seconds
                setTimeout(() => {
                    item.style.transform = 'translateX(0)';
                    item.style.transition = 'transform 0.3s ease';
                }, Math.random() * 2000);
            });
        }

        // Update deadlines once on load (removed interval to prevent performance issues)
        updateDeadlines();

        // Function to start assignment
        function startAssignment(title) {
            console.log('Starting assignment:', title);
            
            // Find the assignment by title
            const studentAssignments = JSON.parse(localStorage.getItem('studentAssignments') || '[]');
            const teacherAssignments = JSON.parse(localStorage.getItem('teacherAssignments') || '[]');
            const assignmentsList = JSON.parse(localStorage.getItem('assignmentsList') || '[]');
            
            // Combine all assignment sources
            let allAssignments = [...studentAssignments];
            teacherAssignments.forEach(teacherAssignment => {
                if (!allAssignments.find(a => a.id === teacherAssignment.id)) {
                    allAssignments.push(teacherAssignment);
                }
            });
            if (allAssignments.length === 0) {
                allAssignments = assignmentsList;
            }
            
            const assignment = allAssignments.find(a => a.title === title);
            
            if (assignment) {
                // Redirect to homework page with the assignment ID
                window.location.href = `mathematics-homework.html?start=${assignment.id}`;
            } else {
                // If not found, just go to homework page
                window.location.href = 'mathematics-homework.html';
            }
        }

        // Function to start quiz
        function startQuiz(title) {
            console.log('Starting quiz:', title);
            
            // Find the quiz by title
            const studentQuizzes = JSON.parse(localStorage.getItem('studentQuizzes') || '[]');
            const teacherQuizzes = JSON.parse(localStorage.getItem('teacherQuizzes') || '[]');
            const quizzesList = JSON.parse(localStorage.getItem('quizzesList') || '[]');
            
            // Combine all quiz sources
            let allQuizzes = [...studentQuizzes];
            teacherQuizzes.forEach(teacherQuiz => {
                if (!allQuizzes.find(q => q.id === teacherQuiz.id)) {
                    allQuizzes.push(teacherQuiz);
                }
            });
            if (allQuizzes.length === 0) {
                allQuizzes = quizzesList;
            }
            
            const quiz = allQuizzes.find(q => q.title === title);
            
            if (quiz) {
                // Redirect to quiz page with the quiz ID
                window.location.href = `mathematics-quiz.html?start=${quiz.id}`;
            } else {
                // If not found, just go to quiz page
                window.location.href = 'mathematics-quiz.html';
            }
        }

        // Function to start exam
        function startExam(title) {
            console.log('Starting exam:', title);
            
            // Find the exam by title
            const studentExams = JSON.parse(localStorage.getItem('studentExams') || '[]');
            const teacherExams = JSON.parse(localStorage.getItem('teacherExams') || '[]');
            const examsList = JSON.parse(localStorage.getItem('examsList') || '[]');
            
            // Combine all exam sources
            let allExams = [...studentExams];
            teacherExams.forEach(teacherExam => {
                if (!allExams.find(e => e.id === teacherExam.id)) {
                    allExams.push(teacherExam);
                }
            });
            if (allExams.length === 0) {
                allExams = examsList;
            }
            
            const exam = allExams.find(e => e.title === title);
            
            if (exam) {
                // Redirect to exam page with the exam ID
                window.location.href = `mathematics-exam.html?start=${exam.id}`;
            } else {
                // If not found, just go to exam page
                window.location.href = 'mathematics-exam.html';
            }
        }

        // Add click effects to cards
        document.querySelectorAll('.dashboard-card, .modern-card').forEach(card => {
            card.addEventListener('click', function() {
                this.style.transform = 'scale(0.98)';
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                }, 150);
            });
        });

        // Update wrong questions count
        function updateWrongQuestionsCount() {
            const wrongQuestions = JSON.parse(localStorage.getItem('mathematicsWrongQuestions')) || [];
            const customFolders = JSON.parse(localStorage.getItem('mathematicsCustomFolders')) || [];
            
            // Count questions in all folders (assignments, quizzes, exams, custom folders)
            let totalCount = 0;
            
            // Count questions in predefined activity folders
            const activityTypes = ['assignments', 'quizzes', 'exams'];
            activityTypes.forEach(activityType => {
                const count = wrongQuestions.filter(q => 
                    q.activityType === activityType || q.source === activityType.slice(0, -1)
                ).length;
                totalCount += count;
            });
            
            // Count questions in custom folders
            customFolders.forEach(folder => {
                const count = wrongQuestions.filter(q => q.folderId === folder.id).length;
                totalCount += count;
            });
            
            // Count questions not in any folder (uncategorized)
            const uncategorizedCount = wrongQuestions.filter(q => 
                !q.folderId && !q.activityType && !q.source
            ).length;
            totalCount += uncategorizedCount;
            
            const countElement = document.getElementById('wrongQuestionsCount');
            if (countElement) {
                countElement.textContent = totalCount;
            }
        }
        
        // Update tricky questions count
        function updateTrickyQuestionsCount() {
            const trickyQuestions = JSON.parse(localStorage.getItem('mathematicsTrickyQuestions')) || [];
            const customFolders = JSON.parse(localStorage.getItem('mathematicsTrickyCustomFolders')) || [];
            
            // Count questions in all folders (assignments, quizzes, exams, custom folders)
            let totalCount = 0;
            
            // Count questions in predefined activity folders
            const activityTypes = ['assignments', 'quizzes', 'exams'];
            activityTypes.forEach(activityType => {
                const count = trickyQuestions.filter(q => 
                    q.activityType === activityType || q.source === activityType.slice(0, -1)
                ).length;
                totalCount += count;
            });
            
            // Count questions in custom folders
            customFolders.forEach(folder => {
                const count = trickyQuestions.filter(q => q.folderId === folder.id).length;
                totalCount += count;
            });
            
            // Count questions not in any folder (uncategorized)
            const uncategorizedCount = trickyQuestions.filter(q => 
                !q.folderId && !q.activityType && !q.source
            ).length;
            totalCount += uncategorizedCount;
            
            const countElement = document.getElementById('trickyQuestionsCount');
            if (countElement) {
                countElement.textContent = totalCount;
            }
        }

        // Update daily practice statistics
        function updateDailyPracticeStats() {
            // Clear any existing sample questions from localStorage
            localStorage.removeItem('mathematics_daily_practice_questions');
            
            // Get daily practice data from localStorage
            const questions = JSON.parse(localStorage.getItem('mathematics_daily_practice_questions_student') || '[]');
            const streak = parseInt(localStorage.getItem('mathematicsStreak') || '0');
            const solved = parseInt(localStorage.getItem('mathematicsQuestionsSolved') || '0');
            const correct = parseInt(localStorage.getItem('mathematicsCorrectAnswers') || '0');
            
            // Calculate accuracy
            const accuracy = solved > 0 ? Math.round((correct / solved) * 100) : 0;
            
            // Update UI
            document.getElementById('dailyPracticeStreak').textContent = streak;
            document.getElementById('dailyPracticeSolved').textContent = solved;
            document.getElementById('dailyPracticeAccuracy').textContent = accuracy + '%';
            
            // Load inline question if available
            loadInlineQuestion(questions);
        }

        // Load inline question
        function loadInlineQuestion(questions) {
            const container = document.getElementById('inlineQuestionContainer');
            const noQuestionsMessage = document.getElementById('noQuestionsMessage');
            const questionText = document.getElementById('inlineQuestionText');
            
            if (questions.length > 0) {
                const firstQuestion = questions[0];
                questionText.innerHTML = `
                    <div style="margin-bottom: 1rem;">
                        <div class="d-flex gap-2 mb-2">
                            <span style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 0.4rem 0.8rem; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">
                                ${firstQuestion.difficulty}
                            </span>
                            <span style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 0.4rem 0.8rem; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">
                                ${firstQuestion.topic}
                            </span>
                            <span style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 0.4rem 0.8rem; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">
                                ${firstQuestion.type || 'Multiple Choice'}
                            </span>
                        </div>
                        <div style="font-size: 1.1rem; line-height: 1.6;">${firstQuestion.question}</div>
                    </div>
                `;
                
                // Create appropriate answer input based on question type
                let answerHtml = '';
                if (firstQuestion.type === 'multiple-choice' && firstQuestion.options && firstQuestion.options.length > 0) {
                    // Multiple choice options
                    answerHtml = `
                        <div class="mb-3">
                            <label class="form-label" style="font-weight: 600; color: #1e293b; margin-bottom: 1rem;">Select your answer:</label>
                            <div class="multiple-choice-options" style="display: flex; flex-direction: column; gap: 0.75rem;">
                                ${firstQuestion.options.map((option, index) => `
                                    <label class="option-label" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 10px; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.borderColor='#10b981'" onmouseout="this.style.borderColor='#e2e8f0'">
                                        <input type="radio" name="inlineAnswer" value="${option}" style="margin: 0;">
                                        <span class="option-text" style="font-size: 0.95rem; color: #1e293b;">${option}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </div>
                    `;
                } else {
                    // Short answer textarea
                    answerHtml = `
                        <div class="mb-3">
                            <label class="form-label" style="font-weight: 600; color: #1e293b; margin-bottom: 1rem;">Type your answer:</label>
                            <textarea id="inlineAnswerInput" class="form-control" rows="3" placeholder="Type your answer here..." style="border: 2px solid #e2e8f0; border-radius: 10px; resize: vertical; font-size: 0.95rem; transition: all 0.3s ease;" onfocus="this.style.borderColor='#10b981'" onblur="this.style.borderColor='#e2e8f0'"></textarea>
                        </div>
                    `;
                }
                
                // Update the answer container
                const answerContainerDiv = document.querySelector('.mt-auto .row .col-md-8');
                if (answerContainerDiv) {
                    answerContainerDiv.innerHTML = answerHtml;
                }
                
                // Store current question data for submission
                window.currentInlineQuestion = firstQuestion;
                
                container.style.display = 'flex';
                noQuestionsMessage.style.display = 'none';
            } else {
                container.style.display = 'none';
                noQuestionsMessage.style.display = 'flex';
            }
        }

        // Submit inline answer
        function submitInlineAnswer() {
            if (!window.currentInlineQuestion) {
                alert('No question available.');
                return;
            }

            let answer = '';
            let isCorrect = false;

            if (window.currentInlineQuestion.type === 'multiple-choice') {
                // Handle multiple choice answer
                const selectedOption = document.querySelector('input[name="inlineAnswer"]:checked');
                if (!selectedOption) {
                    alert('Please select an answer before submitting.');
                    return;
                }
                answer = selectedOption.value;
                isCorrect = answer === window.currentInlineQuestion.answer;
            } else {
                // Handle short answer
                const answerInput = document.getElementById('inlineAnswerInput');
                if (!answerInput) {
                    alert('Answer input not found.');
                    return;
                }
                answer = answerInput.value.trim();
                if (!answer) {
                    alert('Please enter an answer before submitting.');
                    return;
                }
                // Simple answer checking (case-insensitive)
                isCorrect = answer.toLowerCase().includes(window.currentInlineQuestion.answer.toLowerCase()) ||
                           window.currentInlineQuestion.answer.toLowerCase().includes(answer.toLowerCase());
            }

            // Update statistics
            let solved = parseInt(localStorage.getItem('mathematicsQuestionsSolved') || '0');
            let correct = parseInt(localStorage.getItem('mathematicsCorrectAnswers') || '0');
            let streak = parseInt(localStorage.getItem('mathematicsStreak') || '0');

            solved++;
            if (isCorrect) {
                correct++;
                streak++;
                alert('✅ Correct! Well done!');
            } else {
                streak = Math.max(0, streak - 1);
                alert('❌ Not quite right. Check the answer below.');
            }

            localStorage.setItem('mathematicsQuestionsSolved', solved.toString());
            localStorage.setItem('mathematicsCorrectAnswers', correct.toString());
            localStorage.setItem('mathematicsStreak', streak.toString());

            // Update statistics display
            updateDailyPracticeStats();

            // Show answer
            showInlineAnswer();
        }

        // Show inline answer
        function showInlineAnswer() {
            if (!window.currentInlineQuestion) return;

            const answerDisplay = document.getElementById('inlineAnswerDisplay');
            const correctAnswer = document.getElementById('inlineCorrectAnswer');
            const explanation = document.getElementById('inlineExplanation');

            correctAnswer.textContent = window.currentInlineQuestion.answer;
            explanation.textContent = window.currentInlineQuestion.explanation || 'No explanation provided.';
            
            answerDisplay.style.display = 'block';
        }
        
        // Initialize page when DOM is loaded
        // Flashcard functionality
        function updateFlashcardStats() {
            const chapters = [
                // Flashcard chapters will be loaded dynamically from teacher content
            ];

            const progress = JSON.parse(localStorage.getItem('flashcardProgress') || '{}');
            const forgottenCards = JSON.parse(localStorage.getItem('forgottenCards') || '{}');
            
            let totalCards = 0;
            let masteredCards = 0;
            let studyingCards = 0;
            let forgottenCount = 0;

            chapters.forEach(chapter => {
                totalCards += chapter.cardsCount;
                if (progress[chapter.id]) {
                    masteredCards += progress[chapter.id].mastered || 0;
                }
            });

            studyingCards = totalCards - masteredCards;

            // Count forgotten cards
            Object.keys(forgottenCards).forEach(chapterId => {
                if (Array.isArray(forgottenCards[chapterId])) {
                    forgottenCount += forgottenCards[chapterId].length;
                }
            });

            // Update UI
            document.getElementById('flashcardTotal').textContent = totalCards;
            document.getElementById('flashcardMastered').textContent = masteredCards;
            document.getElementById('flashcardStudying').textContent = studyingCards;
            document.getElementById('flashcardForgotten').textContent = forgottenCount;
            document.getElementById('forgottenCountBtn').textContent = forgottenCount;

            // Hide forgotten button if no forgotten cards
            if (forgottenCount === 0) {
                document.getElementById('reviewForgottenBtn').style.display = 'none';
            } else {
                document.getElementById('reviewForgottenBtn').style.display = 'flex';
            }

            // Populate quick access chapters (show first 4 chapters)
            const quickAccessContainer = document.getElementById('quickAccessChapters');
            quickAccessContainer.innerHTML = chapters.slice(0, 4).map(chapter => {
                const chapterProgress = progress[chapter.id] || { mastered: 0 };
                const masteredPercentage = Math.round((chapterProgress.mastered / chapter.cardsCount) * 100) || 0;
                
                return `
                    <div class="col-6 col-md-3 mb-3">
                        <div onclick="window.location.href='flashcards-chapter.html?chapter=${chapter.id}'" style="background: white; border: 2px solid rgba(102, 126, 234, 0.2); border-radius: 15px; padding: 1rem; text-align: center; cursor: pointer; transition: all 0.3s ease; height: 100%;">
                            <iconify-icon icon="${chapter.icon}" style="font-size: 2.5rem; color: #667eea; margin-bottom: 0.5rem;"></iconify-icon>
                            <div style="font-size: 0.85rem; font-weight: 600; color: #1e293b; margin-bottom: 0.5rem;">${chapter.title}</div>
                            <div style="font-size: 0.75rem; color: #6c757d;">${masteredPercentage}% Mastered</div>
                            <div style="height: 4px; background: rgba(102, 126, 234, 0.2); border-radius: 10px; margin-top: 0.5rem; overflow: hidden;">
                                <div style="height: 100%; background: linear-gradient(135deg, #667eea, #764ba2); width: ${masteredPercentage}%; transition: width 0.3s ease;"></div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            // Add hover effect via inline styles
            quickAccessContainer.querySelectorAll('[onclick]').forEach(el => {
                el.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-5px)';
                    this.style.boxShadow = '0 8px 25px rgba(102, 126, 234, 0.2)';
                    this.style.borderColor = '#667eea';
                });
                el.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                    this.style.boxShadow = 'none';
                    this.style.borderColor = 'rgba(102, 126, 234, 0.2)';
                });
            });
        }

        // Function to update greeting with student name
        function updateGreeting() {
            const userName = localStorage.getItem('userName');
            const greetingEl = document.getElementById('greetingText');
            
            if (userName && greetingEl) {
                // Get current hour to determine greeting
                const hour = new Date().getHours();
                let greeting = 'Good evening';
                
                if (hour < 12) {
                    greeting = 'Good morning';
                } else if (hour < 18) {
                    greeting = 'Good afternoon';
                }
                
                // Extract first name
                const firstName = userName.split(' ')[0];
                greetingEl.textContent = `${greeting}, ${firstName}!`;
            }
        }

        // Schedule Widget Functions
        function generateScheduleWidget() {
            const widget = document.getElementById('scheduleWidget');
            if (!widget) {
                console.log('Schedule widget element not found');
                return;
            }

            const currentDate = new Date();
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();
            
            // Load sessions from student-facing schedule store
            const scheduleEntries = JSON.parse(localStorage.getItem('mathematicsStudentSchedule') || '[]');
            const sessions = scheduleEntries
                .filter(e => {
                    const [y, m, d] = e.date.split('-').map(x => parseInt(x, 10));
                    return y === currentYear && (m - 1) === currentMonth;
                })
                .map(e => ({
                    date: parseInt(e.date.split('-')[2], 10),
                    title: e.title,
                    time: e.time,
                    type: e.type
                }));

            const monthNames = ["January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"];

            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const firstDayOfMonth = new Date(currentYear, currentMonth, 1).getDay();
            const today = currentDate.getDate();

            let calendarHTML = `
                <div class="schedule-widget">
                    <div class="schedule-header">
                        <div class="schedule-view-toggles">
                            <button class="schedule-view-toggle active" onclick="setScheduleView('month')">month</button>
                            <button class="schedule-view-toggle" onclick="setScheduleView('week')">week</button>
                            <button class="schedule-view-toggle" onclick="setScheduleView('day')">day</button>
                        </div>
                        <button class="schedule-today-btn" onclick="goToToday()">today</button>
                    </div>
                    
                    <div class="schedule-calendar">
                        <div class="schedule-days-header">
                            <div class="schedule-day-header">Sun</div>
                            <div class="schedule-day-header">Mon</div>
                            <div class="schedule-day-header">Tue</div>
                            <div class="schedule-day-header">Wed</div>
                            <div class="schedule-day-header">Thu</div>
                            <div class="schedule-day-header">Fri</div>
                            <div class="schedule-day-header">Sat</div>
                        </div>
                        
                        <div class="schedule-days-grid">
            `;

            // Previous month days
            const prevMonth = new Date(currentYear, currentMonth, 0);
            const daysInPrevMonth = prevMonth.getDate();
            for (let i = firstDayOfMonth - 1; i >= 0; i--) {
                calendarHTML += `<div class="schedule-day other-month">${daysInPrevMonth - i}</div>`;
            }

            // Current month days
            for (let day = 1; day <= daysInMonth; day++) {
                const hasSession = sessions.some(session => session.date === day);
                const isToday = day === today;
                let dayClass = '';
                
                if (isToday) dayClass = 'today';
                else if (hasSession) dayClass = 'has-session';
                
                calendarHTML += `<div class="schedule-day ${dayClass}" onclick="showSessionDetails(${day})">${day}</div>`;
            }

            // Next month days
            const remainingCells = 42 - (firstDayOfMonth + daysInMonth);
            for (let day = 1; day <= remainingCells; day++) {
                calendarHTML += `<div class="schedule-day other-month">${day}</div>`;
            }

            calendarHTML += `
                        </div>
                    </div>
                    
                    <div class="schedule-navigation">
                        <div class="schedule-monitor-icon">
                            <iconify-icon icon="material-symbols:monitor"></iconify-icon>
                        </div>
                        <button class="schedule-nav-btn" onclick="navigateSchedule(-1)">
                            <iconify-icon icon="material-symbols:chevron-left"></iconify-icon>
                            <iconify-icon icon="material-symbols:chevron-right"></iconify-icon>
                        </button>
                    </div>
                </div>
            `;

            widget.innerHTML = calendarHTML;
        }

        function setScheduleView(view) {
            // Remove active class from all toggles
            document.querySelectorAll('.schedule-view-toggle').forEach(toggle => {
                toggle.classList.remove('active');
            });
            
            // Add active class to clicked toggle
            event.target.classList.add('active');
            
            // Handle view change (for future implementation)
            console.log(`Switched to ${view} view`);
        }

        function goToToday() {
            console.log('Go to today clicked');
            // Implementation for going to today
        }

        function showSessionDetails(day) {
            const currentDate = new Date();
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();
            const scheduleEntries = JSON.parse(localStorage.getItem('mathematicsStudentSchedule') || '[]');
            const sessions = scheduleEntries
                .filter(e => {
                    const [y, m, d] = e.date.split('-').map(x => parseInt(x, 10));
                    return y === currentYear && (m - 1) === currentMonth && d === day;
                })
                .map(e => ({
                    date: day,
                    title: e.title,
                    time: e.time,
                    type: e.type
                }));
            
            if (sessions.length > 0) {
                // Create modal HTML
                const monthNames = ["January", "February", "March", "April", "May", "June",
                    "July", "August", "September", "October", "November", "December"];
                const monthName = monthNames[currentMonth];
                
                let sessionsHTML = '';
                sessions.forEach(session => {
                    sessionsHTML += `
                        <div class="session-detail-item" style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 1rem; border-radius: 10px; margin-bottom: 1rem;">
                            <div style="font-weight: 600; font-size: 1.1rem; margin-bottom: 0.5rem;">${session.title}</div>
                            <div style="font-size: 0.9rem; opacity: 0.9;">
                                <div><strong>Time:</strong> ${session.time}</div>
                                <div><strong>Type:</strong> ${session.type}</div>
                            </div>
                        </div>
                    `;
                });
                
                const modalHTML = `
                    <div id="sessionDetailsModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; display: flex; align-items: center; justify-content: center;">
                        <div style="background: white; border-radius: 15px; padding: 2rem; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 20px 40px rgba(0,0,0,0.3);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                                <h4 style="margin: 0; color: #1e293b; font-weight: 600;">Sessions on ${monthName} ${day}</h4>
                                <button onclick="closeSessionDetailsModal()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #64748b;">&times;</button>
                            </div>
                            <div>
                                ${sessionsHTML}
                            </div>
                            <div style="text-align: center; margin-top: 1.5rem;">
                                <button onclick="closeSessionDetailsModal()" style="background: linear-gradient(135deg, #10b981, #059669); color: white; border: none; padding: 0.75rem 2rem; border-radius: 10px; cursor: pointer; font-weight: 600;">Close</button>
                            </div>
                        </div>
                    </div>
                `;
                
                // Remove existing modal if any
                const existingModal = document.getElementById('sessionDetailsModal');
                if (existingModal) {
                    existingModal.remove();
                }
                
                // Add modal to page
                document.body.insertAdjacentHTML('beforeend', modalHTML);
            } else {
                console.log(`No session on day ${day}`);
            }
        }

        function closeSessionDetailsModal() {
            const modal = document.getElementById('sessionDetailsModal');
            if (modal) {
                modal.remove();
            }
        }

        function navigateSchedule(direction) {
            console.log(`Navigate schedule: ${direction > 0 ? 'next' : 'previous'}`);
            // Implementation for navigation
        }
        
        // Function to fetch and sync enrollments if localStorage is empty
        async function fetchAndSyncEnrollments() {
            try {
                const authToken = localStorage.getItem('authToken');
                const userId = localStorage.getItem('userId');
                const userEmail = localStorage.getItem('userEmail');
                
                if (!authToken || !userId) {
                    console.log('❌ No auth token or userId');
                    return;
                }
                
                const apiUrl = 'http://localhost:3000/api';
                console.log('🔄 Fetching enrollments and orders for userId:', userId);
                
                const enrolledCourseIds = [];
                
                // Fetch enrollments
                const enrollmentsResponse = await fetch(`${apiUrl}/my-enrollments`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (enrollmentsResponse.ok) {
                    const enrollmentsData = await enrollmentsResponse.json();
                    console.log('📚 Enrollments data:', enrollmentsData);
                    
                    if (enrollmentsData.success && enrollmentsData.enrollments) {
                        enrollmentsData.enrollments.forEach(e => {
                            if (!enrolledCourseIds.includes(e.course_id)) {
                                enrolledCourseIds.push(e.course_id);
                            }
                        });
                    }
                }
                
                // Also fetch orders by email
                if (userEmail) {
                    const ordersResponse = await fetch(`${apiUrl}/orders/by-email/${encodeURIComponent(userEmail)}`);
                    
                    if (ordersResponse.ok) {
                        const ordersData = await ordersResponse.json();
                        console.log('📦 Orders data:', ordersData);
                        
                        if (ordersData.success && ordersData.orders) {
                            ordersData.orders.forEach(order => {
                                if (order.status === 'approved') {
                                    try {
                                        const courses = typeof order.courses === 'string' ? JSON.parse(order.courses) : order.courses;
                                        
                                        if (Array.isArray(courses)) {
                                            courses.forEach(course => {
                                                const courseId = course.courseId || course.id;
                                                if (courseId && !enrolledCourseIds.includes(courseId)) {
                                                    enrolledCourseIds.push(courseId);
                                                }
                                            });
                                        }
                                    } catch (e) {
                                        console.error('Error parsing order courses:', e);
                                    }
                                }
                            });
                        }
                    }
                }
                
                console.log('✅ Final enrolled course IDs:', enrolledCourseIds);
                
                if (enrolledCourseIds.length > 0) {
                    localStorage.setItem('enrolledCourses', JSON.stringify(enrolledCourseIds));
                    console.log('✅ Saved to localStorage and re-initializing course switcher');
                    
                    // Re-initialize course switcher with new data
                    initCourseSwitcher('mathematics');
                } else {
                    console.log('ℹ️ No enrollments or approved orders found');
                }
            } catch (error) {
                console.error('❌ Error fetching enrollments:', error);
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // Debug: Check localStorage on page load
            console.log('🔍 DEBUG: Page loaded - checking localStorage');
            console.log('  - userLoggedIn:', localStorage.getItem('userLoggedIn'));
            console.log('  - userId:', localStorage.getItem('userId'));
            console.log('  - enrolledCourses:', localStorage.getItem('enrolledCourses'));
            
            // If enrolledCourses is empty, try to fetch from API
            const enrolledCourses = JSON.parse(localStorage.getItem('enrolledCourses') || '[]');
            if (enrolledCourses.length === 0) {
                console.log('⚠️ enrolledCourses is empty, fetching from API...');
                fetchAndSyncEnrollments();
            }
            
            // Initialize course switcher
            initCourseSwitcher('mathematics');
            
            // Set current course for todolists page detection
            localStorage.setItem('lastViewedCourse', 'mathematics');
            
            // Update greeting with student name
            updateGreeting();
            
            // Load todos from localStorage
            loadTodosFromLocalStorage();
            
            // Render deadlines
            renderDeadlines();
            
            // Update flashcard stats
            updateFlashcardStats();
            
            // Update daily practice stats
            updateDailyPracticeStats();
            
            // Initialize and render leaderboard
            initializeStudentData();
            renderLeaderboard();
            
            // Update Alex's profile information
            updateAlexProfile();
            
            // Update wrong questions count
            updateWrongQuestionsCount();
            
            // Update tricky questions count
            updateTrickyQuestionsCount();
            
            // Listen for localStorage changes (when assignments/quizzes/exams are completed)
            window.addEventListener('storage', function(e) {
                if (e.key === 'mathematicsAssignments' || e.key === 'mathematicsQuizzes' || e.key === 'mathematicsExams') {
                    console.log('Detected change in', e.key, '- updating points');
                    updateAlexProfile();
                    renderLeaderboard();
                }
            });
            
            // Update Alex profile once on load (removed interval to prevent infinite loop)
            updateAlexProfile();
            
            // Generate schedule widget (at the end to ensure DOM is ready)
            setTimeout(() => {
                generateScheduleWidget();
            }, 100);
        });

        // Initialize student data structure
        function initializeStudentData() {
            // Check if student data already exists
            let students = JSON.parse(localStorage.getItem('mathematicsStudents') || '[]');
            
            // Clear any existing sample data and start fresh
            localStorage.removeItem('mathematicsStudents');
            students = [];
            
            console.log('Cleared sample student data - leaderboard will show empty state');
        }

        // Cache for student points to prevent repeated calculations
        let studentPointsCache = {};
        let cacheExpiry = Date.now() + 30000; // Cache for 30 seconds

        // Function to clear the cache (call when data changes)
        function clearStudentPointsCache() {
            studentPointsCache = {};
            cacheExpiry = Date.now() + 30000;
        }

        // Function to calculate student points from completed work
        function calculateStudentPoints(studentId) {
            // Check cache first
            if (studentPointsCache[studentId] && Date.now() < cacheExpiry) {
                return studentPointsCache[studentId];
            }

            let totalPoints = 0;
            let quizPoints = 0;
            let assignmentPoints = 0;
            let examPoints = 0;
            let completedQuizzes = 0;
            let completedAssignments = 0;
            let completedExams = 0;

            // Calculate quiz points from mathematics-specific storage keys
            const mathematicsQuizzes = JSON.parse(localStorage.getItem('mathematicsQuizzes') || '[]');
            const teacherQuizzes = JSON.parse(localStorage.getItem('mathematicsTeacherQuizzes') || '[]');
            const quizzesList = JSON.parse(localStorage.getItem('mathematicsQuizzesList') || '[]');
            
            // Combine all quiz sources
            let allQuizzes = [...mathematicsQuizzes];
            teacherQuizzes.forEach(teacherQuiz => {
                if (!allQuizzes.find(q => q.id === teacherQuiz.id)) {
                    allQuizzes.push(teacherQuiz);
                }
            });
            if (allQuizzes.length === 0) {
                allQuizzes = quizzesList;
            }
            
            console.log('Calculating points - All quizzes:', allQuizzes);
            
            allQuizzes.forEach(quiz => {
                // Check if quiz is completed by current student
                if (quiz.completed === true && quiz.score !== undefined) {
                    const points = Math.round((quiz.score / 100) * (quiz.points || (quiz.questions ? quiz.questions.length * 10 : 50)));
                    console.log(`Quiz "${quiz.title}" earned ${points} points`);
                    quizPoints += points;
                    totalPoints += points;
                    completedQuizzes++;
                }
            });

            // Calculate assignment points from mathematics-specific storage keys
            const mathematicsAssignments = JSON.parse(localStorage.getItem('mathematicsAssignments') || '[]');
            const teacherAssignments = JSON.parse(localStorage.getItem('mathematicsTeacherAssignments') || '[]');
            const assignmentsList = JSON.parse(localStorage.getItem('mathematicsAssignmentsList') || '[]');
            
            // Combine all assignment sources
            let allAssignments = [...mathematicsAssignments];
            teacherAssignments.forEach(teacherAssignment => {
                if (!allAssignments.find(a => a.id === teacherAssignment.id)) {
                    allAssignments.push(teacherAssignment);
                }
            });
            if (allAssignments.length === 0) {
                allAssignments = assignmentsList;
            }
            
            console.log('Calculating points - All assignments:', allAssignments);
            
            allAssignments.forEach(assignment => {
                console.log(`Checking assignment: "${assignment.title}" - status: ${assignment.status}, completed: ${assignment.completed}, score: ${assignment.score}, totalScore: ${assignment.totalScore}, points: ${assignment.points}`);
                // Check if assignment is completed
                if ((assignment.status === 'completed' || assignment.completed === true) && assignment.score !== undefined) {
                    // Calculate points based on the assignment's point value
                    let points = 0;
                    
                    if (assignment.points) {
                        // If assignment has a points field, use it directly
                        points = assignment.points;
                    } else if (assignment.totalScore && assignment.score !== undefined) {
                        // Calculate percentage and multiply by default points
                        const percentage = assignment.score / assignment.totalScore;
                        points = Math.round(percentage * 75); // Default 75 points for assignments
                    } else if (assignment.questions) {
                        // Calculate based on number of questions
                        const percentage = assignment.score / 100;
                        points = Math.round(percentage * assignment.questions.length * 15);
                    } else {
                        // Fallback: use score as points directly
                        points = assignment.score || 0;
                    }
                    
                    console.log(`Assignment "${assignment.title}" earned ${points} points (score: ${assignment.score}/${assignment.totalScore || 100})`);
                    assignmentPoints += points;
                    totalPoints += points;
                    completedAssignments++;
                }
            });

            // Calculate exam points from mathematics-specific storage keys
            const mathematicsExams = JSON.parse(localStorage.getItem('mathematicsExams') || '[]');
            const teacherExams = JSON.parse(localStorage.getItem('mathematicsTeacherExams') || '[]');
            const examsList = JSON.parse(localStorage.getItem('mathematicsExamsList') || '[]');
            
            // Combine all exam sources
            let allExams = [...mathematicsExams];
            teacherExams.forEach(teacherExam => {
                if (!allExams.find(e => e.id === teacherExam.id)) {
                    allExams.push(teacherExam);
                }
            });
            if (allExams.length === 0) {
                allExams = examsList;
            }
            
            console.log('Calculating points - All exams:', allExams);
            
            allExams.forEach(exam => {
                // Check if exam is completed
                if ((exam.status === 'completed' || exam.completed === true) && exam.score !== undefined) {
                    const points = Math.round((exam.score / 100) * (exam.points || (exam.questions ? exam.questions.length * 20 : 100)));
                    console.log(`Exam "${exam.title}" earned ${points} points`);
                    examPoints += points;
                    totalPoints += points;
                    completedExams++;
                }
            });
            
            console.log('Total points calculated:', {totalPoints, quizPoints, assignmentPoints, examPoints, completedQuizzes, completedAssignments, completedExams});

            const result = {
                totalPoints,
                quizPoints,
                assignmentPoints,
                examPoints,
                completedQuizzes,
                completedAssignments,
                completedExams
            };

            // Cache the result
            studentPointsCache[studentId] = result;
            
            return result;
        }

        // Function to render the leaderboard
        function renderLeaderboard() {
            const leaderboardList = document.getElementById('leaderboardList');
            
            // Show loading state
            leaderboardList.innerHTML = `
                <div style="text-align: center; padding: 2rem; color: #666;">
                    <iconify-icon icon="material-symbols:hourglass-empty" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></iconify-icon>
                    <p style="font-weight: 600;">Loading leaderboard...</p>
                </div>
            `;
            
            // Fetch enrolled students from API
            const apiUrl = (window.API_CONFIG && window.API_CONFIG.apiURL) || 'http://localhost:3000/api';
            const token = localStorage.getItem('authToken'); // Fixed: Use 'authToken' instead of 'token'
            
            if (!token) {
                // If no token, show message
                leaderboardList.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #666;">
                        <iconify-icon icon="material-symbols:login" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></iconify-icon>
                        <p style="font-weight: 600; margin-bottom: 0.5rem;">Please login to view leaderboard</p>
                        <p style="font-size: 0.9rem; opacity: 0.8;">Login to see enrolled students rankings.</p>
                    </div>
                `;
                return;
            }
            
            fetch(`${apiUrl}/course/mathematics/students`, {
                headers: {
                    'Authorization': `Bearer ${token}`
                }
            })
            .then(response => response.json())
            .then(data => {
                if (!data.success || !data.students || data.students.length === 0) {
                    // No students enrolled
                    leaderboardList.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: #666;">
                            <iconify-icon icon="material-symbols:person-off" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></iconify-icon>
                            <p style="font-weight: 600; margin-bottom: 0.5rem;">No students registered yet</p>
                            <p style="font-size: 0.9rem; opacity: 0.8;">The leaderboard will appear when students enroll in this course.</p>
                        </div>
                    `;
                    return;
                }
                
                // Sync API data to localStorage for personalized greeting
                localStorage.setItem('mathematicsStudents', JSON.stringify(data.students));
                console.log('🔄 Synced API data to localStorage');
                
                // Update personalized greeting with current user's points
                const currentUserEmail = localStorage.getItem('userEmail');
                const currentUser = data.students.find(student => 
                    student.email === currentUserEmail || 
                    student.first_name?.toLowerCase() === 'alex' ||
                    student.name?.toLowerCase().includes('alex')
                );
                
                if (currentUser) {
                    console.log('🎯 Found current user in API data:', currentUser);
                    
                    // Update personalized greeting with API points
                    const totalPointsElement = document.getElementById('totalPoints');
                    if (totalPointsElement) {
                        totalPointsElement.textContent = `${currentUser.points || 0} points`;
                    }
                    
                    // Update ranking
                    const sortedStudents = [...data.students].sort((a, b) => b.points - a.points);
                    const userRank = sortedStudents.findIndex(student => student.id === currentUser.id) + 1;
                    const rankingElement = document.getElementById('studentRanking');
                    if (rankingElement) {
                        rankingElement.textContent = `#${userRank} in class`;
                    }
                    
                    console.log('✅ Updated personalized greeting - Points:', currentUser.points, 'Rank:', userRank);
                }
                
                // Generate leaderboard HTML with real student data
                const leaderboardHtml = data.students.map((student, index) => {
                    const rank = index + 1;
                    const rankClass = rank <= 3 ? `rank-${rank}` : '';
                    const initials = (student.first_name && student.last_name) 
                        ? `${student.first_name[0]}${student.last_name[0]}`.toUpperCase()
                        : 'ST';
                    const fullName = `${student.first_name || 'Student'} ${student.last_name || ''}`.trim();
                    const points = student.points || 0;
                    const subjects = 'Mathematics';
                    
                    return `
                        <div class="leaderboard-item ${rankClass}">
                            <div class="rank-number">${rank}</div>
                            <div class="student-avatar">${initials}</div>
                            <div class="student-info">
                                <div class="student-name">${fullName}</div>
                                <div class="student-score">${subjects}</div>
                            </div>
                            <div class="student-points">${points.toLocaleString()}</div>
                        </div>
                    `;
                }).join('');
                
                leaderboardList.innerHTML = leaderboardHtml;
            })
            .catch(error => {
                console.error('Error fetching leaderboard data:', error);
                leaderboardList.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #666;">
                        <iconify-icon icon="material-symbols:error" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></iconify-icon>
                        <p style="font-weight: 600; margin-bottom: 0.5rem;">Unable to load leaderboard</p>
                        <p style="font-size: 0.9rem; opacity: 0.8;">Please check your connection and try again.</p>
                    </div>
                `;
            });
        }

        // Sidebar Menu Functions
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (sidebar.style.left === '-350px' || sidebar.style.left === '') {
                // Open sidebar
                sidebar.style.left = '0';
                overlay.style.display = 'block';
                document.body.style.overflow = 'hidden'; // Prevent background scrolling
            } else {
                // Close sidebar
                sidebar.style.left = '-350px';
                overlay.style.display = 'none';
                document.body.style.overflow = 'auto'; // Restore scrolling
                
                // Close all submenus when closing sidebar
                closeAllSubmenus();
            }
        }

        function toggleSubmenu(menuId) {
            const submenu = document.getElementById(menuId + '-submenu');
            const arrow = document.getElementById(menuId + '-arrow');
            
            if (submenu.style.display === 'none' || submenu.style.display === '') {
                // Close other submenus first
                closeAllSubmenus();
                
                // Open this submenu
                submenu.style.display = 'block';
                arrow.style.transform = 'rotate(180deg)';
            } else {
                // Close this submenu
                submenu.style.display = 'none';
                arrow.style.transform = 'rotate(0deg)';
            }
        }

        function closeAllSubmenus() {
            const submenus = ['books', 'lectures', 'progress', 'practice', 'badges', 'papers'];
            
            submenus.forEach(menuId => {
                const submenu = document.getElementById(menuId + '-submenu');
                const arrow = document.getElementById(menuId + '-arrow');
                
                if (submenu) {
                    submenu.style.display = 'none';
                }
                if (arrow) {
                    arrow.style.transform = 'rotate(0deg)';
                }
            });
        }

        // Close sidebar when clicking outside (overlay)
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const hamburgerBtn = document.querySelector('.hamburger-menu-btn');
            
            // Check if click is outside sidebar and not on hamburger button
            if (!sidebar.contains(event.target) && !hamburgerBtn.contains(event.target)) {
                if (sidebar.style.left === '0') {
                    toggleSidebar();
                }
            }
        });

        // Close sidebar on escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const sidebar = document.getElementById('sidebar');
                if (sidebar.style.left === '0') {
                    toggleSidebar();
                }
            }
        });

        // Badges Bar Functions
        function toggleBadgesBar() {
            const badgesBar = document.getElementById('badgesBar');
            if (badgesBar.style.display === 'none') {
                badgesBar.style.display = 'block';
                // Smooth slide down animation
                badgesBar.style.opacity = '0';
                badgesBar.style.transform = 'translateY(-20px)';
                setTimeout(() => {
                    badgesBar.style.transition = 'all 0.3s ease';
                    badgesBar.style.opacity = '1';
                    badgesBar.style.transform = 'translateY(0)';
                }, 10);
            } else {
                // Smooth slide up animation
                badgesBar.style.transition = 'all 0.3s ease';
                badgesBar.style.opacity = '0';
                badgesBar.style.transform = 'translateY(-20px)';
                setTimeout(() => {
                    badgesBar.style.display = 'none';
                }, 300);
            }
        }

        // Global function accessible from other pages to trigger points update
        window.updateStudentPoints = function() {
            if (typeof updateAlexProfile === 'function') {
                updateAlexProfile();
            }
            if (typeof renderLeaderboard === 'function') {
                renderLeaderboard();
            }
        };

        // Function to update Alex's ranking and badges
        function updateAlexProfile() {
            const students = JSON.parse(localStorage.getItem('mathematicsStudents') || '[]');
            
            // Find Alex in the students list (assuming Alex is the first student or has a specific ID)
            let alex = students.find(student => student.name && student.name.toLowerCase().includes('alex')) || students[0];
            
            if (alex) {
                // Recalculate Alex's points from completed work
                const pointsData = calculateStudentPoints(alex.id);
                alex = {
                    ...alex,
                    ...pointsData
                };
                
                // Update the student in the array and save
                const alexIndex = students.findIndex(s => s.id === alex.id);
                if (alexIndex !== -1) {
                    students[alexIndex] = alex;
                    localStorage.setItem('mathematicsStudents', JSON.stringify(students));
                }
                
                // Calculate ranking
                const sortedStudents = [...students].sort((a, b) => b.totalPoints - a.totalPoints);
                const alexRank = sortedStudents.findIndex(student => student.id === alex.id) + 1;
                
                // Update ranking display
                const rankingElement = document.getElementById('studentRanking');
                if (rankingElement) {
                    rankingElement.textContent = `#${alexRank} in class`;
                }
                
                // Update total points display
                const totalPointsElement = document.getElementById('totalPoints');
                if (totalPointsElement) {
                    totalPointsElement.textContent = `${alex.totalPoints} points`;
                }
                
                console.log('Updated Alex profile - Points:', alex.totalPoints, 'Rank:', alexRank);
                
                // Calculate earned badges based on achievements
                let earnedBadges = 0;
                let badgeDescriptions = [];
                
                // Quiz Master Badge (complete 5+ quizzes)
                if (alex.completedQuizzes >= 5) {
                    earnedBadges++;
                    badgeDescriptions.push('Quiz Master');
                }
                
                // Assignment Ace Badge (complete assignments with high scores)
                if (alex.completedAssignments >= 3) {
                    earnedBadges++;
                    badgeDescriptions.push('Assignment Ace');
                }
                
                // Study Streak Badge (active recently)
                const lastActive = new Date(alex.lastActive);
                const daysSinceActive = (new Date() - lastActive) / (1000 * 60 * 60 * 24);
                if (daysSinceActive <= 7) {
                    earnedBadges++;
                    badgeDescriptions.push('Study Streak');
                }
                
                // Top Performer Badge (rank in top 3)
                if (alexRank <= 3) {
                    earnedBadges++;
                    badgeDescriptions.push('Top Performer');
                }
                
                // Update badges count
                const badgesElement = document.getElementById('earnedBadges');
                if (badgesElement) {
                    badgesElement.textContent = `${earnedBadges} badges`;
                }
                
                console.log(`Alex's Profile Updated: Rank #${alexRank}, ${earnedBadges} badges earned`);
            }
        }

        // Navigation Button Functions
        function navigateToProfile() {
            console.log('Profile button clicked');
            
            // Get actual user info from localStorage
            const userName = localStorage.getItem('userName') || 'Student';
            const userEmail = localStorage.getItem('userEmail') || 'student@example.com';
            
            // Calculate total points from completed work
            const pointsData = calculateStudentPoints();
            const totalPoints = pointsData.totalPoints || 0;
            
            // Create profile dropdown menu
            const dropdownHtml = `
                <div id="profileDropdown" style="position: fixed; top: 70px; right: 20px; background: white; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.15); padding: 1rem; z-index: 9999; min-width: 250px; animation: fadeIn 0.3s ease;">
                    <div style="border-bottom: 1px solid #e9ecef; padding-bottom: 0.75rem; margin-bottom: 0.75rem;">
                        <div style="font-weight: 600; color: #333; font-size: 1.1rem;">${userName}</div>
                        <div style="font-size: 0.85rem; color: #666;">${userEmail}</div>
                        <div style="margin-top: 0.5rem; display: flex; gap: 0.5rem;">
                            <span style="background: #667eea; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">${totalPoints} pts</span>
                            <span style="background: #22c55e; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">Active</span>
                        </div>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                        <button onclick="event.stopPropagation(); window.location.href='student-profile.html'" style="width: 100%; text-align: left; padding: 0.75rem; background: transparent; border: none; cursor: pointer; border-radius: 8px; transition: all 0.2s; display: flex; align-items: center; gap: 0.5rem;" onmouseover="this.style.background='#f3f4f6'" onmouseout="this.style.background='transparent'">
                            <iconify-icon icon="material-symbols:person" style="font-size: 1.2rem; color: #667eea;"></iconify-icon>
                            <span>My Profile</span>
                        </button>
                        <button onclick="event.stopPropagation(); handleLogout()" style="width: 100%; text-align: left; padding: 0.75rem; background: transparent; border: none; cursor: pointer; border-radius: 8px; transition: all 0.2s; display: flex; align-items: center; gap: 0.5rem; color: #ef4444;" onmouseover="this.style.background='#fef2f2'" onmouseout="this.style.background='transparent'">
                            <iconify-icon icon="material-symbols:logout" style="font-size: 1.2rem;"></iconify-icon>
                            <span>Logout</span>
                        </button>
                    </div>
                </div>
            `;
            
            // Remove existing dropdown if any
            const existing = document.getElementById('profileDropdown');
            if (existing) {
                existing.remove();
                return;
            }
            
            // Add dropdown to page
            document.body.insertAdjacentHTML('beforeend', dropdownHtml);
            
            // Close on outside click
            setTimeout(() => {
                document.addEventListener('click', function closeDropdown(e) {
                    const dropdown = document.getElementById('profileDropdown');
                    if (dropdown && !dropdown.contains(e.target)) {
                        dropdown.remove();
                        document.removeEventListener('click', closeDropdown);
                    }
                }, {once: false});
            }, 100);
        }
        
        function handleLogout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('token');
                localStorage.removeItem('authToken');
                localStorage.removeItem('userEmail');
                localStorage.removeItem('userName');
                localStorage.removeItem('userId');
                localStorage.removeItem('userLoggedIn');
                window.location.href = 'index.html';
            }
        }

        function navigateToCommunity() {
            console.log('Community button clicked');
            window.location.href = 'mathematics-community.html';
        }

        function navigateToNotifications() {
            console.log('Notifications button clicked');
            showNotificationsModal();
        }

        function navigateToFocusMode() {
            console.log('Focus Mode button clicked');
            showFocusModeModal();
        }
        
        function showFocusModeModal() {
            const modalHtml = `
                <div id="focusModeModal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.95); z-index: 99999; display: flex; align-items: center; justify-content: center; animation: fadeIn 0.3s ease;">
                    <iframe src="focus-mode.html" style="width: 95vw; height: 95vh; border: none; border-radius: 24px; box-shadow: 0 20px 60px rgba(0,0,0,0.5);"></iframe>
                    <button onclick="closeFocusMode()" style="position: absolute; top: 2rem; right: 2rem; background: rgba(255,255,255,0.9); border: none; width: 50px; height: 50px; border-radius: 50%; cursor: pointer; font-size: 1.5rem; color: #333; box-shadow: 0 4px 12px rgba(0,0,0,0.3); transition: all 0.3s;" onmouseover="this.style.background='white'; this.style.transform='scale(1.1)'" onmouseout="this.style.background='rgba(255,255,255,0.9)'; this.style.transform='scale(1)'">
                        ×
                    </button>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            document.body.style.overflow = 'hidden';
            
            // Start blocking websites
            startWebsiteBlocking();
        }
        
        function closeFocusMode() {
            const modal = document.getElementById('focusModeModal');
            if (modal) {
                modal.remove();
            }
            document.body.style.overflow = 'auto';
            stopWebsiteBlocking();
        }
        
        // Website blocking system
        let blockingInterval = null;
        
        function startWebsiteBlocking() {
            // Check for blocked sites every second
            blockingInterval = setInterval(() => {
                const blockedSites = JSON.parse(localStorage.getItem('blockedSites') || '[]');
                const currentUrl = window.location.href;
                
                // This is a demo - actual blocking requires a browser extension
                console.log('Blocking active. Blocked sites:', blockedSites);
            }, 1000);
        }
        
        function stopWebsiteBlocking() {
            if (blockingInterval) {
                clearInterval(blockingInterval);
                blockingInterval = null;
            }
        }
        
        // Check if user tries to open blocked sites (demonstration)
        window.addEventListener('beforeunload', function(e) {
            const blockedSites = JSON.parse(localStorage.getItem('blockedSites') || '[]');
            if (blockedSites.length > 0 && document.getElementById('focusModeModal')) {
                // This would work if we could intercept navigation
                console.log('Focus mode active - some sites are blocked');
            }
        });

        // Navigation function for progress cards
        function navigateToSection(section) {
            // Map section types to specific pages
            const pageMap = {
                'quiz': 'mathematics-quiz.html',
                'exam': 'mathematics-exam.html',
                'assignment': 'mathematics-homework.html',
                'progress': 'course-mathematics.html'
            };
            
            // Get the URL for the section
            const url = pageMap[section] || 'course-mathematics.html';
            
            // Redirect to the appropriate page
            window.location.href = url;
        }

        // Navigation functionality - Same as course-mathematics page
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                // Add a subtle highlight effect to the target section
                element.style.transition = 'all 0.3s ease';
                element.style.boxShadow = '0 0 20px rgba(102, 126, 234, 0.3)';
                
                // Smooth scroll to the element with offset for better positioning
                const elementPosition = element.offsetTop - 100; // 100px offset from top
                window.scrollTo({
                    top: elementPosition,
                    behavior: 'smooth'
                });
                
                // Remove highlight effect after animation
                setTimeout(() => {
                    element.style.boxShadow = '';
                }, 1000);
            }
        }

        // Navigation active state - Same as course-mathematics page
        document.querySelectorAll('.dashboard-nav .nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Add click animation effect
                this.style.transform = 'scale(0.95)';
                this.style.transition = 'transform 0.1s ease';
                
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                }, 100);
                
                // Remove active class from all links
                document.querySelectorAll('.dashboard-nav .nav-link').forEach(l => l.classList.remove('active'));
                
                // Add active class to clicked link
                this.classList.add('active');
                
                // Scroll to section
                const targetId = this.getAttribute('href').substring(1);
                scrollToSection(targetId);
            });
        });

        // Update navigation active state on scroll - Same as course-mathematics page
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('section[id], div[id]');
            const navLinks = document.querySelectorAll('.dashboard-nav .nav-link');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (window.pageYOffset >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        });

        // Todo Panel Toggle Function
        function toggleTodoPanel() {
            const panel = document.getElementById('todoPanel');
            panel.classList.toggle('open');
        }

        // Update todo count
        function updateTodoCount() {
            const todoItems = document.querySelectorAll('#todoList .todo-item');
            const count = todoItems.length;
            document.getElementById('todoCount').textContent = count;
        }

        // Add todo function
        function addTodo() {
            const input = document.getElementById('newTodoInput');
            const priority = document.getElementById('prioritySelect').value;
            const text = input.value.trim();
            
            if (!text) return;
            
            const todoList = document.getElementById('todoList');
            const todoItem = document.createElement('div');
            todoItem.className = 'todo-item';
            todoItem.innerHTML = `
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div class="todo-text">${text}</div>
                        <small class="text-muted">${priority.charAt(0).toUpperCase() + priority.slice(1)} Priority</small>
                    </div>
                    <button class="btn btn-sm btn-outline-danger" onclick="removeTodo(this)">
                        <iconify-icon icon="material-symbols:delete"></iconify-icon>
                    </button>
                </div>
            `;
            
            todoList.appendChild(todoItem);
            input.value = '';
            updateTodoCount();
        }

        // Remove todo function
        function removeTodo(button) {
            button.closest('.todo-item').remove();
            updateTodoCount();
        }

        // Initialize todo count on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateTodoCount();
        });
    </script>

    <!-- Floating Todo Button -->
    <div class="floating-todo-btn" onclick="toggleTodoPanel()">
        <iconify-icon icon="material-symbols:checklist" style="font-size: 1.5rem; color: white;"></iconify-icon>
        <span class="todo-count" id="todoCount">0</span>
    </div>

    <!-- Collapsible Todo Panel -->
    <div class="todo-panel" id="todoPanel">
        <div class="todo-panel-header">
            <h3 style="margin: 0; color: #1e293b; font-weight: 700;">
                <iconify-icon icon="material-symbols:checklist" style="margin-right: 0.5rem; color: #667eea;"></iconify-icon>
                My Todo List
            </h3>
            <button class="close-todo-btn" onclick="toggleTodoPanel()">
                <iconify-icon icon="material-symbols:close" style="font-size: 1.5rem; color: #64748b;"></iconify-icon>
            </button>
        </div>
        
        <div class="todo-panel-content">
            <!-- Add Todo Form -->
            <div class="add-todo-form">
                <div class="row g-2">
                    <div class="col-12 mb-2">
                        <input type="text" class="form-control" id="newTodoInput" placeholder="Enter your new task here..." style="width: 100%;">
                    </div>
                    <div class="col-8 mb-2">
                        <select class="form-control" id="prioritySelect" style="width: 100%;">
                            <option value="low">Low Priority</option>
                            <option value="medium">Medium Priority</option>
                            <option value="high">High Priority</option>
                        </select>
                    </div>
                    <div class="col-4 mb-2">
                        <button class="btn btn-primary w-100" onclick="addTodo()" style="padding: 0.75rem 0.5rem; font-weight: 600; white-space: nowrap; font-size: 0.85rem;">
                            <iconify-icon icon="material-symbols:add" class="me-1"></iconify-icon>
                            Add
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Todo List -->
            <div id="todoList" class="mt-4">
                <!-- Todo items will be dynamically added here -->
            </div>
            
            <!-- Action Buttons -->
            <div class="row mt-4">
                <div class="col-md-6 mb-2">
                    <button class="btn btn-success w-100" onclick="saveTodoList()" style="padding: 0.75rem 1rem; font-weight: 600;">
                        <iconify-icon icon="material-symbols:save" class="me-1"></iconify-icon>
                        Save List
                    </button>
                </div>
                <div class="col-md-6 mb-2">
                    <button class="btn btn-danger w-100" onclick="clearTodoList()" style="padding: 0.75rem 1rem; font-weight: 600;">
                        <iconify-icon icon="material-symbols:clear-all" class="me-1"></iconify-icon>
                        Clear List
                    </button>
                </div>
                <div class="col-12 mb-2">
                    <button class="btn btn-outline-primary w-100" onclick="viewAllTodoLists()" style="padding: 0.75rem 1rem; font-weight: 600;">
                        <iconify-icon icon="material-symbols:list" class="me-1"></iconify-icon>
                        View All Todo Lists
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Focus Timer Widget -->
    <script src="js/focus-timer-widget.js"></script>
    
    <!-- Focus Music Widget -->
    <script src="js/focus-music-widget.js"></script>
</body>
</html>





